[
  {
    "dataset_name": "flutter_todo_app_professional",
    "metadata": {
      "framework": "Flutter 3.0+",
      "architecture": "Clean Architecture",
      "state_management": "Provider",
      "database": "Hive",
      "dependencies": [
        "provider",
        "hive",
        "auto_route",
        "get_it",
        "flutter_slidable",
        "intl",
        "uuid"
      ],
      "target_platforms": [
        "Android",
        "iOS",
        "Web",
        "Desktop"
      ],
      "created": "2024-01-15",
      "version": "1.0.0"
    },
    "instructions": [
      {
        "instruction": "Create a Flutter ToDo application with Clean Architecture, proper state management using Provider, local persistence with Hive, and professional UI components. The app should include task creation, editing, deletion, filtering, sorting, and proper error handling.",
        "input": "",
        "output": {
          "project_structure": {
            "todo_pro": {
              "pubspec.yaml": "name: todo_pro\\ndescription: Professional Flutter ToDo App\\nversion: 1.0.0+1\\npublish_to: \\\\'none\\\\'\\n\\nenvironment:\\n  sdk: \\\\'>=3.0.0 <4.0.0\\\\'\\n  flutter: \\\\'>=3.0.0\\\\'\\n\\ndependencies:\\n  flutter:\\n    sdk: flutter\\n  provider: ^6.0.5\\n  hive: ^2.2.3\\n  hive_flutter: ^1.1.0\\n  intl: ^0.18.1\\n  flutter_slidable: ^3.0.0\\n  uuid: ^3.0.7\\n  equatable: ^2.0.5\\n\\nflutter:\\n  uses-material-design: true\\n  generate: true\\n\\n  assets:\\n    - assets/images/\\n    - assets/icons/\\n\\n  fonts:\\n    - family: Roboto\\n      fonts:\\n        - asset: fonts/Roboto-Regular.ttf\\n        - asset: fonts/Roboto-Medium.ttf\\n          weight: 500\\n        - asset: fonts/Roboto-Bold.ttf\\n          weight: 700",
              "lib": {
                "main.dart": "import 'package:flutter/material.dart';\nimport 'package:hive_flutter/hive_flutter.dart';\nimport 'package:todo_pro/app.dart';\nimport 'package:todo_pro/data/models/task_model.dart';\n\nFuture<void> main() async {\n  WidgetsFlutterBinding.ensureInitialized();\n  \n  await Hive.initFlutter();\n  Hive.registerAdapter(TaskModelAdapter());\n  await Hive.openBox<TaskModel>('tasks');\n  \n  runApp(const MyApp());\n}\n\nclass MyApp extends StatelessWidget {\n  const MyApp({super.key});\n\n  @override\n  Widget build(BuildContext context) {\n    return MaterialApp(\n      title: 'Todo Pro',\n      debugShowCheckedModeBanner: false,\n      theme: ThemeData(\n        useMaterial3: true,\n        colorScheme: ColorScheme.fromSeed(\n          seedColor: Colors.blue,\n          brightness: Brightness.light,\n        ),\n        fontFamily: 'Roboto',\n      ),\n      darkTheme: ThemeData(\n        useMaterial3: true,\n        colorScheme: ColorScheme.fromSeed(\n          seedColor: Colors.blue,\n          brightness: Brightness.dark,\n        ),\n      ),\n      themeMode: ThemeMode.system,\n      home: const App(),\n    );\n  }\n}",
                "app.dart": "import 'package:flutter/material.dart';\nimport 'package:provider/provider.dart';\nimport 'package:todo_pro/presentation/screens/home/home_screen.dart';\nimport 'package:todo_pro/providers/task_provider.dart';\n\nclass App extends StatelessWidget {\n  const App({super.key});\n\n  @override\n  Widget build(BuildContext context) {\n    return MultiProvider(\n      providers: [\n        ChangeNotifierProvider(create: (_) => TaskProvider()),\n      ],\n      child: MaterialApp(\n        title: 'Todo Pro',\n        theme: ThemeData(\n          useMaterial3: true,\n          appBarTheme: const AppBarTheme(\n            centerTitle: true,\n            elevation: 2,\n          ),\n        ),\n        home: const HomeScreen(),\n      ),\n    );\n  }\n}",
                "core": {
                  "constants": {
                    "app_constants.dart": "class AppConstants {\n  static const String appName = 'Todo Pro';\n  static const String tasksBox = 'tasks';\n  static const int maxTitleLength = 100;\n  static const int maxDescriptionLength = 500;\n  \n  static const List<String> priorityOptions = ['Low', 'Medium', 'High'];\n  static const List<String> categoryOptions = ['Personal', 'Work', 'Shopping', 'Health', 'Education', 'Other'];\n  \n  static const Map<String, String> priorityIcons = {\n    'Low': 'assets/icons/low_priority.svg',\n    'Medium': 'assets/icons/medium_priority.svg',\n    'High': 'assets/icons/high_priority.svg',\n  };\n}",
                    "enums.dart": "enum TaskPriority { low, medium, high }\nenum TaskStatus { pending, inProgress, completed }\nenum SortType { date, priority, title, category }\nenum FilterType { all, today, upcoming, pending, completed }",
                    "routes.dart": "class AppRoutes {\n  static const String home = '/';\n  static const String addTask = '/add_task';\n  static const String editTask = '/edit_task';\n  static const String settings = '/settings';\n}"
                  },
                  "utils": {
                    "date_utils.dart": "import 'package:intl/intl.dart';\n\nclass DateUtils {\n  static String formatDate(DateTime date) {\n    final now = DateTime.now();\n    final today = DateTime(now.year, now.month, now.day);\n    final inputDate = DateTime(date.year, date.month, date.day);\n    \n    if (inputDate == today) {\n      return 'Today';\n    } else if (inputDate == today.subtract(const Duration(days: 1))) {\n      return 'Yesterday';\n    } else if (inputDate == today.add(const Duration(days: 1))) {\n      return 'Tomorrow';\n    } else {\n      return DateFormat('MMM dd, yyyy').format(date);\n    }\n  }\n  \n  static String formatDateTime(DateTime date) {\n    return DateFormat('MMM dd, yyyy â€¢ HH:mm').format(date);\n  }\n  \n  static bool isToday(DateTime date) {\n    final now = DateTime.now();\n    return date.year == now.year &&\n           date.month == now.month &&\n           date.day == now.day;\n  }\n}",
                    "validation_utils.dart": "class ValidationUtils {\n  static String? validateRequired(String? value, String fieldName) {\n    if (value == null || value.trim().isEmpty) {\n      return '$fieldName is required';\n    }\n    return null;\n  }\n  \n  static String? validateMaxLength(String? value, int maxLength, String fieldName) {\n    if (value != null && value.length > maxLength) {\n      return '$fieldName must be less than $maxLength characters';\n    }\n    return null;\n  }\n  \n  static String? validateTaskTitle(String? value) {\n    return validateRequired(value, 'Title') ?? \n           validateMaxLength(value, 100, 'Title');\n  }\n  \n  static String? validateTaskDescription(String? value) {\n    return validateMaxLength(value, 500, 'Description');\n  }\n}",
                    "extensions.dart": "import 'package:todo_pro/core/constants/enums.dart';\nimport 'package:flutter/material.dart';\n\nextension TaskPriorityExtension on TaskPriority {\n  String get name {\n    switch (this) {\n      case TaskPriority.low:\n        return 'Low';\n      case TaskPriority.medium:\n        return 'Medium';\n      case TaskPriority.high:\n        return 'High';\n    }\n  }\n  \n  Color get color {\n    switch (this) {\n      case TaskPriority.low:\n        return Colors.green;\n      case TaskPriority.medium:\n        return Colors.orange;\n      case TaskPriority.high:\n        return Colors.red;\n    }\n  }\n  \n  IconData get icon {\n    switch (this) {\n      case TaskPriority.low:\n        return Icons.arrow_downward;\n      case TaskPriority.medium:\n        return Icons.remove;\n      case TaskPriority.high:\n        return Icons.arrow_upward;\n    }\n  }\n}\n\nextension TaskStatusExtension on TaskStatus {\n  String get name {\n    switch (this) {\n      case TaskStatus.pending:\n        return 'Pending';\n      case TaskStatus.inProgress:\n        return 'In Progress';\n      case TaskStatus.completed:\n        return 'Completed';\n    }\n  }\n  \n  IconData get icon {\n    switch (this) {\n      case TaskStatus.pending:\n        return Icons.access_time;\n      case TaskStatus.inProgress:\n        return Icons.timelapse;\n      case TaskStatus.completed:\n        return Icons.check_circle;\n    }\n  }\n}"
                  },
                  "error": {
                    "failure.dart": "abstract class Failure {\n  final String message;\n  \n  const Failure(this.message);\n}\n\nclass DatabaseFailure extends Failure {\n  const DatabaseFailure(String message) : super(message);\n}\n\nclass NetworkFailure extends Failure {\n  const NetworkFailure(String message) : super(message);\n}\n\nclass ValidationFailure extends Failure {\n  const ValidationFailure(String message) : super(message);\n}",
                    "exceptions.dart": "class AppException implements Exception {\n  final String message;\n  final String code;\n  \n  const AppException({required this.message, required this.code});\n  \n  @override\n  String toString() => 'AppException: $message (Code: $code)';\n}\n\nclass DatabaseException extends AppException {\n  const DatabaseException(String message) \n      : super(message: message, code: 'DB_ERROR');\n}\n\nclass NetworkException extends AppException {\n  const NetworkException(String message) \n      : super(message: message, code: 'NETWORK_ERROR');\n}"
                  }
                },
                "data": {
                  "models": {
                    "task_model.dart": "import 'package:hive/hive.dart';\nimport 'package:todo_pro/core/constants/enums.dart';\n\npart 'task_model.g.dart';\n\n@HiveType(typeId: 0)\nclass TaskModel {\n  @HiveField(0)\n  final String id;\n  \n  @HiveField(1)\n  String title;\n  \n  @HiveField(2)\n  String? description;\n  \n  @HiveField(3)\n  DateTime dueDate;\n  \n  @HiveField(4)\n  TaskPriority priority;\n  \n  @HiveField(5)\n  TaskStatus status;\n  \n  @HiveField(6)\n  String category;\n  \n  @HiveField(7)\n  bool hasReminder;\n  \n  @HiveField(8)\n  DateTime createdAt;\n  \n  @HiveField(9)\n  DateTime updatedAt;\n  \n  @HiveField(10)\n  List<String> tags;\n  \n  TaskModel({\n    required this.id,\n    required this.title,\n    this.description,\n    required this.dueDate,\n    required this.priority,\n    required this.status,\n    required this.category,\n    this.hasReminder = false,\n    required this.createdAt,\n    required this.updatedAt,\n    this.tags = const [],\n  });\n  \n  factory TaskModel.create({\n    required String title,\n    String? description,\n    required DateTime dueDate,\n    TaskPriority priority = TaskPriority.medium,\n    String category = 'Personal',\n    bool hasReminder = false,\n    List<String> tags = const [],\n  }) {\n    final now = DateTime.now();\n    return TaskModel(\n      id: DateTime.now().millisecondsSinceEpoch.toString(),\n      title: title,\n      description: description,\n      dueDate: dueDate,\n      priority: priority,\n      status: TaskStatus.pending,\n      category: category,\n      hasReminder: hasReminder,\n      createdAt: now,\n      updatedAt: now,\n      tags: tags,\n    );\n  }\n  \n  TaskModel copyWith({\n    String? title,\n    String? description,\n    DateTime? dueDate,\n    TaskPriority? priority,\n    TaskStatus? status,\n    String? category,\n    bool? hasReminder,\n    List<String>? tags,\n  }) {\n    return TaskModel(\n      id: id,\n      title: title ?? this.title,\n      description: description ?? this.description,\n      dueDate: dueDate ?? this.dueDate,\n      priority: priority ?? this.priority,\n      status: status ?? this.status,\n      category: category ?? this.category,\n      hasReminder: hasReminder ?? this.hasReminder,\n      createdAt: createdAt,\n      updatedAt: DateTime.now(),\n      tags: tags ?? this.tags,\n    );\n  }\n  \n  bool get isOverdue => dueDate.isBefore(DateTime.now()) && status != TaskStatus.completed;\n  \n  bool get isDueToday => DateUtils.isToday(dueDate);\n  \n  @override\n  String toString() {\n    return 'Task(id: $id, title: $title, status: $status, dueDate: $dueDate)';\n  }\n}"
                  },
                  "repositories": {
                    "task_repository.dart": "import 'package:hive/hive.dart';\nimport 'package:todo_pro/data/models/task_model.dart';\nimport 'package:todo_pro/core/error/failure.dart';\n\nabstract class TaskRepository {\n  Future<List<TaskModel>> getTasks();\n  Future<TaskModel> getTask(String id);\n  Future<void> addTask(TaskModel task);\n  Future<void> updateTask(TaskModel task);\n  Future<void> deleteTask(String id);\n  Future<void> deleteAllTasks();\n}\n\nclass TaskRepositoryImpl implements TaskRepository {\n  final Box<TaskModel> tasksBox;\n  \n  TaskRepositoryImpl(this.tasksBox);\n  \n  @override\n  Future<List<TaskModel>> getTasks() async {\n    try {\n      return tasksBox.values.toList();\n    } catch (e) {\n      throw DatabaseFailure('Failed to load tasks: $e');\n    }\n  }\n  \n  @override\n  Future<TaskModel> getTask(String id) async {\n    try {\n      final task = tasksBox.get(id);\n      if (task == null) {\n        throw DatabaseFailure('Task not found');\n      }\n      return task;\n    } catch (e) {\n      throw DatabaseFailure('Failed to get task: $e');\n    }\n  }\n  \n  @override\n  Future<void> addTask(TaskModel task) async {\n    try {\n      await tasksBox.put(task.id, task);\n    } catch (e) {\n      throw DatabaseFailure('Failed to add task: $e');\n    }\n  }\n  \n  @override\n  Future<void> updateTask(TaskModel task) async {\n    try {\n      await tasksBox.put(task.id, task);\n    } catch (e) {\n      throw DatabaseFailure('Failed to update task: $e');\n    }\n  }\n  \n  @override\n  Future<void> deleteTask(String id) async {\n    try {\n      await tasksBox.delete(id);\n    } catch (e) {\n      throw DatabaseFailure('Failed to delete task: $e');\n    }\n  }\n  \n  @override\n  Future<void> deleteAllTasks() async {\n    try {\n      await tasksBox.clear();\n    } catch (e) {\n      throw DatabaseFailure('Failed to delete all tasks: $e');\n    }\n  }\n}"
                  }
                },
                "domain": {
                  "entities": {
                    "task.dart": "import 'package:equatable/equatable.dart';\nimport 'package:todo_pro/core/constants/enums.dart';\n\nclass Task extends Equatable {\n  final String id;\n  final String title;\n  final String? description;\n  final DateTime dueDate;\n  final TaskPriority priority;\n  final TaskStatus status;\n  final String category;\n  final bool hasReminder;\n  final DateTime createdAt;\n  final DateTime updatedAt;\n  final List<String> tags;\n  \n  const Task({\n    required this.id,\n    required this.title,\n    this.description,\n    required this.dueDate,\n    required this.priority,\n    required this.status,\n    required this.category,\n    this.hasReminder = false,\n    required this.createdAt,\n    required this.updatedAt,\n    this.tags = const [],\n  });\n  \n  @override\n  List<Object?> get props => [\n    id,\n    title,\n    description,\n    dueDate,\n    priority,\n    status,\n    category,\n    hasReminder,\n    createdAt,\n    updatedAt,\n    tags,\n  ];\n  \n  Task copyWith({\n    String? title,\n    String? description,\n    DateTime? dueDate,\n    TaskPriority? priority,\n    TaskStatus? status,\n    String? category,\n    bool? hasReminder,\n    List<String>? tags,\n  }) {\n    return Task(\n      id: id,\n      title: title ?? this.title,\n      description: description ?? this.description,\n      dueDate: dueDate ?? this.dueDate,\n      priority: priority ?? this.priority,\n      status: status ?? this.status,\n      category: category ?? this.category,\n      hasReminder: hasReminder ?? this.hasReminder,\n      createdAt: createdAt,\n      updatedAt: DateTime.now(),\n      tags: tags ?? this.tags,\n    );\n  }\n}"
                  },
                  "usecases": {
                    "get_tasks_usecase.dart": "import 'package:todo_pro/data/repositories/task_repository.dart';\nimport 'package:todo_pro/data/models/task_model.dart';\n\nclass GetTasksUseCase {\n  final TaskRepository repository;\n  \n  GetTasksUseCase(this.repository);\n  \n  Future<List<TaskModel>> execute() async {\n    return await repository.getTasks();\n  }\n}",
                    "add_task_usecase.dart": "import 'package:todo_pro/data/repositories/task_repository.dart';\nimport 'package:todo_pro/data/models/task_model.dart';\n\nclass AddTaskUseCase {\n  final TaskRepository repository;\n  \n  AddTaskUseCase(this.repository);\n  \n  Future<void> execute(TaskModel task) async {\n    await repository.addTask(task);\n  }\n}",
                    "update_task_usecase.dart": "import 'package:todo_pro/data/repositories/task_repository.dart';\nimport 'package:todo_pro/data/models/task_model.dart';\n\nclass UpdateTaskUseCase {\n  final TaskRepository repository;\n  \n  UpdateTaskUseCase(this.repository);\n  \n  Future<void> execute(TaskModel task) async {\n    await repository.updateTask(task);\n  }\n}",
                    "delete_task_usecase.dart": "import 'package:todo_pro/data/repositories/task_repository.dart';\n\nclass DeleteTaskUseCase {\n  final TaskRepository repository;\n  \n  DeleteTaskUseCase(this.repository);\n  \n  Future<void> execute(String taskId) async {\n    await repository.deleteTask(taskId);\n  }\n}"
                  }
                },
                "presentation": {
                  "providers": {
                    "task_provider.dart": "import 'package:flutter/foundation.dart';\nimport 'package:hive/hive.dart';\nimport 'package:todo_pro/data/models/task_model.dart';\nimport 'package:todo_pro/data/repositories/task_repository.dart';\nimport 'package:todo_pro/core/constants/enums.dart';\n\nclass TaskProvider extends ChangeNotifier {\n  final TaskRepository _repository;\n  List<TaskModel> _tasks = [];\n  SortType _sortType = SortType.date;\n  FilterType _filterType = FilterType.all;\n  bool _isLoading = false;\n  String? _errorMessage;\n  \n  TaskProvider() : _repository = TaskRepositoryImpl(Hive.box<TaskModel>('tasks')) {\n    _loadTasks();\n  }\n  \n  List<TaskModel> get tasks => _applyFilterAndSort(_tasks);\n  SortType get sortType => _sortType;\n  FilterType get filterType => _filterType;\n  bool get isLoading => _isLoading;\n  String? get errorMessage => _errorMessage;\n  \n  int get totalTasks => _tasks.length;\n  int get pendingTasks => _tasks.where((t) => t.status == TaskStatus.pending).length;\n  int get completedTasks => _tasks.where((t) => t.status == TaskStatus.completed).length;\n  \n  Future<void> _loadTasks() async {\n    _isLoading = true;\n    _errorMessage = null;\n    notifyListeners();\n    \n    try {\n      _tasks = await _repository.getTasks();\n    } catch (e) {\n      _errorMessage = 'Failed to load tasks: $e';\n    } finally {\n      _isLoading = false;\n      notifyListeners();\n    }\n  }\n  \n  Future<void> addTask(TaskModel task) async {\n    try {\n      await _repository.addTask(task);\n      await _loadTasks();\n    } catch (e) {\n      _errorMessage = 'Failed to add task: $e';\n      notifyListeners();\n    }\n  }\n  \n  Future<void> updateTask(TaskModel task) async {\n    try {\n      await _repository.updateTask(task);\n      await _loadTasks();\n    } catch (e) {\n      _errorMessage = 'Failed to update task: $e';\n      notifyListeners();\n    }\n  }\n  \n  Future<void> deleteTask(String taskId) async {\n    try {\n      await _repository.deleteTask(taskId);\n      await _loadTasks();\n    } catch (e) {\n      _errorMessage = 'Failed to delete task: $e';\n      notifyListeners();\n    }\n  }\n  \n  Future<void> deleteAllTasks() async {\n    try {\n      await _repository.deleteAllTasks();\n      await _loadTasks();\n    } catch (e) {\n      _errorMessage = 'Failed to delete all tasks: $e';\n      notifyListeners();\n    }\n  }\n  \n  void setSortType(SortType type) {\n    _sortType = type;\n    notifyListeners();\n  }\n  \n  void setFilterType(FilterType type) {\n    _filterType = type;\n    notifyListeners();\n  }\n  \n  List<TaskModel> _applyFilterAndSort(List<TaskModel> tasks) {\n    final filtered = _applyFilter(tasks);\n    return _applySort(filtered);\n  }\n  \n  List<TaskModel> _applyFilter(List<TaskModel> tasks) {\n    switch (_filterType) {\n      case FilterType.today:\n        return tasks.where((task) => task.isDueToday).toList();\n      case FilterType.upcoming:\n        return tasks.where((task) => task.dueDate.isAfter(DateTime.now())).toList();\n      case FilterType.pending:\n        return tasks.where((task) => task.status == TaskStatus.pending).toList();\n      case FilterType.completed:\n        return tasks.where((task) => task.status == TaskStatus.completed).toList();\n      case FilterType.all:\n      default:\n        return tasks;\n    }\n  }\n  \n  List<TaskModel> _applySort(List<TaskModel> tasks) {\n    switch (_sortType) {\n      case SortType.priority:\n        return List.from(tasks)\n          ..sort((a, b) => b.priority.index.compareTo(a.priority.index));\n      case SortType.title:\n        return List.from(tasks)\n          ..sort((a, b) => a.title.compareTo(b.title));\n      case SortType.category:\n        return List.from(tasks)\n          ..sort((a, b) => a.category.compareTo(b.category));\n      case SortType.date:\n      default:\n        return List.from(tasks)\n          ..sort((a, b) => a.dueDate.compareTo(b.dueDate));\n    }\n  }\n}"
                  }
                },
                "widgets": {
                  "common": {
                    "app_button.dart": "import 'package:flutter/material.dart';\n\nclass AppButton extends StatelessWidget {\n  final String text;\n  final VoidCallback onPressed;\n  final Color? backgroundColor;\n  final Color? textColor;\n  final bool isLoading;\n  final bool expanded;\n  final IconData? icon;\n  \n  const AppButton({\n    super.key,\n    required this.text,\n    required this.onPressed,\n    this.backgroundColor,\n    this.textColor,\n    this.isLoading = false,\n    this.expanded = false,\n    this.icon,\n  });\n  \n  @override\n  Widget build(BuildContext context) {\n    final theme = Theme.of(context);\n    \n    Widget buttonChild = isLoading\n        ? const SizedBox(\n            height: 24,\n            width: 24,\n            child: CircularProgressIndicator(strokeWidth: 2),\n          )\n        : Row(\n            mainAxisSize: MainAxisSize.min,\n            children: [\n              if (icon != null) ...[\n                Icon(icon, size: 20),\n                const SizedBox(width: 8),\n              ],\n              Text(\n                text,\n                style: theme.textTheme.labelLarge?.copyWith(\n                  color: textColor ?? theme.colorScheme.onPrimary,\n                  fontWeight: FontWeight.w600,\n                ),\n              ),\n            ],\n          );\n    \n    final button = ElevatedButton(\n      onPressed: isLoading ? null : onPressed,\n      style: ElevatedButton.styleFrom(\n        backgroundColor: backgroundColor ?? theme.colorScheme.primary,\n        foregroundColor: textColor ?? theme.colorScheme.onPrimary,\n        padding: const EdgeInsets.symmetric(horizontal: 24, vertical: 16),\n        shape: RoundedRectangleBorder(\n          borderRadius: BorderRadius.circular(12),\n        ),\n      ),\n      child: buttonChild,\n    );\n    \n    if (expanded) {\n      return SizedBox(\n        width: double.infinity,\n        child: button,\n      );\n    }\n    \n    return button;\n  }\n}",
                    "app_card.dart": "import 'package:flutter/material.dart';\n\nclass AppCard extends StatelessWidget {\n  final Widget child;\n  final EdgeInsetsGeometry padding;\n  final Color? color;\n  final BorderRadiusGeometry borderRadius;\n  final bool elevated;\n  \n  const AppCard({\n    super.key,\n    required this.child,\n    this.padding = const EdgeInsets.all(16),\n    this.color,\n    this.borderRadius = const BorderRadius.all(Radius.circular(12)),\n    this.elevated = true,\n  });\n  \n  @override\n  Widget build(BuildContext context) {\n    final theme = Theme.of(context);\n    \n    return Container(\n      decoration: BoxDecoration(\n        color: color ?? theme.colorScheme.surface,\n        borderRadius: borderRadius,\n        boxShadow: elevated\n            ? [\n                BoxShadow(\n                  color: Colors.black.withOpacity(0.1),\n                  blurRadius: 8,\n                  offset: const Offset(0, 2),\n                ),\n              ]\n            : null,\n      ),\n      child: Padding(\n        padding: padding,\n        child: child,\n      ),\n    );\n  }\n}",
                    "loading_indicator.dart": "import 'package:flutter/material.dart';\n\nclass LoadingIndicator extends StatelessWidget {\n  final String? message;\n  \n  const LoadingIndicator({super.key, this.message});\n  \n  @override\n  Widget build(BuildContext context) {\n    return Center(\n      child: Column(\n        mainAxisAlignment: MainAxisAlignment.center,\n        children: [\n          const CircularProgressIndicator(),\n          if (message != null) ...[\n            const SizedBox(height: 16),\n            Text(\n              message!,\n              style: Theme.of(context).textTheme.bodyMedium,\n            ),\n          ],\n        ],\n      ),\n    );\n  }\n}",
                    "empty_state.dart": "import 'package:flutter/material.dart';\n\nclass EmptyState extends StatelessWidget {\n  final IconData icon;\n  final String title;\n  final String message;\n  final String? buttonText;\n  final VoidCallback? onButtonPressed;\n  \n  const EmptyState({\n    super.key,\n    required this.icon,\n    required this.title,\n    required this.message,\n    this.buttonText,\n    this.onButtonPressed,\n  });\n  \n  @override\n  Widget build(BuildContext context) {\n    final theme = Theme.of(context);\n    \n    return Center(\n      child: Padding(\n        padding: const EdgeInsets.all(32),\n        child: Column(\n          mainAxisAlignment: MainAxisAlignment.center,\n          children: [\n            Icon(\n              icon,\n              size: 64,\n              color: theme.colorScheme.onSurface.withOpacity(0.3),\n            ),\n            const SizedBox(height: 24),\n            Text(\n              title,\n              style: theme.textTheme.headlineSmall?.copyWith(\n                color: theme.colorScheme.onSurface.withOpacity(0.7),\n              ),\n            ),\n            const SizedBox(height: 12),\n            Text(\n              message,\n              textAlign: TextAlign.center,\n              style: theme.textTheme.bodyLarge?.copyWith(\n                color: theme.colorScheme.onSurface.withOpacity(0.5),\n              ),\n            ),\n            if (buttonText != null && onButtonPressed != null) ...[\n              const SizedBox(height: 24),\n              ElevatedButton(\n                onPressed: onButtonPressed,\n                child: Text(buttonText!),\n              ),\n            ],\n          ],\n        ),\n      ),\n    );\n  }\n}"
                  },
                  "task": {
                    "task_card.dart": "import 'package:flutter/material.dart';\nimport 'package:flutter_slidable/flutter_slidable.dart';\nimport 'package:todo_pro/data/models/task_model.dart';\nimport 'package:todo_pro/core/utils/extensions.dart';\nimport 'package:todo_pro/core/utils/date_utils.dart';\n\nclass TaskCard extends StatelessWidget {\n  final TaskModel task;\n  final VoidCallback onTap;\n  final VoidCallback onDelete;\n  final VoidCallback onToggleStatus;\n  \n  const TaskCard({\n    super.key,\n    required this.task,\n    required this.onTap,\n    required this.onDelete,\n    required this.onToggleStatus,\n  });\n  \n  @override\n  Widget build(BuildContext context) {\n    final theme = Theme.of(context);\n    \n    return Padding(\n      padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 4),\n      child: Slidable(\n        endActionPane: ActionPane(\n          motion: const ScrollMotion(),\n          children: [\n            SlidableAction(\n              onPressed: (_) => onToggleStatus(),\n              backgroundColor: theme.colorScheme.secondary,\n              foregroundColor: theme.colorScheme.onSecondary,\n              icon: task.status == TaskStatus.completed\n                  ? Icons.undo\n                  : Icons.check,\n              label: task.status == TaskStatus.completed\n                  ? 'Undo'\n                  : 'Complete',\n            ),\n            SlidableAction(\n              onPressed: (_) => onDelete(),\n              backgroundColor: Colors.red,\n              foregroundColor: Colors.white,\n              icon: Icons.delete,\n              label: 'Delete',\n            ),\n          ],\n        ),\n        child: Card(\n          elevation: 2,\n          child: ListTile(\n            onTap: onTap,\n            leading: CircleAvatar(\n              backgroundColor: task.priority.color.withOpacity(0.1),\n              child: Icon(\n                task.status.icon,\n                color: task.priority.color,\n                size: 20,\n              ),\n            ),\n            title: Text(\n              task.title,\n              style: theme.textTheme.titleMedium?.copyWith(\n                decoration: task.status == TaskStatus.completed\n                    ? TextDecoration.lineThrough\n                    : null,\n                color: task.status == TaskStatus.completed\n                    ? theme.colorScheme.onSurface.withOpacity(0.5)\n                    : theme.colorScheme.onSurface,\n              ),\n            ),\n            subtitle: Column(\n              crossAxisAlignment: CrossAxisAlignment.start,\n              children: [\n                if (task.description != null && task.description!.isNotEmpty)\n                  Padding(\n                    padding: const EdgeInsets.only(bottom: 4),\n                    child: Text(\n                      task.description!,\n                      maxLines: 1,\n                      overflow: TextOverflow.ellipsis,\n                      style: theme.textTheme.bodySmall?.copyWith(\n                        color: theme.colorScheme.onSurface.withOpacity(0.6),\n                      ),\n                    ),\n                  ),\n                Wrap(\n                  spacing: 8,\n                  children: [\n                    Chip(\n                      label: Text(task.category),\n                      visualDensity: VisualDensity.compact,\n                      backgroundColor: theme.colorScheme.secondary.withOpacity(0.1),\n                    ),\n                    Chip(\n                      label: Text(task.priority.name),\n                      visualDensity: VisualDensity.compact,\n                      backgroundColor: task.priority.color.withOpacity(0.1),\n                      labelStyle: TextStyle(color: task.priority.color),\n                    ),\n                  ],\n                ),\n              ],\n            ),\n            trailing: Column(\n              mainAxisAlignment: MainAxisAlignment.center,\n              crossAxisAlignment: CrossAxisAlignment.end,\n              children: [\n                Text(\n                  DateUtils.formatDate(task.dueDate),\n                  style: theme.textTheme.bodySmall?.copyWith(\n                    color: theme.colorScheme.onSurface.withOpacity(0.6),\n                    fontWeight: FontWeight.w500,\n                  ),\n                ),\n                if (task.isOverdue)\n                  Text(\n                    'Overdue',\n                    style: theme.textTheme.bodySmall?.copyWith(\n                      color: Colors.red,\n                    ),\n                  ),\n              ],\n            ),\n          ),\n        ),\n      ),\n    );\n  }\n}",
                    "task_stats_card.dart": "import 'package:flutter/material.dart';\nimport 'package:provider/provider.dart';\nimport 'package:todo_pro/presentation/providers/task_provider.dart';\n\nclass TaskStatsCard extends StatelessWidget {\n  const TaskStatsCard({super.key});\n  \n  @override\n  Widget build(BuildContext context) {\n    final provider = Provider.of<TaskProvider>(context);\n    final theme = Theme.of(context);\n    \n    return Card(\n      elevation: 2,\n      child: Padding(\n        padding: const EdgeInsets.all(16),\n        child: Row(\n          mainAxisAlignment: MainAxisAlignment.spaceAround,\n          children: [\n            _buildStatItem(\n              context,\n              'Total',\n              provider.totalTasks.toString(),\n              Icons.list,\n              theme.colorScheme.primary,\n            ),\n            _buildStatItem(\n              context,\n              'Pending',\n              provider.pendingTasks.toString(),\n              Icons.access_time,\n              Colors.orange,\n            ),\n            _buildStatItem(\n              context,\n              'Completed',\n              provider.completedTasks.toString(),\n              Icons.check_circle,\n              Colors.green,\n            ),\n          ],\n        ),\n      ),\n    );\n  }\n  \n  Widget _buildStatItem(\n    BuildContext context,\n    String label,\n    String value,\n    IconData icon,\n    Color color,\n  ) {\n    final theme = Theme.of(context);\n    \n    return Column(\n      children: [\n        CircleAvatar(\n          backgroundColor: color.withOpacity(0.1),\n          child: Icon(icon, color: color, size: 20),\n        ),\n        const SizedBox(height: 8),\n        Text(\n          value,\n          style: theme.textTheme.titleLarge?.copyWith(\n            fontWeight: FontWeight.bold,\n          ),\n        ),\n        Text(\n          label,\n          style: theme.textTheme.bodySmall?.copyWith(\n            color: theme.colorScheme.onSurface.withOpacity(0.6),\n          ),\n        ),\n      ],\n    );\n  }\n}",
                    "priority_selector.dart": "import 'package:flutter/material.dart';\nimport 'package:todo_pro/core/constants/enums.dart';\nimport 'package:todo_pro/core/utils/extensions.dart';\n\nclass PrioritySelector extends StatelessWidget {\n  final TaskPriority selectedPriority;\n  final ValueChanged<TaskPriority> onChanged;\n  \n  const PrioritySelector({\n    super.key,\n    required this.selectedPriority,\n    required this.onChanged,\n  });\n  \n  @override\n  Widget build(BuildContext context) {\n    return Column(\n      crossAxisAlignment: CrossAxisAlignment.start,\n      children: [\n        Text(\n          'Priority',\n          style: Theme.of(context).textTheme.titleMedium?.copyWith(\n            fontWeight: FontWeight.w600,\n          ),\n        ),\n        const SizedBox(height: 8),\n        Row(\n          children: TaskPriority.values.map((priority) {\n            return Expanded(\n              child: Padding(\n                padding: const EdgeInsets.symmetric(horizontal: 4),\n                child: _PriorityChip(\n                  priority: priority,\n                  selected: selectedPriority == priority,\n                  onTap: () => onChanged(priority),\n                ),\n              ),\n            );\n          }).toList(),\n        ),\n      ],\n    );\n  }\n}\n\nclass _PriorityChip extends StatelessWidget {\n  final TaskPriority priority;\n  final bool selected;\n  final VoidCallback onTap;\n  \n  const _PriorityChip({\n    required this.priority,\n    required this.selected,\n    required this.onTap,\n  });\n  \n  @override\n  Widget build(BuildContext context) {\n    final theme = Theme.of(context);\n    \n    return InkWell(\n      onTap: onTap,\n      borderRadius: BorderRadius.circular(8),\n      child: Container(\n        padding: const EdgeInsets.symmetric(vertical: 12, horizontal: 8),\n        decoration: BoxDecoration(\n          color: selected\n              ? priority.color\n              : priority.color.withOpacity(0.1),\n          borderRadius: BorderRadius.circular(8),\n          border: Border.all(\n            color: selected ? priority.color : Colors.transparent,\n            width: 2,\n          ),\n        ),\n        child: Column(\n          children: [\n            Icon(\n              priority.icon,\n              color: selected ? Colors.white : priority.color,\n            ),\n            const SizedBox(height: 4),\n            Text(\n              priority.name,\n              style: theme.textTheme.labelMedium?.copyWith(\n                color: selected ? Colors.white : priority.color,\n                fontWeight: FontWeight.w600,\n              ),\n            ),\n          ],\n        ),\n      ),\n    );\n  }\n}"
                  }
                },
                "screens": {
                  "home": {
                    "home_screen.dart": "import 'package:flutter/material.dart';\nimport 'package:provider/provider.dart';\nimport 'package:todo_pro/presentation/providers/task_provider.dart';\nimport 'package:todo_pro/presentation/widgets/task/task_card.dart';\nimport 'package:todo_pro/presentation/widgets/task/task_stats_card.dart';\nimport 'package:todo_pro/presentation/widgets/common/empty_state.dart';\nimport 'package:todo_pro/presentation/widgets/common/loading_indicator.dart';\nimport 'package:todo_pro/core/constants/enums.dart';\n\nclass HomeScreen extends StatefulWidget {\n  const HomeScreen({super.key});\n\n  @override\n  State<HomeScreen> createState() => _HomeScreenState();\n}\n\nclass _HomeScreenState extends State<HomeScreen> {\n  @override\n  Widget build(BuildContext context) {\n    return Scaffold(\n      appBar: AppBar(\n        title: const Text('Todo Pro'),\n        actions: [\n          PopupMenuButton<SortType>(\n            onSelected: (type) {\n              context.read<TaskProvider>().setSortType(type);\n            },\n            itemBuilder: (context) => [\n              const PopupMenuItem(\n                value: SortType.date,\n                child: Text('Sort by Date'),\n              ),\n              const PopupMenuItem(\n                value: SortType.priority,\n                child: Text('Sort by Priority'),\n              ),\n              const PopupMenuItem(\n                value: SortType.title,\n                child: Text('Sort by Title'),\n              ),\n              const PopupMenuItem(\n                value: SortType.category,\n                child: Text('Sort by Category'),\n              ),\n            ],\n          ),\n          PopupMenuButton<FilterType>(\n            onSelected: (type) {\n              context.read<TaskProvider>().setFilterType(type);\n            },\n            itemBuilder: (context) => [\n              const PopupMenuItem(\n                value: FilterType.all,\n                child: Text('All Tasks'),\n              ),\n              const PopupMenuItem(\n                value: FilterType.today,\n                child: Text('Due Today'),\n              ),\n              const PopupMenuItem(\n                value: FilterType.upcoming,\n                child: Text('Upcoming'),\n              ),\n              const PopupMenuItem(\n                value: FilterType.pending,\n                child: Text('Pending'),\n              ),\n              const PopupMenuItem(\n                value: FilterType.completed,\n                child: Text('Completed'),\n              ),\n            ],\n          ),\n        ],\n      ),\n      body: Consumer<TaskProvider>(\n        builder: (context, provider, _) {\n          if (provider.isLoading) {\n            return const LoadingIndicator(message: 'Loading tasks...');\n          }\n          \n          if (provider.errorMessage != null) {\n            return Center(\n              child: Column(\n                mainAxisAlignment: MainAxisAlignment.center,\n                children: [\n                  const Icon(Icons.error_outline, size: 64, color: Colors.red),\n                  const SizedBox(height: 16),\n                  Text(\n                    'Error',\n                    style: Theme.of(context).textTheme.titleLarge,\n                  ),\n                  const SizedBox(height: 8),\n                  Padding(\n                    padding: const EdgeInsets.symmetric(horizontal: 32),\n                    child: Text(\n                      provider.errorMessage!,\n                      textAlign: TextAlign.center,\n                      style: Theme.of(context).textTheme.bodyMedium,\n                    ),\n                  ),\n                  const SizedBox(height: 16),\n                  ElevatedButton(\n                    onPressed: () => provider._loadTasks(),\n                    child: const Text('Retry'),\n                  ),\n                ],\n              ),\n            );\n          }\n          \n          final tasks = provider.tasks;\n          \n          if (tasks.isEmpty) {\n            return EmptyState(\n              icon: Icons.task_outlined,\n              title: 'No Tasks',\n              message: provider.filterType == FilterType.all\n                  ? 'Tap the + button to create your first task!'\n                  : 'No tasks found with the current filter',\n              buttonText: provider.filterType != FilterType.all\n                  ? 'Show All Tasks'\n                  : null,\n              onButtonPressed: provider.filterType != FilterType.all\n                  ? () => provider.setFilterType(FilterType.all)\n                  : null,\n            );\n          }\n          \n          return RefreshIndicator(\n            onRefresh: () => provider._loadTasks(),\n            child: ListView(\n              children: [\n                const TaskStatsCard(),\n                const SizedBox(height: 16),\n                ...tasks.map((task) => TaskCard(\n                  task: task,\n                  onTap: () => _navigateToEditTask(context, task),\n                  onDelete: () => _showDeleteDialog(context, task),\n                  onToggleStatus: () => _toggleTaskStatus(provider, task),\n                )),\n              ],\n            ),\n          );\n        },\n      ),\n      floatingActionButton: FloatingActionButton(\n        onPressed: () => _navigateToAddTask(context),\n        child: const Icon(Icons.add),\n      ),\n    );\n  }\n  \n  void _navigateToAddTask(BuildContext context) {\n    Navigator.pushNamed(context, '/add_task');\n  }\n  \n  void _navigateToEditTask(BuildContext context, TaskModel task) {\n    Navigator.pushNamed(context, '/edit_task', arguments: task);\n  }\n  \n  void _showDeleteDialog(BuildContext context, TaskModel task) {\n    showDialog(\n      context: context,\n      builder: (context) => AlertDialog(\n        title: const Text('Delete Task'),\n        content: Text('Are you sure you want to delete \"${task.title}\"?'),\n        actions: [\n          TextButton(\n            onPressed: () => Navigator.pop(context),\n            child: const Text('Cancel'),\n          ),\n          TextButton(\n            onPressed: () {\n              context.read<TaskProvider>().deleteTask(task.id);\n              Navigator.pop(context);\n            },\n            child: const Text('Delete', style: TextStyle(color: Colors.red)),\n          ),\n        ],\n      ),\n    );\n  }\n  \n  void _toggleTaskStatus(TaskProvider provider, TaskModel task) {\n    final newStatus = task.status == TaskStatus.completed\n        ? TaskStatus.pending\n        : TaskStatus.completed;\n    \n    provider.updateTask(task.copyWith(status: newStatus));\n  }\n}"
                  },
                  "task": {
                    "add_task_screen.dart": "import 'package:flutter/material.dart';\nimport 'package:provider/provider.dart';\nimport 'package:todo_pro/presentation/providers/task_provider.dart';\nimport 'package:todo_pro/data/models/task_model.dart';\nimport 'package:todo_pro/presentation/widgets/task/priority_selector.dart';\nimport 'package:todo_pro/core/constants/enums.dart';\nimport 'package:todo_pro/core/constants/app_constants.dart';\nimport 'package:todo_pro/core/utils/validation_utils.dart';\n\nclass AddTaskScreen extends StatefulWidget {\n  const AddTaskScreen({super.key});\n\n  @override\n  State<AddTaskScreen> createState() => _AddTaskScreenState();\n}\n\nclass _AddTaskScreenState extends State<AddTaskScreen> {\n  final _formKey = GlobalKey<FormState>();\n  final _titleController = TextEditingController();\n  final _descriptionController = TextEditingController();\n  \n  TaskPriority _selectedPriority = TaskPriority.medium;\n  String _selectedCategory = 'Personal';\n  DateTime _selectedDate = DateTime.now();\n  TimeOfDay _selectedTime = TimeOfDay.now();\n  bool _hasReminder = false;\n  \n  @override\n  void dispose() {\n    _titleController.dispose();\n    _descriptionController.dispose();\n    super.dispose();\n  }\n  \n  Future<void> _selectDate(BuildContext context) async {\n    final picked = await showDatePicker(\n      context: context,\n      initialDate: _selectedDate,\n      firstDate: DateTime.now(),\n      lastDate: DateTime.now().add(const Duration(days: 365 * 5)),\n    );\n    \n    if (picked != null) {\n      setState(() => _selectedDate = picked);\n    }\n  }\n  \n  Future<void> _selectTime(BuildContext context) async {\n    final picked = await showTimePicker(\n      context: context,\n      initialTime: _selectedTime,\n    );\n    \n    if (picked != null) {\n      setState(() => _selectedTime = picked);\n    }\n  }\n  \n  void _saveTask() {\n    if (!_formKey.currentState!.validate()) return;\n    \n    final dueDateTime = DateTime(\n      _selectedDate.year,\n      _selectedDate.month,\n      _selectedDate.day,\n      _selectedTime.hour,\n      _selectedTime.minute,\n    );\n    \n    final task = TaskModel.create(\n      title: _titleController.text.trim(),\n      description: _descriptionController.text.trim().isEmpty\n          ? null\n          : _descriptionController.text.trim(),\n      dueDate: dueDateTime,\n      priority: _selectedPriority,\n      category: _selectedCategory,\n      hasReminder: _hasReminder,\n    );\n    \n    final provider = context.read<TaskProvider>();\n    provider.addTask(task);\n    \n    Navigator.pop(context);\n  }\n  \n  @override\n  Widget build(BuildContext context) {\n    return Scaffold(\n      appBar: AppBar(\n        title: const Text('Add New Task'),\n        actions: [\n          IconButton(\n            onPressed: _saveTask,\n            icon: const Icon(Icons.save),\n          ),\n        ],\n      ),\n      body: SingleChildScrollView(\n        padding: const EdgeInsets.all(16),\n        child: Form(\n          key: _formKey,\n          child: Column(\n            crossAxisAlignment: CrossAxisAlignment.start,\n            children: [\n              TextFormField(\n                controller: _titleController,\n                decoration: const InputDecoration(\n                  labelText: 'Task Title *',\n                  hintText: 'Enter task title',\n                  border: OutlineInputBorder(),\n                ),\n                validator: ValidationUtils.validateTaskTitle,\n                maxLength: AppConstants.maxTitleLength,\n                autofocus: true,\n              ),\n              const SizedBox(height: 16),\n              TextFormField(\n                controller: _descriptionController,\n                decoration: const InputDecoration(\n                  labelText: 'Description',\n                  hintText: 'Enter task description (optional)',\n                  border: OutlineInputBorder(),\n                ),\n                maxLines: 4,\n                validator: ValidationUtils.validateTaskDescription,\n                maxLength: AppConstants.maxDescriptionLength,\n              ),\n              const SizedBox(height: 24),\n              PrioritySelector(\n                selectedPriority: _selectedPriority,\n                onChanged: (priority) => \n                    setState(() => _selectedPriority = priority),\n              ),\n              const SizedBox(height: 24),\n              const Text(\n                'Category',\n                style: TextStyle(fontWeight: FontWeight.w600, fontSize: 16),\n              ),\n              const SizedBox(height: 8),\n              Wrap(\n                spacing: 8,\n                runSpacing: 8,\n                children: AppConstants.categoryOptions.map((category) {\n                  return FilterChip(\n                    label: Text(category),\n                    selected: _selectedCategory == category,\n                    onSelected: (_) => \n                        setState(() => _selectedCategory = category),\n                  );\n                }).toList(),\n              ),\n              const SizedBox(height: 24),\n              const Text(\n                'Due Date & Time',\n                style: TextStyle(fontWeight: FontWeight.w600, fontSize: 16),\n              ),\n              const SizedBox(height: 8),\n              Row(\n                children: [\n                  Expanded(\n                    child: OutlinedButton(\n                      onPressed: () => _selectDate(context),\n                      style: OutlinedButton.styleFrom(\n                        padding: const EdgeInsets.symmetric(vertical: 16),\n                      ),\n                      child: Text(\n                        '${_selectedDate.year}-${_selectedDate.month.toString().padLeft(2, '0')}-${_selectedDate.day.toString().padLeft(2, '0')}',\n                      ),\n                    ),\n                  ),\n                  const SizedBox(width: 16),\n                  Expanded(\n                    child: OutlinedButton(\n                      onPressed: () => _selectTime(context),\n                      style: OutlinedButton.styleFrom(\n                        padding: const EdgeInsets.symmetric(vertical: 16),\n                      ),\n                      child: Text(\n                        '${_selectedTime.hour.toString().padLeft(2, '0')}:${_selectedTime.minute.toString().padLeft(2, '0')}',\n                      ),\n                    ),\n                  ),\n                ],\n              ),\n              const SizedBox(height: 16),\n              SwitchListTile(\n                title: const Text('Set Reminder'),\n                subtitle: const Text('Get notified before the due time'),\n                value: _hasReminder,\n                onChanged: (value) => setState(() => _hasReminder = value),\n              ),\n              const SizedBox(height: 32),\n              SizedBox(\n                width: double.infinity,\n                child: ElevatedButton(\n                  onPressed: _saveTask,\n                  style: ElevatedButton.styleFrom(\n                    padding: const EdgeInsets.symmetric(vertical: 16),\n                  ),\n                  child: const Text('Create Task', style: TextStyle(fontSize: 16)),\n                ),\n              ),\n            ],\n          ),\n        ),\n      ),\n    );\n  }\n}"
                  },
                  "settings": {
                    "settings_screen.dart": "import 'package:flutter/material.dart';\nimport 'package:provider/provider.dart';\nimport 'package:todo_pro/presentation/providers/task_provider.dart';\n\nclass SettingsScreen extends StatelessWidget {\n  const SettingsScreen({super.key});\n\n  @override\n  Widget build(BuildContext context) {\n    return Scaffold(\n      appBar: AppBar(title: const Text('Settings')),\n      body: ListView(\n        children: [\n          const Padding(\n            padding: EdgeInsets.all(16),\n            child: Text(\n              'Data Management',\n              style: TextStyle(fontSize: 18, fontWeight: FontWeight.w600),\n            ),\n          ),\n          ListTile(\n            leading: const Icon(Icons.delete_sweep),\n            title: const Text('Clear All Data'),\n            subtitle: const Text('Delete all tasks permanently'),\n            onTap: () => _showClearAllDialog(context),\n          ),\n          const Divider(),\n          const Padding(\n            padding: EdgeInsets.all(16),\n            child: Text(\n              'Appearance',\n              style: TextStyle(fontSize: 18, fontWeight: FontWeight.w600),\n            ),\n          ),\n          ListTile(\n            leading: const Icon(Icons.dark_mode),\n            title: const Text('Dark Mode'),\n            subtitle: const Text('Toggle dark/light theme'),\n            trailing: Switch(\n              value: false,\n              onChanged: (_) {},\n            ),\n          ),\n          const Divider(),\n          const Padding(\n            padding: EdgeInsets.all(16),\n            child: Text(\n              'About',\n              style: TextStyle(fontSize: 18, fontWeight: FontWeight.w600),\n            ),\n          ),\n          ListTile(\n            leading: const Icon(Icons.info_outline),\n            title: const Text('Version'),\n            subtitle: const Text('1.0.0'),\n          ),\n          ListTile(\n            leading: const Icon(Icons.code),\n            title: const Text('Source Code'),\n            subtitle: const Text('GitHub Repository'),\n            onTap: () {},\n          ),\n        ],\n      ),\n    );\n  }\n  \n  void _showClearAllDialog(BuildContext context) {\n    showDialog(\n      context: context,\n      builder: (context) => AlertDialog(\n        title: const Text('Clear All Data'),\n        content: const Text(\n          'This will permanently delete all tasks. This action cannot be undone.',\n        ),\n        actions: [\n          TextButton(\n            onPressed: () => Navigator.pop(context),\n            child: const Text('Cancel'),\n          ),\n          TextButton(\n            onPressed: () {\n              context.read<TaskProvider>().deleteAllTasks();\n              Navigator.pop(context);\n            },\n            child: const Text('Delete All', style: TextStyle(color: Colors.red)),\n          ),\n        ],\n      ),\n    );\n  }\n}"
                  }
                }
              }
            }
          }
        }
      }
    ]
  },
  {
    "dataset_name": "flutter_ecommerce_supabase_app",
    "metadata": {
      "framework": "Flutter 3.0+",
      "architecture": "Clean Architecture with Riverpod",
      "state_management": "Riverpod",
      "backend": "Supabase (PostgreSQL + Storage + Auth)",
      "payment_gateway": "Stripe Integration via Supabase",
      "dependencies": [
        "supabase_flutter",
        "riverpod",
        "flutter_stripe",
        "cached_network_image",
        "image_picker",
        "carousel_slider",
        "intl",
        "google_maps_flutter",
        "geolocator",
        "url_launcher",
        "share_plus",
        "uuid",
        "equatable",
        "shimmer",
        "badges",
        "pull_to_refresh",
        "flutter_local_notifications"
      ],
      "target_platforms": [
        "Android",
        "iOS",
        "Web"
      ],
      "created": "2024-01-15",
      "version": "1.0.0"
    },
    "instructions": [
      {
        "instruction": "Create a full-featured Flutter e-commerce application with Supabase backend, including buyers, sellers, and admin functionality. The app should have real-time features, RLS (Row Level Security), product management, cart, wishlist, orders, reviews, and Stripe payments.",
        "input": "",
        "output": {
          "project_structure": {
            "supashop_multivendor": {
              "pubspec.yaml": "name: supashop_multivendor\ndescription: Multi-Vendor E-Commerce with Supabase\nversion: 1.0.0+1\npublish_to: 'none'\n\nenvironment:\n  sdk: '>=3.0.0 <4.0.0'\n  flutter: '>=3.0.0'\n\ndependencies:\n  flutter:\n    sdk: flutter\n  \n  # Supabase\n  supabase_flutter: ^2.3.1\n  \n  # State Management\n  riverpod: ^2.4.9\n  flutter_riverpod: ^2.4.9\n  \n  # UI & Utilities\n  cached_network_image: ^3.3.0\n  image_picker: ^1.0.4\n  carousel_slider: ^4.2.1\n  intl: ^0.19.0\n  google_maps_flutter: ^2.5.0\n  geolocator: ^11.0.1\n  url_launcher: ^6.2.2\n  share_plus: ^7.2.1\n  badges: ^3.0.1\n  shimmer: ^3.0.0\n  pull_to_refresh: ^2.0.0\n  flutter_local_notifications: ^16.1.0\n  \n  # Payment\n  flutter_stripe: ^9.0.0\n  \n  # Data\n  uuid: ^4.2.0\n  equatable: ^2.0.5\n  \n  # Forms & Validation\n  flutter_form_builder: ^9.0.0\n  form_builder_validators: ^9.0.0\n\nflutter:\n  uses-material-design: true\n  generate: true\n\n  assets:\n    - assets/images/\n    - assets/icons/\n    - assets/animations/\n\n  fonts:\n    - family: Inter\n      fonts:\n        - asset: fonts/Inter-Regular.ttf\n        - asset: fonts/Inter-Medium.ttf\n          weight: 500\n        - asset: fonts/Inter-SemiBold.ttf\n          weight: 600\n        - asset: fonts/Inter-Bold.ttf\n          weight: 700",
              "lib": {
                "main.dart": "import 'package:flutter/material.dart';\nimport 'package:supashop_multivendor/app.dart';\nimport 'package:supashop_multivendor/core/supabase/supabase_client.dart';\nimport 'package:flutter_riverpod/flutter_riverpod.dart';\n\nFuture<void> main() async {\n  WidgetsFlutterBinding.ensureInitialized();\n  \n  // Initialize Supabase\n  await SupabaseClient.initialize();\n  \n  runApp(\n    ProviderScope(\n      child: MyApp(),\n    ),\n  );\n}\n\nclass MyApp extends StatelessWidget {\n  @override\n  Widget build(BuildContext context) {\n    return MaterialApp(\n      title: 'Supashop',\n      debugShowCheckedModeBanner: false,\n      theme: ThemeData(\n        useMaterial3: true,\n        colorScheme: ColorScheme.fromSeed(\n          seedColor: Color(0xFF7C3AED),\n          brightness: Brightness.light,\n        ),\n        fontFamily: 'Inter',\n      ),\n      darkTheme: ThemeData(\n        useMaterial3: true,\n        colorScheme: ColorScheme.fromSeed(\n          seedColor: Color(0xFF7C3AED),\n          brightness: Brightness.dark,\n        ),\n      ),\n      themeMode: ThemeMode.system,\n      home: const App(),\n    );\n  }\n}",
                "app.dart": "import 'package:flutter/material.dart';\nimport 'package:flutter_riverpod/flutter_riverpod.dart';\nimport 'package:supashop_multivendor/presentation/screens/auth/auth_screen.dart';\nimport 'package:supashop_multivendor/presentation/screens/buyer/buyer_home_screen.dart';\nimport 'package:supashop_multivendor/presentation/screens/seller/seller_dashboard_screen.dart';\nimport 'package:supashop_multivendor/presentation/screens/admin/admin_dashboard_screen.dart';\nimport 'package:supashop_multivendor/core/providers/auth_provider.dart';\n\nclass App extends ConsumerWidget {\n  const App({super.key});\n\n  @override\n  Widget build(BuildContext context, WidgetRef ref) {\n    final authState = ref.watch(authProvider);\n    \n    return authState.when(\n      data: (user) {\n        if (user == null) {\n          return const AuthScreen();\n        }\n        \n        // Route based on user role\n        switch (user.role) {\n          case UserRole.buyer:\n            return const BuyerHomeScreen();\n          case UserRole.seller:\n            return const SellerDashboardScreen();\n          case UserRole.admin:\n            return const AdminDashboardScreen();\n          default:\n            return const AuthScreen();\n        }\n      },\n      loading: () => const Scaffold(\n        body: Center(\n          child: CircularProgressIndicator(),\n        ),\n      ),\n      error: (error, stack) => Scaffold(\n        body: Center(\n          child: Text('Error: $error'),\n        ),\n      ),\n    );\n  }\n}",
                "core": {
                  "constants": {
                    "app_constants.dart": "class AppConstants {\n  static const String appName = 'Supashop';\n  static const String supabaseUrl = 'YOUR_SUPABASE_URL';\n  static const String supabaseAnonKey = 'YOUR_SUPABASE_ANON_KEY';\n  \n  // Storage bucket names\n  static const String productsBucket = 'products';\n  static const String userAvatarsBucket = 'user-avatars';\n  static const String shopLogosBucket = 'shop-logos';\n  static const String categoryImagesBucket = 'category-images';\n  \n  // Pagination\n  static const int productsPerPage = 20;\n  static const int ordersPerPage = 15;\n  \n  // Validation\n  static const int minPasswordLength = 6;\n  static const int maxProductTitleLength = 100;\n  static const int maxProductDescriptionLength = 2000;\n  \n  // Stripe\n  static const String stripePublishableKey = 'YOUR_STRIPE_PUBLISHABLE_KEY';\n  \n  // Default values\n  static const List<String> productConditions = [\n    'New',\n    'Used - Like New',\n    'Used - Good',\n    'Used - Fair',\n  ];\n  \n  static const List<String> orderStatuses = [\n    'pending',\n    'confirmed',\n    'processing',\n    'shipped',\n    'delivered',\n    'cancelled',\n    'refunded',\n  ];\n  \n  static const List<String> shippingMethods = [\n    'Standard Shipping',\n    'Express Shipping',\n    'Pickup',\n  ];\n}",
                    "enums.dart": "enum UserRole { buyer, seller, admin }\nenum ProductStatus { active, draft, sold, outOfStock, discontinued }\nenum OrderStatus { pending, confirmed, processing, shipped, delivered, cancelled, refunded }\nenum PaymentMethod { card, cashOnDelivery, bankTransfer, wallet }\nenum PaymentStatus { pending, processing, completed, failed, refunded }\nenum ReviewStatus { pending, approved, rejected }",
                    "routes.dart": "class AppRoutes {\n  // Auth\n  static const String auth = '/';\n  static const String register = '/register';\n  static const String forgotPassword = '/forgot-password';\n  \n  // Buyer\n  static const String buyerHome = '/buyer/home';\n  static const String productDetails = '/product/details';\n  static const String shopDetails = '/shop/details';\n  static const String cart = '/cart';\n  static const String checkout = '/checkout';\n  static const String orders = '/orders';\n  static const String orderDetails = '/order/details';\n  static const String wishlist = '/wishlist';\n  static const String profile = '/profile';\n  static const String addressBook = '/addresses';\n  static const String paymentMethods = '/payment-methods';\n  \n  // Seller\n  static const String sellerDashboard = '/seller/dashboard';\n  static const String sellerProducts = '/seller/products';\n  static const String addProduct = '/seller/products/add';\n  static const String editProduct = '/seller/products/edit';\n  static const String sellerOrders = '/seller/orders';\n  static const String sellerAnalytics = '/seller/analytics';\n  static const String shopSettings = '/seller/settings';\n  \n  // Admin\n  static const String adminDashboard = '/admin/dashboard';\n  static const String adminUsers = '/admin/users';\n  static const String adminShops = '/admin/shops';\n  static const String adminProducts = '/admin/products';\n  static const String adminOrders = '/admin/orders';\n  static const String adminCategories = '/admin/categories';\n  static const String adminSettings = '/admin/settings';\n}"
                  },
                  "supabase": {
                    "supabase_client.dart": "import 'package:supabase_flutter/supabase_flutter.dart';\nimport 'package:supashop_multivendor/core/constants/app_constants.dart';\n\nclass SupabaseClient {\n  static late final SupabaseClient _instance;\n  static Supabase get client => Supabase.instance;\n  \n  static Future<void> initialize() async {\n    await Supabase.initialize(\n      url: AppConstants.supabaseUrl,\n      anonKey: AppConstants.supabaseAnonKey,\n      authCallbackUrlHostname: 'login-callback', // For deep linking\n      debug: true, // Enable in development\n    );\n  }\n  \n  // Auth methods\n  static User? get currentUser => client.auth.currentUser;\n  \n  static Future<AuthResponse> signUp({\n    required String email,\n    required String password,\n    required Map<String, dynamic> userData,\n  }) async {\n    return await client.auth.signUp(\n      email: email,\n      password: password,\n      data: userData,\n    );\n  }\n  \n  static Future<AuthResponse> signInWithEmail({\n    required String email,\n    required String password,\n  }) async {\n    return await client.auth.signInWithPassword(\n      email: email,\n      password: password,\n    );\n  }\n  \n  static Future<void> signOut() async {\n    await client.auth.signOut();\n  }\n  \n  static Future<void> resetPassword(String email) async {\n    await client.auth.resetPasswordForEmail(email);\n  }\n  \n  // Database methods\n  static PostgrestFilterBuilder<dynamic> from(String table) {\n    return client.from(table);\n  }\n  \n  // Storage methods\n  static SupabaseStorageClient get storage => client.storage;\n  \n  static Future<String> uploadFile({\n    required String bucket,\n    required String path,\n    required String fileName,\n    required File file,\n  }) async {\n    final response = await storage\n        .from(bucket)\n        .uploadBinary(\n          '$path/$fileName',\n          await file.readAsBytes(),\n          fileOptions: const FileOptions(\n            upsert: true,\n            contentType: 'image/jpeg',\n          ),\n        );\n    \n    return storage.from(bucket).getPublicUrl('$path/$fileName');\n  }\n  \n  static Future<void> deleteFile({\n    required String bucket,\n    required String path,\n  }) async {\n    await storage.from(bucket).remove([path]);\n  }\n  \n  // Realtime subscriptions\n  static RealtimeChannel channel(String name) {\n    return client.channel(name);\n  }\n}",
                    "tables.sql": "-- SQL for Supabase tables with RLS policies\n\n-- Users table\nCREATE TABLE users (\n  id UUID REFERENCES auth.users ON DELETE CASCADE PRIMARY KEY,\n  email TEXT UNIQUE NOT NULL,\n  full_name TEXT,\n  phone TEXT,\n  avatar_url TEXT,\n  role TEXT DEFAULT 'buyer' CHECK (role IN ('buyer', 'seller', 'admin')),\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n  last_login TIMESTAMP WITH TIME ZONE\n);\n\n-- Enable RLS\nALTER TABLE users ENABLE ROW LEVEL SECURITY;\n\n-- RLS Policies for users\nCREATE POLICY \"Users can view own profile\" ON users\n  FOR SELECT USING (auth.uid() = id);\n\nCREATE POLICY \"Users can update own profile\" ON users\n  FOR UPDATE USING (auth.uid() = id);\n\nCREATE POLICY \"Admins can view all users\" ON users\n  FOR SELECT USING (\n    EXISTS (\n      SELECT 1 FROM users WHERE id = auth.uid() AND role = 'admin'\n    )\n  );\n\n-- Shops table\nCREATE TABLE shops (\n  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n  seller_id UUID REFERENCES users(id) ON DELETE CASCADE,\n  name TEXT NOT NULL,\n  slug TEXT UNIQUE NOT NULL,\n  description TEXT,\n  logo_url TEXT,\n  cover_url TEXT,\n  address JSONB,\n  contact_email TEXT,\n  contact_phone TEXT,\n  is_verified BOOLEAN DEFAULT false,\n  is_active BOOLEAN DEFAULT true,\n  rating NUMERIC(3, 2) DEFAULT 0,\n  total_ratings INTEGER DEFAULT 0,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Products table\nCREATE TABLE products (\n  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n  shop_id UUID REFERENCES shops(id) ON DELETE CASCADE,\n  category_id UUID REFERENCES categories(id),\n  title TEXT NOT NULL,\n  slug TEXT UNIQUE NOT NULL,\n  description TEXT,\n  price DECIMAL(10, 2) NOT NULL,\n  compare_price DECIMAL(10, 2),\n  cost DECIMAL(10, 2),\n  sku TEXT,\n  barcode TEXT,\n  quantity INTEGER DEFAULT 0,\n  weight DECIMAL(10, 2),\n  weight_unit TEXT DEFAULT 'kg',\n  condition TEXT DEFAULT 'New',\n  images TEXT[],\n  attributes JSONB,\n  tags TEXT[],\n  rating NUMERIC(3, 2) DEFAULT 0,\n  total_ratings INTEGER DEFAULT 0,\n  total_sales INTEGER DEFAULT 0,\n  status TEXT DEFAULT 'active' CHECK (status IN ('active', 'draft', 'sold', 'out_of_stock', 'discontinued')),\n  is_featured BOOLEAN DEFAULT false,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Categories table\nCREATE TABLE categories (\n  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n  parent_id UUID REFERENCES categories(id),\n  name TEXT NOT NULL,\n  slug TEXT UNIQUE NOT NULL,\n  description TEXT,\n  image_url TEXT,\n  sort_order INTEGER DEFAULT 0,\n  is_active BOOLEAN DEFAULT true,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Orders table\nCREATE TABLE orders (\n  id TEXT PRIMARY KEY, -- Custom format: ORD-YYYYMMDD-XXXX\n  buyer_id UUID REFERENCES users(id) ON DELETE CASCADE,\n  seller_id UUID REFERENCES users(id),\n  shop_id UUID REFERENCES shops(id),\n  shipping_address JSONB NOT NULL,\n  billing_address JSONB,\n  items JSONB NOT NULL, -- Array of order items\n  subtotal DECIMAL(10, 2) NOT NULL,\n  shipping_fee DECIMAL(10, 2) DEFAULT 0,\n  tax_amount DECIMAL(10, 2) DEFAULT 0,\n  discount_amount DECIMAL(10, 2) DEFAULT 0,\n  total_amount DECIMAL(10, 2) NOT NULL,\n  payment_method TEXT NOT NULL,\n  payment_status TEXT DEFAULT 'pending',\n  order_status TEXT DEFAULT 'pending',\n  tracking_number TEXT,\n  shipping_carrier TEXT,\n  notes TEXT,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Cart items table\nCREATE TABLE cart_items (\n  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n  user_id UUID REFERENCES users(id) ON DELETE CASCADE,\n  product_id UUID REFERENCES products(id) ON DELETE CASCADE,\n  quantity INTEGER NOT NULL DEFAULT 1,\n  selected_variants JSONB,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n  UNIQUE(user_id, product_id)\n);\n\n-- Wishlist table\nCREATE TABLE wishlist (\n  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n  user_id UUID REFERENCES users(id) ON DELETE CASCADE,\n  product_id UUID REFERENCES products(id) ON DELETE CASCADE,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n  UNIQUE(user_id, product_id)\n);\n\n-- Reviews table\nCREATE TABLE reviews (\n  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n  user_id UUID REFERENCES users(id) ON DELETE CASCADE,\n  product_id UUID REFERENCES products(id) ON DELETE CASCADE,\n  order_id TEXT REFERENCES orders(id),\n  rating INTEGER NOT NULL CHECK (rating >= 1 AND rating <= 5),\n  title TEXT,\n  comment TEXT,\n  images TEXT[],\n  status TEXT DEFAULT 'pending' CHECK (status IN ('pending', 'approved', 'rejected')),\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Addresses table\nCREATE TABLE addresses (\n  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n  user_id UUID REFERENCES users(id) ON DELETE CASCADE,\n  label TEXT NOT NULL,\n  full_name TEXT NOT NULL,\n  phone TEXT NOT NULL,\n  address_line1 TEXT NOT NULL,\n  address_line2 TEXT,\n  city TEXT NOT NULL,\n  state TEXT NOT NULL,\n  country TEXT NOT NULL,\n  postal_code TEXT NOT NULL,\n  is_default BOOLEAN DEFAULT false,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Create indexes\nCREATE INDEX idx_products_shop_id ON products(shop_id);\nCREATE INDEX idx_products_category_id ON products(category_id);\nCREATE INDEX idx_orders_buyer_id ON orders(buyer_id);\nCREATE INDEX idx_orders_seller_id ON orders(seller_id);\nCREATE INDEX idx_reviews_product_id ON reviews(product_id);"
                  },
                  "models": {
                    "user_model.dart": "import 'package:equatable/equatable.dart';\nimport 'package:supashop_multivendor/core/constants/enums.dart';\n\nclass UserModel extends Equatable {\n  final String id;\n  final String email;\n  final String? fullName;\n  final String? phone;\n  final String? avatarUrl;\n  final UserRole role;\n  final DateTime? createdAt;\n  final DateTime? updatedAt;\n  final DateTime? lastLogin;\n  \n  const UserModel({\n    required this.id,\n    required this.email,\n    this.fullName,\n    this.phone,\n    this.avatarUrl,\n    this.role = UserRole.buyer,\n    this.createdAt,\n    this.updatedAt,\n    this.lastLogin,\n  });\n  \n  factory UserModel.fromJson(Map<String, dynamic> json) {\n    return UserModel(\n      id: json['id'],\n      email: json['email'],\n      fullName: json['full_name'],\n      phone: json['phone'],\n      avatarUrl: json['avatar_url'],\n      role: UserRole.values.firstWhere(\n        (e) => e.name == json['role'],\n        orElse: () => UserRole.buyer,\n      ),\n      createdAt: json['created_at'] != null\n          ? DateTime.parse(json['created_at'])\n          : null,\n      updatedAt: json['updated_at'] != null\n          ? DateTime.parse(json['updated_at'])\n          : null,\n      lastLogin: json['last_login'] != null\n          ? DateTime.parse(json['last_login'])\n          : null,\n    );\n  }\n  \n  Map<String, dynamic> toJson() {\n    return {\n      'id': id,\n      'email': email,\n      'full_name': fullName,\n      'phone': phone,\n      'avatar_url': avatarUrl,\n      'role': role.name,\n      'created_at': createdAt?.toIso8601String(),\n      'updated_at': updatedAt?.toIso8601String(),\n      'last_login': lastLogin?.toIso8601String(),\n    };\n  }\n  \n  UserModel copyWith({\n    String? fullName,\n    String? phone,\n    String? avatarUrl,\n    UserRole? role,\n  }) {\n    return UserModel(\n      id: id,\n      email: email,\n      fullName: fullName ?? this.fullName,\n      phone: phone ?? this.phone,\n      avatarUrl: avatarUrl ?? this.avatarUrl,\n      role: role ?? this.role,\n      createdAt: createdAt,\n      updatedAt: updatedAt,\n      lastLogin: lastLogin,\n    );\n  }\n  \n  bool get isSeller => role == UserRole.seller;\n  bool get isAdmin => role == UserRole.admin;\n  bool get isBuyer => role == UserRole.buyer;\n  \n  @override\n  List<Object?> get props => [\n    id,\n    email,\n    fullName,\n    phone,\n    avatarUrl,\n    role,\n  ];\n}",
                    "product_model.dart": "import 'package:equatable/equatable.dart';\nimport 'package:supashop_multivendor/core/constants/enums.dart';\n\nclass ProductModel extends Equatable {\n  final String id;\n  final String shopId;\n  final String? categoryId;\n  final String title;\n  final String slug;\n  final String? description;\n  final double price;\n  final double? comparePrice;\n  final double? cost;\n  final String? sku;\n  final String? barcode;\n  final int quantity;\n  final double? weight;\n  final String weightUnit;\n  final String condition;\n  final List<String> images;\n  final Map<String, dynamic>? attributes;\n  final List<String> tags;\n  final double rating;\n  final int totalRatings;\n  final int totalSales;\n  final ProductStatus status;\n  final bool isFeatured;\n  final DateTime createdAt;\n  final DateTime updatedAt;\n  \n  const ProductModel({\n    required this.id,\n    required this.shopId,\n    this.categoryId,\n    required this.title,\n    required this.slug,\n    this.description,\n    required this.price,\n    this.comparePrice,\n    this.cost,\n    this.sku,\n    this.barcode,\n    required this.quantity,\n    this.weight,\n    this.weightUnit = 'kg',\n    this.condition = 'New',\n    this.images = const [],\n    this.attributes,\n    this.tags = const [],\n    this.rating = 0,\n    this.totalRatings = 0,\n    this.totalSales = 0,\n    this.status = ProductStatus.active,\n    this.isFeatured = false,\n    required this.createdAt,\n    required this.updatedAt,\n  });\n  \n  factory ProductModel.fromJson(Map<String, dynamic> json) {\n    return ProductModel(\n      id: json['id'],\n      shopId: json['shop_id'],\n      categoryId: json['category_id'],\n      title: json['title'],\n      slug: json['slug'],\n      description: json['description'],\n      price: (json['price'] as num).toDouble(),\n      comparePrice: json['compare_price'] != null\n          ? (json['compare_price'] as num).toDouble()\n          : null,\n      cost: json['cost'] != null ? (json['cost'] as num).toDouble() : null,\n      sku: json['sku'],\n      barcode: json['barcode'],\n      quantity: json['quantity'] ?? 0,\n      weight: json['weight'] != null ? (json['weight'] as num).toDouble() : null,\n      weightUnit: json['weight_unit'] ?? 'kg',\n      condition: json['condition'] ?? 'New',\n      images: List<String>.from(json['images'] ?? []),\n      attributes: json['attributes'],\n      tags: List<String>.from(json['tags'] ?? []),\n      rating: (json['rating'] as num?)?.toDouble() ?? 0,\n      totalRatings: json['total_ratings'] ?? 0,\n      totalSales: json['total_sales'] ?? 0,\n      status: ProductStatus.values.firstWhere(\n        (e) => e.name == json['status'],\n        orElse: () => ProductStatus.active,\n      ),\n      isFeatured: json['is_featured'] ?? false,\n      createdAt: DateTime.parse(json['created_at']),\n      updatedAt: DateTime.parse(json['updated_at']),\n    );\n  }\n  \n  double get discountPercent {\n    if (comparePrice == null || comparePrice! <= price) return 0;\n    return ((comparePrice! - price) / comparePrice!) * 100;\n  }\n  \n  bool get isOutOfStock => quantity <= 0;\n  bool get hasDiscount => discountPercent > 0;\n  \n  @override\n  List<Object?> get props => [id, title, slug];\n}"
                  },
                  "providers": {
                    "auth_provider.dart": "import 'package:flutter_riverpod/flutter_riverpod.dart';\nimport 'package:supashop_multivendor/core/supabase/supabase_client.dart';\nimport 'package:supashop_multivendor/core/models/user_model.dart';\n\nfinal authProvider = StreamProvider<UserModel?>((ref) async* {\n  // Listen to auth state changes\n  final authChanges = SupabaseClient.client.auth.onAuthStateChange;\n  \n  await for (final event in authChanges) {\n    final user = event.session?.user;\n    \n    if (user == null) {\n      yield null;\n      continue;\n    }\n    \n    // Get user profile from database\n    try {\n      final response = await SupabaseClient.from('users')\n          .select()\n          .eq('id', user.id)\n          .single();\n      \n      yield UserModel.fromJson(response);\n    } catch (e) {\n      // Create user profile if doesn't exist\n      final newUser = UserModel(\n        id: user.id,\n        email: user.email!,\n        fullName: user.userMetadata?['full_name'],\n        avatarUrl: user.userMetadata?['avatar_url'],\n        role: UserRole.buyer,\n        createdAt: DateTime.now(),\n      );\n      \n      await SupabaseClient.from('users').insert(newUser.toJson());\n      yield newUser;\n    }\n  }\n});",
                    "cart_provider.dart": "import 'package:flutter_riverpod/flutter_riverpod.dart';\nimport 'package:supashop_multivendor/core/supabase/supabase_client.dart';\nimport 'package:supashop_multivendor/core/models/product_model.dart';\n\nclass CartItem {\n  final String id;\n  final ProductModel product;\n  final int quantity;\n  final Map<String, dynamic>? selectedVariants;\n  \n  CartItem({\n    required this.id,\n    required this.product,\n    this.quantity = 1,\n    this.selectedVariants,\n  });\n  \n  double get totalPrice => product.price * quantity;\n}\n\nfinal cartProvider = StateNotifierProvider<CartNotifier, List<CartItem>>((ref) {\n  return CartNotifier();\n});\n\nclass CartNotifier extends StateNotifier<List<CartItem>> {\n  CartNotifier() : super([]) {\n    _loadCart();\n  }\n  \n  Future<void> _loadCart() async {\n    final user = SupabaseClient.currentUser;\n    if (user == null) return;\n    \n    try {\n      final response = await SupabaseClient.from('cart_items')\n          .select('*, product:products(*)')\n          .eq('user_id', user.id);\n      \n      final items = response.map((item) {\n        return CartItem(\n          id: item['id'],\n          product: ProductModel.fromJson(item['product']),\n          quantity: item['quantity'],\n          selectedVariants: item['selected_variants'],\n        );\n      }).toList();\n      \n      state = items;\n    } catch (e) {\n      print('Error loading cart: $e');\n    }\n  }\n  \n  Future<void> addToCart({\n    required ProductModel product,\n    int quantity = 1,\n    Map<String, dynamic>? variants,\n  }) async {\n    final user = SupabaseClient.currentUser;\n    if (user == null) throw Exception('User not logged in');\n    \n    try {\n      await SupabaseClient.from('cart_items').upsert({\n        'user_id': user.id,\n        'product_id': product.id,\n        'quantity': quantity,\n        'selected_variants': variants,\n      });\n      \n      await _loadCart();\n    } catch (e) {\n      throw Exception('Failed to add to cart: $e');\n    }\n  }\n  \n  Future<void> updateQuantity(String itemId, int newQuantity) async {\n    if (newQuantity <= 0) {\n      await removeFromCart(itemId);\n      return;\n    }\n    \n    try {\n      await SupabaseClient.from('cart_items')\n          .update({'quantity': newQuantity})\n          .eq('id', itemId);\n      \n      await _loadCart();\n    } catch (e) {\n      throw Exception('Failed to update quantity: $e');\n    }\n  }\n  \n  Future<void> removeFromCart(String itemId) async {\n    try {\n      await SupabaseClient.from('cart_items').delete().eq('id', itemId);\n      await _loadCart();\n    } catch (e) {\n      throw Exception('Failed to remove from cart: $e');\n    }\n  }\n  \n  Future<void> clearCart() async {\n    final user = SupabaseClient.currentUser;\n    if (user == null) return;\n    \n    try {\n      await SupabaseClient.from('cart_items')\n          .delete()\n          .eq('user_id', user.id);\n      \n      state = [];\n    } catch (e) {\n      throw Exception('Failed to clear cart: $e');\n    }\n  }\n  \n  double get subtotal => state.fold(\n    0,\n    (total, item) => total + item.totalPrice,\n  );\n  \n  int get itemCount => state.fold(\n    0,\n    (count, item) => count + item.quantity,\n  );\n}"
                  }
                },
                "presentation": {
                  "screens": {
                    "auth": {
                      "auth_screen.dart": "import 'package:flutter/material.dart';\nimport 'package:flutter_riverpod/flutter_riverpod.dart';\nimport 'package:supashop_multivendor/presentation/widgets/auth/auth_form.dart';\n\nclass AuthScreen extends ConsumerWidget {\n  const AuthScreen({super.key});\n\n  @override\n  Widget build(BuildContext context, WidgetRef ref) {\n    return Scaffold(\n      body: SafeArea(\n        child: SingleChildScrollView(\n          child: Padding(\n            padding: const EdgeInsets.all(24),\n            child: Column(\n              crossAxisAlignment: CrossAxisAlignment.start,\n              children: [\n                const SizedBox(height: 40),\n                Text(\n                  'Welcome to\\nSupashop',\n                  style: Theme.of(context).textTheme.headlineLarge?.copyWith(\n                    fontWeight: FontWeight.bold,\n                  ),\n                ),\n                const SizedBox(height: 8),\n                Text(\n                  'Shop from thousands of vendors worldwide',\n                  style: Theme.of(context).textTheme.bodyLarge?.copyWith(\n                    color: Theme.of(context).colorScheme.onSurface.withOpacity(0.6),\n                  ),\n                ),\n                const SizedBox(height: 48),\n                const AuthForm(),\n                const SizedBox(height: 32),\n                Row(\n                  children: [\n                    Expanded(\n                      child: Divider(\n                        color: Theme.of(context).colorScheme.onSurface.withOpacity(0.2),\n                      ),\n                    ),\n                    Padding(\n                      padding: const EdgeInsets.symmetric(horizontal: 16),\n                      child: Text(\n                        'Or continue with',\n                        style: Theme.of(context).textTheme.bodySmall,\n                      ),\n                    ),\n                    Expanded(\n                      child: Divider(\n                        color: Theme.of(context).colorScheme.onSurface.withOpacity(0.2),\n                      ),\n                    ),\n                  ],\n                ),\n                const SizedBox(height: 24),\n                Row(\n                  mainAxisAlignment: MainAxisAlignment.center,\n                  children: [\n                    IconButton.outlined(\n                      onPressed: () {\n                        // Google sign in\n                      },\n                      icon: Image.asset(\n                        'assets/icons/google.png',\n                        width: 24,\n                        height: 24,\n                      ),\n                    ),\n                    const SizedBox(width: 16),\n                    IconButton.outlined(\n                      onPressed: () {\n                        // Apple sign in\n                      },\n                      icon: const Icon(Icons.apple),\n                    ),\n                  ],\n                ),\n              ],\n            ),\n          ),\n        ),\n      ),\n    );\n  }\n}"
                    },
                    "buyer": {
                      "home_screen.dart": "import 'package:flutter/material.dart';\nimport 'package:flutter_riverpod/flutter_riverpod.dart';\nimport 'package:cached_network_image/cached_network_image.dart';\nimport 'package:carousel_slider/carousel_slider.dart';\nimport 'package:supashop_multivendor/core/providers/product_provider.dart';\nimport 'package:supashop_multivendor/presentation/widgets/product/product_card.dart';\n\nclass BuyerHomeScreen extends ConsumerWidget {\n  const BuyerHomeScreen({super.key});\n\n  @override\n  Widget build(BuildContext context, WidgetRef ref) {\n    final productsAsync = ref.watch(featuredProductsProvider);\n    final categoriesAsync = ref.watch(categoriesProvider);\n    \n    return Scaffold(\n      appBar: AppBar(\n        title: TextField(\n          decoration: InputDecoration(\n            hintText: 'Search products...',\n            prefixIcon: const Icon(Icons.search),\n            border: OutlineInputBorder(\n              borderRadius: BorderRadius.circular(12),\n              borderSide: BorderSide.none,\n            ),\n            filled: true,\n            contentPadding: const EdgeInsets.symmetric(horizontal: 16),\n          ),\n          onTap: () {\n            // Navigate to search screen\n          },\n        ),\n        actions: [\n          IconButton(\n            onPressed: () {\n              // Navigate to cart\n            },\n            icon: Badge(\n              label: Consumer(\n                builder: (context, ref, child) {\n                  final cartCount = ref.watch(cartProvider).length;\n                  return Text(cartCount.toString());\n                },\n              ),\n              child: const Icon(Icons.shopping_cart_outlined),\n            ),\n          ),\n        ],\n      ),\n      body: RefreshIndicator(\n        onRefresh: () async {\n          ref.invalidate(featuredProductsProvider);\n          ref.invalidate(categoriesProvider);\n        },\n        child: SingleChildScrollView(\n          child: Column(\n            children: [\n              // Banner Carousel\n              CarouselSlider(\n                options: CarouselOptions(\n                  height: 180,\n                  autoPlay: true,\n                  viewportFraction: 0.9,\n                ),\n                items: [1, 2, 3].map((i) {\n                  return Container(\n                    margin: const EdgeInsets.symmetric(horizontal: 4),\n                    decoration: BoxDecoration(\n                      borderRadius: BorderRadius.circular(12),\n                      image: DecorationImage(\n                        image: CachedNetworkImageProvider(\n                          'https://picsum.photos/800/400?random=$i',\n                        ),\n                        fit: BoxFit.cover,\n                      ),\n                    ),\n                  );\n                }).toList(),\n              ),\n              const SizedBox(height: 24),\n              \n              // Categories\n              Padding(\n                padding: const EdgeInsets.symmetric(horizontal: 16),\n                child: Column(\n                  crossAxisAlignment: CrossAxisAlignment.start,\n                  children: [\n                    Row(\n                      mainAxisAlignment: MainAxisAlignment.spaceBetween,\n                      children: [\n                        Text(\n                          'Categories',\n                          style: Theme.of(context).textTheme.titleLarge?.copyWith(\n                            fontWeight: FontWeight.bold,\n                          ),\n                        ),\n                        TextButton(\n                          onPressed: () {},\n                          child: const Text('View All'),\n                        ),\n                      ],\n                    ),\n                    const SizedBox(height: 12),\n                    categoriesAsync.when(\n                      data: (categories) {\n                        return SizedBox(\n                          height: 100,\n                          child: ListView.builder(\n                            scrollDirection: Axis.horizontal,\n                            itemCount: categories.length,\n                            itemBuilder: (context, index) {\n                              final category = categories[index];\n                              return Padding(\n                                padding: const EdgeInsets.only(right: 12),\n                                child: Column(\n                                  children: [\n                                    CircleAvatar(\n                                      radius: 32,\n                                      backgroundImage: category.imageUrl != null\n                                          ? CachedNetworkImageProvider(category.imageUrl!)\n                                          : null,\n                                      child: category.imageUrl == null\n                                          ? const Icon(Icons.category)\n                                          : null,\n                                    ),\n                                    const SizedBox(height: 8),\n                                    Text(\n                                      category.name,\n                                      style: Theme.of(context).textTheme.labelSmall,\n                                    ),\n                                  ],\n                                ),\n                              );\n                            },\n                          ),\n                        );\n                      },\n                      loading: () => const SizedBox(\n                        height: 100,\n                        child: Center(child: CircularProgressIndicator()),\n                      ),\n                      error: (error, stack) => Text('Error: $error'),\n                    ),\n                  ],\n                ),\n              ),\n              \n              // Featured Products\n              Padding(\n                padding: const EdgeInsets.all(16),\n                child: Column(\n                  crossAxisAlignment: CrossAxisAlignment.start,\n                  children: [\n                    Text(\n                      'Featured Products',\n                      style: Theme.of(context).textTheme.titleLarge?.copyWith(\n                        fontWeight: FontWeight.bold,\n                      ),\n                    ),\n                    const SizedBox(height: 16),\n                    productsAsync.when(\n                      data: (products) {\n                        return GridView.builder(\n                          shrinkWrap: true,\n                          physics: const NeverScrollableScrollPhysics(),\n                          gridDelegate: const SliverGridDelegateWithFixedCrossAxisCount(\n                            crossAxisCount: 2,\n                            crossAxisSpacing: 12,\n                            mainAxisSpacing: 12,\n                            childAspectRatio: 0.7,\n                          ),\n                          itemCount: products.length,\n                          itemBuilder: (context, index) {\n                            final product = products[index];\n                            return ProductCard(product: product);\n                          },\n                        );\n                      },\n                      loading: () => const Center(child: CircularProgressIndicator()),\n                      error: (error, stack) => Text('Error: $error'),\n                    ),\n                  ],\n                ),\n              ),\n            ],\n          ),\n        ),\n      ),\n      bottomNavigationBar: BottomNavigationBar(\n        items: const [\n          BottomNavigationBarItem(\n            icon: Icon(Icons.home_outlined),\n            activeIcon: Icon(Icons.home),\n            label: 'Home',\n          ),\n          BottomNavigationBarItem(\n            icon: Icon(Icons.explore_outlined),\n            activeIcon: Icon(Icons.explore),\n            label: 'Explore',\n          ),\n          BottomNavigationBarItem(\n            icon: Icon(Icons.favorite_outline),\n            activeIcon: Icon(Icons.favorite),\n            label: 'Wishlist',\n          ),\n          BottomNavigationBarItem(\n            icon: Icon(Icons.person_outline),\n            activeIcon: Icon(Icons.person),\n            label: 'Profile',\n          ),\n        ],\n      ),\n    );\n  }\n}"
                    },
                    "seller": {
                      "dashboard_screen.dart": "import 'package:flutter/material.dart';\nimport 'package:flutter_riverpod/flutter_riverpod.dart';\nimport 'package:supashop_multivendor/core/providers/seller_provider.dart';\n\nclass SellerDashboardScreen extends ConsumerWidget {\n  const SellerDashboardScreen({super.key});\n\n  @override\n  Widget build(BuildContext context, WidgetRef ref) {\n    final statsAsync = ref.watch(sellerStatsProvider);\n    \n    return Scaffold(\n      appBar: AppBar(\n        title: const Text('Seller Dashboard'),\n        actions: [\n          IconButton(\n            onPressed: () {\n              // Navigate to add product\n            },\n            icon: const Icon(Icons.add),\n          ),\n        ],\n      ),\n      body: statsAsync.when(\n        data: (stats) {\n          return SingleChildScrollView(\n            padding: const EdgeInsets.all(16),\n            child: Column(\n              children: [\n                // Stats Cards\n                GridView.count(\n                  shrinkWrap: true,\n                  physics: const NeverScrollableScrollPhysics(),\n                  crossAxisCount: 2,\n                  crossAxisSpacing: 12,\n                  mainAxisSpacing: 12,\n                  childAspectRatio: 1.2,\n                  children: [\n                    _buildStatCard(\n                      context,\n                      'Total Sales',\n                      '\\\\\\$${stats.totalSales.toStringAsFixed(2)}',\n                      Icons.attach_money,\n                      Colors.green,\n                    ),\n                    _buildStatCard(\n                      context,\n                      'Total Orders',\n                      stats.totalOrders.toString(),\n                      Icons.shopping_bag,\n                      Colors.blue,\n                    ),\n                    _buildStatCard(\n                      context,\n                      'Total Products',\n                      stats.totalProducts.toString(),\n                      Icons.inventory,\n                      Colors.orange,\n                    ),\n                    _buildStatCard(\n                      context,\n                      'Total Revenue',\n                      '\\\\\\$${stats.totalRevenue.toStringAsFixed(2)}',\n                      Icons.trending_up,\n                      Colors.purple,\n                    ),\n                  ],\n                ),\n                const SizedBox(height: 24),\n                \n                // Recent Orders\n                Card(\n                  child: Padding(\n                    padding: const EdgeInsets.all(16),\n                    child: Column(\n                      crossAxisAlignment: CrossAxisAlignment.start,\n                      children: [\n                        Text(\n                          'Recent Orders',\n                          style: Theme.of(context).textTheme.titleLarge?.copyWith(\n                            fontWeight: FontWeight.bold,\n                          ),\n                        ),\n                        const SizedBox(height: 16),\n                        ListView.builder(\n                          shrinkWrap: true,\n                          physics: const NeverScrollableScrollPhysics(),\n                          itemCount: stats.recentOrders.length,\n                          itemBuilder: (context, index) {\n                            final order = stats.recentOrders[index];\n                            return ListTile(\n                              leading: CircleAvatar(\n                                child: Text(order.id.substring(0, 2)),\n                              ),\n                              title: Text('Order #${order.id}'),\n                              subtitle: Text(order.status.toUpperCase()),\n                              trailing: Text('\\\\\\$${order.total.toStringAsFixed(2)}'),\n                              onTap: () {\n                                // Navigate to order details\n                              },\n                            );\n                          },\n                        ),\n                      ],\n                    ),\n                  ),\n                ),\n              ],\n            );\n          );\n        },\n        loading: () => const Center(child: CircularProgressIndicator()),\n        error: (error, stack) => Center(child: Text('Error: $error')),\n      ),\n      bottomNavigationBar: BottomNavigationBar(\n        items: const [\n          BottomNavigationBarItem(\n            icon: Icon(Icons.dashboard_outlined),\n            activeIcon: Icon(Icons.dashboard),\n            label: 'Dashboard',\n          ),\n          BottomNavigationBarItem(\n            icon: Icon(Icons.inventory_outlined),\n            activeIcon: Icon(Icons.inventory),\n            label: 'Products',\n          ),\n          BottomNavigationBarItem(\n            icon: Icon(Icons.shopping_bag_outlined),\n            activeIcon: Icon(Icons.shopping_bag),\n            label: 'Orders',\n          ),\n          BottomNavigationBarItem(\n            icon: Icon(Icons.analytics_outlined),\n            activeIcon: Icon(Icons.analytics),\n            label: 'Analytics',\n          ),\n          BottomNavigationBarItem(\n            icon: Icon(Icons.settings_outlined),\n            activeIcon: Icon(Icons.settings),\n            label: 'Settings',\n          ),\n        ],\n      ),\n    );\n  }\n  \n  Widget _buildStatCard(\n    BuildContext context,\n    String title,\n    String value,\n    IconData icon,\n    Color color,\n  ) {\n    return Card(\n      child: Padding(\n        padding: const EdgeInsets.all(16),\n        child: Column(\n          mainAxisAlignment: MainAxisAlignment.center,\n          children: [\n            CircleAvatar(\n              backgroundColor: color.withOpacity(0.1),\n              child: Icon(icon, color: color),\n            ),\n            const SizedBox(height: 12),\n            Text(\n              value,\n              style: Theme.of(context).textTheme.headlineSmall?.copyWith(\n                fontWeight: FontWeight.bold,\n              ),\n            ),\n            Text(\n              title,\n              style: Theme.of(context).textTheme.bodySmall?.copyWith(\n                color: Theme.of(context).colorScheme.onSurface.withOpacity(0.6),\n              ),\n            ),\n          ],\n        ),\n      ),\n    );\n  }\n}"
                    },
                    "admin": {
                      "dashboard_screen.dart": "import 'package:flutter/material.dart';\nimport 'package:flutter_riverpod/flutter_riverpod.dart';\nimport 'package:supashop_multivendor/core/providers/admin_provider.dart';\n\nclass AdminDashboardScreen extends ConsumerWidget {\n  const AdminDashboardScreen({super.key});\n\n  @override\n  Widget build(BuildContext context, WidgetRef ref) {\n    final statsAsync = ref.watch(adminStatsProvider);\n    \n    return Scaffold(\n      appBar: AppBar(\n        title: const Text('Admin Dashboard'),\n        actions: [\n          IconButton(\n            onPressed: () {\n              // Admin notifications\n            },\n            icon: const Icon(Icons.notifications_outlined),\n          ),\n        ],\n      ),\n      drawer: Drawer(\n        child: ListView(\n          padding: EdgeInsets.zero,\n          children: [\n            const DrawerHeader(\n              decoration: BoxDecoration(\n                color: Colors.blue,\n              ),\n              child: Column(\n                crossAxisAlignment: CrossAxisAlignment.start,\n                children: [\n                  CircleAvatar(\n                    radius: 30,\n                    child: Icon(Icons.admin_panel_settings, size: 30),\n                  ),\n                  SizedBox(height: 12),\n                  Text(\n                    'Admin Panel',\n                    style: TextStyle(\n                      color: Colors.white,\n                      fontSize: 18,\n                      fontWeight: FontWeight.bold,\n                    ),\n                  ),\n                ],\n              ),\n            ),\n            ListTile(\n              leading: const Icon(Icons.dashboard),\n              title: const Text('Dashboard'),\n              onTap: () {},\n            ),\n            ListTile(\n              leading: const Icon(Icons.people),\n              title: const Text('Users'),\n              onTap: () {\n                // Navigate to users management\n              },\n            ),\n            ListTile(\n              leading: const Icon(Icons.store),\n              title: const Text('Shops'),\n              onTap: () {\n                // Navigate to shops management\n              },\n            ),\n            ListTile(\n              leading: const Icon(Icons.inventory),\n              title: const Text('Products'),\n              onTap: () {\n                // Navigate to products management\n              },\n            ),\n            ListTile(\n              leading: const Icon(Icons.shopping_bag),\n              title: const Text('Orders'),\n              onTap: () {\n                // Navigate to orders management\n              },\n            ),\n            ListTile(\n              leading: const Icon(Icons.category),\n              title: const Text('Categories'),\n              onTap: () {\n                // Navigate to categories management\n              },\n            ),\n            const Divider(),\n            ListTile(\n              leading: const Icon(Icons.settings),\n              title: const Text('Settings'),\n              onTap: () {\n                // Navigate to admin settings\n              },\n            ),\n            ListTile(\n              leading: const Icon(Icons.logout),\n              title: const Text('Logout'),\n              onTap: () {\n                // Sign out\n              },\n            ),\n          ],\n        ),\n      ),\n      body: statsAsync.when(\n        data: (stats) {\n          return SingleChildScrollView(\n            padding: const EdgeInsets.all(16),\n            child: Column(\n              children: [\n                // Summary Cards\n                GridView.count(\n                  shrinkWrap: true,\n                  physics: const NeverScrollableScrollPhysics(),\n                  crossAxisCount: 2,\n                  crossAxisSpacing: 12,\n                  mainAxisSpacing: 12,\n                  childAspectRatio: 1.2,\n                  children: [\n                    _buildStatCard(\n                      context,\n                      'Total Users',\n                      stats.totalUsers.toString(),\n                      Icons.people,\n                      Colors.blue,\n                    ),\n                    _buildStatCard(\n                      context,\n                      'Total Shops',\n                      stats.totalShops.toString(),\n                      Icons.store,\n                      Colors.green,\n                    ),\n                    _buildStatCard(\n                      context,\n                      'Total Products',\n                      stats.totalProducts.toString(),\n                      Icons.inventory,\n                      Colors.orange,\n                    ),\n                    _buildStatCard(\n                      context,\n                      'Total Orders',\n                      stats.totalOrders.toString(),\n                      Icons.shopping_bag,\n                      Colors.purple,\n                    ),\n                    _buildStatCard(\n                      context,\n                      'Today\\\\'s Revenue',\n                      '\\\\\\$${stats.todayRevenue.toStringAsFixed(2)}',\n                      Icons.attach_money,\n                      Colors.teal,\n                    ),\n                    _buildStatCard(\n                      context,\n                      'Pending Reviews',\n                      stats.pendingReviews.toString(),\n                      Icons.star,\n                      Colors.amber,\n                    ),\n                  ],\n                ),\n                const SizedBox(height: 24),\n                \n                // Recent Activities\n                Card(\n                  child: Padding(\n                    padding: const EdgeInsets.all(16),\n                    child: Column(\n                      crossAxisAlignment: CrossAxisAlignment.start,\n                      children: [\n                        Text(\n                          'Recent Activities',\n                          style: Theme.of(context).textTheme.titleLarge?.copyWith(\n                            fontWeight: FontWeight.bold,\n                          ),\n                        ),\n                        const SizedBox(height: 16),\n                        ListView.builder(\n                          shrinkWrap: true,\n                          physics: const NeverScrollableScrollPhysics(),\n                          itemCount: stats.recentActivities.length,\n                          itemBuilder: (context, index) {\n                            final activity = stats.recentActivities[index];\n                            return ListTile(\n                              leading: CircleAvatar(\n                                backgroundColor: _getActivityColor(activity.type).withOpacity(0.1),\n                                child: Icon(\n                                  _getActivityIcon(activity.type),\n                                  color: _getActivityColor(activity.type),\n                                ),\n                              ),\n                              title: Text(activity.description),\n                              subtitle: Text(activity.timeAgo),\n                            );\n                          },\n                        ),\n                      ],\n                    ),\n                  ),\n                ),\n              ],\n            );\n          );\n        },\n        loading: () => const Center(child: CircularProgressIndicator()),\n        error: (error, stack) => Center(child: Text('Error: $error')),\n      ),\n    );\n  }\n  \n  Widget _buildStatCard(\n    BuildContext context,\n    String title,\n    String value,\n    IconData icon,\n    Color color,\n  ) {\n    return Card(\n      child: Padding(\n        padding: const EdgeInsets.all(16),\n        child: Column(\n          mainAxisAlignment: MainAxisAlignment.center,\n          children: [\n            CircleAvatar(\n              backgroundColor: color.withOpacity(0.1),\n              child: Icon(icon, color: color),\n            ),\n            const SizedBox(height: 12),\n            Text(\n              value,\n              style: Theme.of(context).textTheme.headlineSmall?.copyWith(\n                fontWeight: FontWeight.bold,\n              ),\n            ),\n            Text(\n              title,\n              style: Theme.of(context).textTheme.bodySmall?.copyWith(\n                color: Theme.of(context).colorScheme.onSurface.withOpacity(0.6),\n              ),\n            ),\n          ],\n        ),\n      ),\n    );\n  }\n  \n  IconData _getActivityIcon(String type) {\n    switch (type) {\n      case 'new_user':\n        return Icons.person_add;\n      case 'new_order':\n        return Icons.shopping_bag;\n      case 'new_shop':\n        return Icons.store;\n      case 'new_review':\n        return Icons.star;\n      default:\n        return Icons.notifications;\n    }\n  }\n  \n  Color _getActivityColor(String type) {\n    switch (type) {\n      case 'new_user':\n        return Colors.blue;\n      case 'new_order':\n        return Colors.green;\n      case 'new_shop':\n        return Colors.orange;\n      case 'new_review':\n        return Colors.amber;\n      default:\n        return Colors.grey;\n    }\n  }\n}"
                    }
                  },
                  "widgets": {
                    "product_card.dart": "import 'package:flutter/material.dart';\nimport 'package:cached_network_image/cached_network_image.dart';\nimport 'package:supashop_multivendor/core/models/product_model.dart';\n\nclass ProductCard extends StatelessWidget {\n  final ProductModel product;\n  final VoidCallback? onTap;\n  final VoidCallback? onAddToCart;\n  final VoidCallback? onAddToWishlist;\n  \n  const ProductCard({\n    super.key,\n    required this.product,\n    this.onTap,\n    this.onAddToCart,\n    this.onAddToWishlist,\n  });\n  \n  @override\n  Widget build(BuildContext context) {\n    final theme = Theme.of(context);\n    \n    return Card(\n      child: InkWell(\n        onTap: onTap,\n        borderRadius: BorderRadius.circular(12),\n        child: Column(\n          crossAxisAlignment: CrossAxisAlignment.start,\n          children: [\n            // Product Image\n            Stack(\n              children: [\n                ClipRRect(\n                  borderRadius: const BorderRadius.only(\n                    topLeft: Radius.circular(12),\n                    topRight: Radius.circular(12),\n                  ),\n                  child: CachedNetworkImage(\n                    imageUrl: product.images.isNotEmpty\n                        ? product.images.first\n                        : 'https://via.placeholder.com/300',\n                    height: 150,\n                    width: double.infinity,\n                    fit: BoxFit.cover,\n                    placeholder: (context, url) => Container(\n                      color: theme.colorScheme.surfaceVariant,\n                      child: const Center(child: CircularProgressIndicator()),\n                    ),\n                    errorWidget: (context, url, error) => Container(\n                      color: theme.colorScheme.surfaceVariant,\n                      child: const Icon(Icons.image_not_supported),\n                    ),\n                  ),\n                ),\n                if (product.hasDiscount)\n                  Positioned(\n                    top: 8,\n                    left: 8,\n                    child: Container(\n                      padding: const EdgeInsets.symmetric(\n                        horizontal: 8,\n                        vertical: 4,\n                      ),\n                      decoration: BoxDecoration(\n                        color: Colors.red,\n                        borderRadius: BorderRadius.circular(4),\n                      ),\n                      child: Text(\n                        '-${product.discountPercent.toStringAsFixed(0)}%',\n                        style: const TextStyle(\n                          color: Colors.white,\n                          fontSize: 12,\n                          fontWeight: FontWeight.bold,\n                        ),\n                      ),\n                    ),\n                  ),\n                Positioned(\n                  top: 8,\n                  right: 8,\n                  child: IconButton(\n                    onPressed: onAddToWishlist,\n                    icon: const Icon(Icons.favorite_border),\n                    style: IconButton.styleFrom(\n                      backgroundColor: Colors.white,\n                      padding: const EdgeInsets.all(4),\n                    ),\n                  ),\n                ),\n              ],\n            ),\n            \n            // Product Details\n            Padding(\n              padding: const EdgeInsets.all(12),\n              child: Column(\n                crossAxisAlignment: CrossAxisAlignment.start,\n                children: [\n                  Text(\n                    product.title,\n                    style: theme.textTheme.bodyMedium?.copyWith(\n                      fontWeight: FontWeight.w600,\n                    ),\n                    maxLines: 2,\n                    overflow: TextOverflow.ellipsis,\n                  ),\n                  const SizedBox(height: 4),\n                  Row(\n                    children: [\n                      Icon(\n                        Icons.star,\n                        size: 16,\n                        color: Colors.amber,\n                      ),\n                      const SizedBox(width: 4),\n                      Text(\n                        product.rating.toStringAsFixed(1),\n                        style: theme.textTheme.labelSmall,\n                      ),\n                      const SizedBox(width: 4),\n                      Text(\n                        '(${product.totalRatings})',\n                        style: theme.textTheme.labelSmall?.copyWith(\n                          color: theme.colorScheme.onSurface.withOpacity(0.6),\n                        ),\n                      ),\n                    ],\n                  ),\n                  const SizedBox(height: 8),\n                  Row(\n                    children: [\n                      Text(\n                        '\\\\\\$${product.price.toStringAsFixed(2)}',\n                        style: theme.textTheme.titleMedium?.copyWith(\n                          fontWeight: FontWeight.bold,\n                        ),\n                      ),\n                      if (product.comparePrice != null)\n                        Padding(\n                          padding: const EdgeInsets.only(left: 8),\n                          child: Text(\n                            '\\\\\\$${product.comparePrice!.toStringAsFixed(2)}',\n                            style: theme.textTheme.bodySmall?.copyWith(\n                              decoration: TextDecoration.lineThrough,\n                              color: theme.colorScheme.onSurface.withOpacity(0.6),\n                            ),\n                          ),\n                        ),\n                      const Spacer(),\n                      if (product.isOutOfStock)\n                        Container(\n                          padding: const EdgeInsets.symmetric(\n                            horizontal: 8,\n                            vertical: 4,\n                          ),\n                          decoration: BoxDecoration(\n                            color: Colors.red.withOpacity(0.1),\n                            borderRadius: BorderRadius.circular(4),\n                          ),\n                          child: Text(\n                            'Out of Stock',\n                            style: theme.textTheme.labelSmall?.copyWith(\n                              color: Colors.red,\n                            ),\n                          ),\n                        )\n                      else\n                        IconButton(\n                          onPressed: onAddToCart,\n                          icon: const Icon(Icons.add_shopping_cart),\n                          style: IconButton.styleFrom(\n                            backgroundColor: theme.colorScheme.primary,\n                            foregroundColor: theme.colorScheme.onPrimary,\n                            padding: const EdgeInsets.all(4),\n                          ),\n                        ),\n                    ],\n                  ),\n                ],\n              ),\n            ),\n          ],\n        ),\n      ),\n    );\n  }\n}"
                  }
                }
              }
            }
          }
        }
      }
    ]
  },
  {
    "dataset_name": "supabase_fashion_store",
    "metadata": {
      "framework": "Flutter 3.0+",
      "architecture": "Clean Architecture",
      "backend": "Supabase",
      "state_management": "Riverpod",
      "database": "Supabase PostgreSQL + Hive Cache",
      "auth": "Supabase Auth",
      "storage": "Supabase Storage",
      "realtime": "Supabase Realtime",
      "dependencies": [
        "supabase_flutter",
        "riverpod",
        "hooks_riverpod",
        "cached_network_image",
        "carousel_slider",
        "flutter_rating_bar",
        "intl",
        "flutter_slidable",
        "uuid"
      ],
      "features": [
        "Supabase Auth (Email, Google, Apple)",
        "Real-time Products",
        "Shopping Cart with Supabase",
        "Wishlist Sync",
        "Order Management",
        "Product Reviews",
        "Search & Filters",
        "Push Notifications",
        "Admin Dashboard"
      ],
      "target_platforms": [
        "Android",
        "iOS",
        "Web"
      ],
      "created": "2024-01-15",
      "version": "1.0.0"
    },
    "instructions": [
      {
        "instruction": "Create a complete fashion e-commerce app using Supabase as backend with real-time features, authentication, and comprehensive product management.",
        "input": "",
        "output": {
          "project_structure": {
            "supabase_fashion": {
              "pubspec.yaml": "name: supabase_fashion\ndescription: Fashion E-commerce with Supabase\nversion: 1.0.0+1\npublish_to: 'none'\n\nenvironment:\n  sdk: '>=3.0.0 <4.0.0'\n  flutter: '>=3.0.0'\n\ndependencies:\n  flutter:\n    sdk: flutter\n  supabase_flutter: ^2.0.0\n  riverpod: ^2.3.6\n  hooks_riverpod: ^2.3.6\n  cached_network_image: ^3.2.3\n  carousel_slider: ^4.2.1\n  flutter_rating_bar: ^4.0.1\n  intl: ^0.18.1\n  flutter_slidable: ^3.0.0\n  uuid: ^3.0.7\n  equatable: ^2.0.5\n  dio: ^5.3.2\n  hive: ^2.2.3\n  hive_flutter: ^1.1.0\n  flutter_svg: ^2.0.7\n  badges: ^3.0.0\n  google_sign_in: ^6.1.5\n  sign_in_with_apple: ^5.0.0\n  flutter_secure_storage: ^9.0.0\n  shimmer: ^3.0.0\n\nflutter:\n  uses-material-design: true\n  generate: true\n  \n  assets:\n    - assets/images/\n    - assets/icons/\n    - assets/svgs/\n  \n  fonts:\n    - family: Inter\n      fonts:\n        - asset: fonts/Inter-Regular.ttf\n        - asset: fonts/Inter-Medium.ttf\n          weight: 500\n        - asset: fonts/Inter-SemiBold.ttf\n          weight: 600\n        - asset: fonts/Inter-Bold.ttf\n          weight: 700",
              "lib": {
                "main.dart": "import 'package:flutter/material.dart';\nimport 'package:supabase_flutter/supabase_flutter.dart';\nimport 'package:hive_flutter/hive_flutter.dart';\nimport 'package:supabase_fashion/app.dart';\nimport 'package:supabase_fashion/data/models/cart_item_model.dart';\nimport 'package:supabase_fashion/data/models/user_model.dart';\n\nFuture<void> main() async {\n  WidgetsFlutterBinding.ensureInitialized();\n  \n  // Initialize Supabase\n  await Supabase.initialize(\n    url: 'https://your-project.supabase.co',\n    anonKey: 'your-anon-key',\n  );\n  \n  // Initialize Hive for local storage\n  await Hive.initFlutter();\n  Hive.registerAdapter(CartItemModelAdapter());\n  Hive.registerAdapter(UserModelAdapter());\n  await Hive.openBox<CartItemModel>('local_cart');\n  await Hive.openBox<UserModel>('user_cache');\n  await Hive.openBox('app_settings');\n  \n  runApp(const MyApp());\n}\n\nclass MyApp extends StatelessWidget {\n  const MyApp({super.key});\n\n  @override\n  Widget build(BuildContext context) {\n    return MaterialApp(\n      title: 'Fashion Store',\n      debugShowCheckedModeBanner: false,\n      theme: ThemeData(\n        useMaterial3: true,\n        colorScheme: ColorScheme.fromSeed(\n          seedColor: const Color(0xFFDB3022),\n          brightness: Brightness.light,\n        ),\n        fontFamily: 'Inter',\n        appBarTheme: const AppBarTheme(\n          elevation: 0,\n          centerTitle: true,\n        ),\n      ),\n      darkTheme: ThemeData(\n        useMaterial3: true,\n        colorScheme: ColorScheme.fromSeed(\n          seedColor: const Color(0xFFDB3022),\n          brightness: Brightness.dark,\n        ),\n        fontFamily: 'Inter',\n      ),\n      themeMode: ThemeMode.system,\n      home: const App(),\n    );\n  }\n}",
                "supabase": {
                  "schema.sql": "-- Users table\nCREATE TABLE users (\n  id UUID PRIMARY KEY DEFAULT auth.uid(),\n  email TEXT UNIQUE NOT NULL,\n  full_name TEXT,\n  avatar_url TEXT,\n  phone TEXT,\n  address JSONB,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL,\n  updated_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL\n);\n\n-- Products table\nCREATE TABLE products (\n  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),\n  name TEXT NOT NULL,\n  slug TEXT UNIQUE NOT NULL,\n  description TEXT,\n  price DECIMAL(10,2) NOT NULL,\n  discount_price DECIMAL(10,2),\n  category_id UUID REFERENCES categories(id),\n  brand_id UUID REFERENCES brands(id),\n  images TEXT[] NOT NULL,\n  colors TEXT[],\n  sizes TEXT[],\n  rating DECIMAL(3,2) DEFAULT 0.00,\n  review_count INTEGER DEFAULT 0,\n  stock INTEGER DEFAULT 0,\n  is_featured BOOLEAN DEFAULT false,\n  is_new BOOLEAN DEFAULT false,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL,\n  updated_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL\n);\n\n-- Categories table\nCREATE TABLE categories (\n  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),\n  name TEXT NOT NULL,\n  slug TEXT UNIQUE NOT NULL,\n  icon TEXT,\n  parent_id UUID REFERENCES categories(id),\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL\n);\n\n-- Cart items table\nCREATE TABLE cart_items (\n  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),\n  user_id UUID REFERENCES users(id) ON DELETE CASCADE,\n  product_id UUID REFERENCES products(id) ON DELETE CASCADE,\n  quantity INTEGER NOT NULL DEFAULT 1,\n  selected_color TEXT,\n  selected_size TEXT,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL,\n  updated_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL,\n  UNIQUE(user_id, product_id, selected_color, selected_size)\n);\n\n-- Orders table\nCREATE TABLE orders (\n  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),\n  user_id UUID REFERENCES users(id) ON DELETE CASCADE,\n  order_number TEXT UNIQUE NOT NULL,\n  status TEXT DEFAULT 'pending',\n  total_amount DECIMAL(10,2) NOT NULL,\n  shipping_address JSONB NOT NULL,\n  payment_method TEXT NOT NULL,\n  payment_status TEXT DEFAULT 'pending',\n  tracking_number TEXT,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL,\n  updated_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL\n);\n\n-- Order items table\nCREATE TABLE order_items (\n  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),\n  order_id UUID REFERENCES orders(id) ON DELETE CASCADE,\n  product_id UUID REFERENCES products(id),\n  quantity INTEGER NOT NULL,\n  price DECIMAL(10,2) NOT NULL,\n  selected_color TEXT,\n  selected_size TEXT,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL\n);\n\n-- Wishlist table\nCREATE TABLE wishlist (\n  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),\n  user_id UUID REFERENCES users(id) ON DELETE CASCADE,\n  product_id UUID REFERENCES products(id) ON DELETE CASCADE,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL,\n  UNIQUE(user_id, product_id)\n);\n\n-- Reviews table\nCREATE TABLE reviews (\n  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),\n  user_id UUID REFERENCES users(id) ON DELETE CASCADE,\n  product_id UUID REFERENCES products(id) ON DELETE CASCADE,\n  rating INTEGER NOT NULL CHECK (rating >= 1 AND rating <= 5),\n  comment TEXT,\n  images TEXT[],\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL,\n  updated_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL\n);\n\n-- Enable Row Level Security\nALTER TABLE users ENABLE ROW LEVEL SECURITY;\nALTER TABLE products ENABLE ROW LEVEL SECURITY;\nALTER TABLE cart_items ENABLE ROW LEVEL SECURITY;\nALTER TABLE orders ENABLE ROW LEVEL SECURITY;\nALTER TABLE wishlist ENABLE ROW LEVEL SECURITY;\nALTER TABLE reviews ENABLE ROW LEVEL SECURITY;\n\n-- Create RLS policies\nCREATE POLICY \"Users can view own profile\" ON users\n  FOR SELECT USING (auth.uid() = id);\n\nCREATE POLICY \"Users can update own profile\" ON users\n  FOR UPDATE USING (auth.uid() = id);\n\nCREATE POLICY \"Public products view\" ON products\n  FOR SELECT USING (true);\n\nCREATE POLICY \"Authenticated users can manage cart\" ON cart_items\n  FOR ALL USING (auth.uid() = user_id);\n\nCREATE POLICY \"Authenticated users can manage orders\" ON orders\n  FOR ALL USING (auth.uid() = user_id);\n\nCREATE POLICY \"Authenticated users can manage wishlist\" ON wishlist\n  FOR ALL USING (auth.uid() = user_id);\n\nCREATE POLICY \"Authenticated users can create reviews\" ON reviews\n  FOR INSERT WITH CHECK (auth.uid() = user_id);\n\nCREATE POLICY \"Users can view all reviews\" ON reviews\n  FOR SELECT USING (true);",
                  "functions": {
                    "update_product_rating.sql": "CREATE OR REPLACE FUNCTION update_product_rating()\nRETURNS TRIGGER AS $$\nBEGIN\n  UPDATE products \n  SET \n    rating = (\n      SELECT AVG(rating) \n      FROM reviews \n      WHERE product_id = NEW.product_id\n    ),\n    review_count = (\n      SELECT COUNT(*) \n      FROM reviews \n      WHERE product_id = NEW.product_id\n    ),\n    updated_at = NOW()\n  WHERE id = NEW.product_id;\n  \n  RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\nCREATE TRIGGER update_product_rating_trigger\nAFTER INSERT OR UPDATE OR DELETE ON reviews\nFOR EACH ROW\nEXECUTE FUNCTION update_product_rating();",
                    "generate_order_number.sql": "CREATE OR REPLACE FUNCTION generate_order_number()\nRETURNS TRIGGER AS $$\nBEGIN\n  NEW.order_number := 'ORD-' || \n    TO_CHAR(NEW.created_at, 'YYYYMMDD') || \n    '-' || \n    LPAD(NEW.id::TEXT, 8, '0');\n  RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\nCREATE TRIGGER generate_order_number_trigger\nBEFORE INSERT ON orders\nFOR EACH ROW\nEXECUTE FUNCTION generate_order_number();"
                  },
                  "storage_buckets.json": "{\n  \"buckets\": [\n    {\n      \"name\": \"product-images\",\n      \"public\": true,\n      \"file_size_limit\": 5242880,\n      \"allowed_mime_types\": [\"image/jpeg\", \"image/png\", \"image/webp\"]\n    },\n    {\n      \"name\": \"user-avatars\",\n      \"public\": true,\n      \"file_size_limit\": 2097152,\n      \"allowed_mime_types\": [\"image/jpeg\", \"image/png\", \"image/webp\"]\n    },\n    {\n      \"name\": \"review-images\",\n      \"public\": true,\n      \"file_size_limit\": 3145728,\n      \"allowed_mime_types\": [\"image/jpeg\", \"image/png\", \"image/webp\"]\n    }\n  ]\n}"
                },
                "core": {
                  "constants": {
                    "supabase_constants.dart": "class SupabaseConstants {\n  static const String supabaseUrl = 'https://your-project.supabase.co';\n  static const String supabaseAnonKey = 'your-anon-key';\n  \n  // Tables\n  static const String usersTable = 'users';\n  static const String productsTable = 'products';\n  static const String categoriesTable = 'categories';\n  static const String cartItemsTable = 'cart_items';\n  static const String ordersTable = 'orders';\n  static const String orderItemsTable = 'order_items';\n  static const String wishlistTable = 'wishlist';\n  static const String reviewsTable = 'reviews';\n  \n  // Storage buckets\n  static const String productImagesBucket = 'product-images';\n  static const String userAvatarsBucket = 'user-avatars';\n  static const String reviewImagesBucket = 'review-images';\n  \n  // Realtime channels\n  static const String productsChannel = 'products';\n  static const String ordersChannel = 'orders';\n  \n  // Functions\n  static const String checkoutFunction = 'stripe_checkout';\n  static const String createPaymentIntent = 'create_payment_intent';\n  \n  // Auth\n  static const List<String> authProviders = ['google', 'apple', 'email'];\n  \n  // Query constants\n  static const int productsPerPage = 20;\n  static const int cartSyncBatchSize = 10;\n}"
                  }
                },
                "data": {
                  "models": {
                    "supabase_product_model.dart": "import 'package:hive/hive.dart';\nimport 'package:supabase_flutter/supabase_flutter.dart';\nimport 'package:supabase_fashion/core/constants/enums.dart';\n\npart 'supabase_product_model.g.dart';\n\n@HiveType(typeId: 1)\nclass SupabaseProductModel {\n  @HiveField(0)\n  final String id;\n  \n  @HiveField(1)\n  final String name;\n  \n  @HiveField(2)\n  final String slug;\n  \n  @HiveField(3)\n  final String description;\n  \n  @HiveField(4)\n  final double price;\n  \n  @HiveField(5)\n  final double? discountPrice;\n  \n  @HiveField(6)\n  final List<String> images;\n  \n  @HiveField(7)\n  final List<String> colors;\n  \n  @HiveField(8)\n  final List<String> sizes;\n  \n  @HiveField(9)\n  final String categoryId;\n  \n  @HiveField(10)\n  final String? brandId;\n  \n  @HiveField(11)\n  final double rating;\n  \n  @HiveField(12)\n  final int reviewCount;\n  \n  @HiveField(13)\n  final int stock;\n  \n  @HiveField(14)\n  final bool isFeatured;\n  \n  @HiveField(15)\n  final bool isNew;\n  \n  @HiveField(16)\n  final DateTime createdAt;\n  \n  @HiveField(17)\n  final DateTime updatedAt;\n  \n  SupabaseProductModel({\n    required this.id,\n    required this.name,\n    required this.slug,\n    required this.description,\n    required this.price,\n    this.discountPrice,\n    required this.images,\n    required this.colors,\n    required this.sizes,\n    required this.categoryId,\n    this.brandId,\n    this.rating = 0.0,\n    this.reviewCount = 0,\n    required this.stock,\n    this.isFeatured = false,\n    this.isNew = false,\n    required this.createdAt,\n    required this.updatedAt,\n  });\n  \n  factory SupabaseProductModel.fromJson(Map<String, dynamic> json) {\n    return SupabaseProductModel(\n      id: json['id'],\n      name: json['name'],\n      slug: json['slug'],\n      description: json['description'] ?? '',\n      price: (json['price'] as num).toDouble(),\n      discountPrice: json['discount_price'] != null\n          ? (json['discount_price'] as num).toDouble()\n          : null,\n      images: List<String>.from(json['images'] ?? []),\n      colors: List<String>.from(json['colors'] ?? []),\n      sizes: List<String>.from(json['sizes'] ?? []),\n      categoryId: json['category_id'],\n      brandId: json['brand_id'],\n      rating: (json['rating'] as num?)?.toDouble() ?? 0.0,\n      reviewCount: json['review_count'] ?? 0,\n      stock: json['stock'] ?? 0,\n      isFeatured: json['is_featured'] ?? false,\n      isNew: json['is_new'] ?? false,\n      createdAt: DateTime.parse(json['created_at']),\n      updatedAt: DateTime.parse(json['updated_at']),\n    );\n  }\n  \n  factory SupabaseProductModel.fromPostgrest(PostgrestMap json) {\n    return SupabaseProductModel.fromJson(json);\n  }\n  \n  Map<String, dynamic> toJson() {\n    return {\n      'id': id,\n      'name': name,\n      'slug': slug,\n      'description': description,\n      'price': price,\n      'discount_price': discountPrice,\n      'images': images,\n      'colors': colors,\n      'sizes': sizes,\n      'category_id': categoryId,\n      'brand_id': brandId,\n      'rating': rating,\n      'review_count': reviewCount,\n      'stock': stock,\n      'is_featured': isFeatured,\n      'is_new': isNew,\n      'created_at': createdAt.toIso8601String(),\n      'updated_at': updatedAt.toIso8601String(),\n    };\n  }\n  \n  String get firstImage => images.isNotEmpty ? images.first : '';\n  \n  double get discountedPrice => discountPrice ?? price;\n  \n  double get discountPercentage {\n    if (discountPrice == null) return 0;\n    return ((price - discountPrice!) / price * 100).roundToDouble();\n  }\n  \n  bool get hasDiscount => discountPrice != null && discountPrice! < price;\n  \n  bool get isOutOfStock => stock <= 0;\n  \n  String get formattedPrice => '\\\\\\$price.toStringAsFixed(2)';\n  \n  String get formattedDiscountedPrice => '\\\\\\$discountedPrice.toStringAsFixed(2)';\n}"
                  },
                  "repositories": {
                    "supabase_product_repository.dart": "import 'package:supabase_flutter/supabase_flutter.dart';\nimport 'package:supabase_fashion/data/models/supabase_product_model.dart';\nimport 'package:supabase_fashion/core/constants/supabase_constants.dart';\nimport 'package:supabase_fashion/core/error/failure.dart';\n\ntypedef ProductQuery = Map<String, dynamic>;\n\ntypedef ProductFilter = ({String? categoryId, double? minPrice, double? maxPrice, List<String>? colors, List<String>? sizes});\n\nabstract class SupabaseProductRepository {\n  Future<List<SupabaseProductModel>> getProducts({\n    int limit,\n    int offset,\n    ProductFilter? filter,\n    String? searchQuery,\n    String? sortBy,\n  });\n  \n  Stream<List<SupabaseProductModel>> watchProducts({\n    ProductFilter? filter,\n    String? searchQuery,\n  });\n  \n  Future<SupabaseProductModel> getProduct(String id);\n  \n  Future<List<SupabaseProductModel>> getProductsByIds(List<String> ids);\n  \n  Future<List<SupabaseProductModel>> getFeaturedProducts();\n  \n  Future<List<SupabaseProductModel>> getRelatedProducts(String productId);\n  \n  Future<void> updateProductStock(String productId, int quantity);\n}\n\nclass SupabaseProductRepositoryImpl implements SupabaseProductRepository {\n  final SupabaseClient _supabase;\n  \n  SupabaseProductRepositoryImpl(this._supabase);\n  \n  @override\n  Future<List<SupabaseProductModel>> getProducts({\n    int limit = 20,\n    int offset = 0,\n    ProductFilter? filter,\n    String? searchQuery,\n    String? sortBy,\n  }) async {\n    try {\n      var query = _supabase\n          .from(SupabaseConstants.productsTable)\n          .select('*')\n          .range(offset, offset + limit - 1);\n      \n      // Apply filters\n      if (filter != null) {\n        if (filter.categoryId != null) {\n          query = query.eq('category_id', filter.categoryId);\n        }\n        if (filter.minPrice != null) {\n          query = query.gte('price', filter.minPrice);\n        }\n        if (filter.maxPrice != null) {\n          query = query.lte('price', filter.maxPrice);\n        }\n        if (filter.colors != null && filter.colors!.isNotEmpty) {\n          query = query.contains('colors', filter.colors!);\n        }\n        if (filter.sizes != null && filter.sizes!.isNotEmpty) {\n          query = query.contains('sizes', filter.sizes!);\n        }\n      }\n      \n      // Apply search\n      if (searchQuery != null && searchQuery.isNotEmpty) {\n        query = query.ilike('name', '%\\\\$searchQuery%');\n      }\n      \n      // Apply sorting\n      if (sortBy != null) {\n        switch (sortBy) {\n          case 'price_asc':\n            query = query.order('price');\n            break;\n          case 'price_desc':\n            query = query.order('price', ascending: false);\n            break;\n          case 'rating':\n            query = query.order('rating', ascending: false);\n            break;\n          case 'newest':\n            query = query.order('created_at', ascending: false);\n            break;\n          default:\n            query = query.order('created_at', ascending: false);\n        }\n      } else {\n        query = query.order('created_at', ascending: false);\n      }\n      \n      final response = await query;\n      \n      return response\n          .map((json) => SupabaseProductModel.fromJson(json))\n          .toList();\n    } catch (e) {\n      throw DatabaseFailure('Failed to fetch products: \\\\$e');\n    }\n  }\n  \n  @override\n  Stream<List<SupabaseProductModel>> watchProducts({\n    ProductFilter? filter,\n    String? searchQuery,\n  }) {\n    return _supabase\n        .from(SupabaseConstants.productsTable)\n        .stream(primaryKey: ['id'])\n        .map((event) => event\n            .map((json) => SupabaseProductModel.fromJson(json))\n            .toList());\n  }\n  \n  @override\n  Future<SupabaseProductModel> getProduct(String id) async {\n    try {\n      final response = await _supabase\n          .from(SupabaseConstants.productsTable)\n          .select('*')\n          .eq('id', id)\n          .single();\n      \n      return SupabaseProductModel.fromJson(response);\n    } catch (e) {\n      throw DatabaseFailure('Failed to fetch product: \\\\$e');\n    }\n  }\n  \n  @override\n  Future<List<SupabaseProductModel>> getProductsByIds(List<String> ids) async {\n    try {\n      if (ids.isEmpty) return [];\n      \n      final response = await _supabase\n          .from(SupabaseConstants.productsTable)\n          .select('*')\n          .in_('id', ids);\n      \n      return response\n          .map((json) => SupabaseProductModel.fromJson(json))\n          .toList();\n    } catch (e) {\n      throw DatabaseFailure('Failed to fetch products by ids: \\\\$e');\n    }\n  }\n  \n  @override\n  Future<List<SupabaseProductModel>> getFeaturedProducts() async {\n    try {\n      final response = await _supabase\n          .from(SupabaseConstants.productsTable)\n          .select('*')\n          .eq('is_featured', true)\n          .order('created_at', ascending: false)\n          .limit(10);\n      \n      return response\n          .map((json) => SupabaseProductModel.fromJson(json))\n          .toList();\n    } catch (e) {\n      throw DatabaseFailure('Failed to fetch featured products: \\\\$e');\n    }\n  }\n  \n  @override\n  Future<List<SupabaseProductModel>> getRelatedProducts(String productId) async {\n    try {\n      // Get the product first\n      final product = await getProduct(productId);\n      \n      // Get products from same category, excluding current product\n      final response = await _supabase\n          .from(SupabaseConstants.productsTable)\n          .select('*')\n          .eq('category_id', product.categoryId)\n          .neq('id', productId)\n          .limit(5)\n          .order('rating', ascending: false);\n      \n      return response\n          .map((json) => SupabaseProductModel.fromJson(json))\n          .toList();\n    } catch (e) {\n      throw DatabaseFailure('Failed to fetch related products: \\\\$e');\n    }\n  }\n  \n  @override\n  Future<void> updateProductStock(String productId, int quantity) async {\n    try {\n      await _supabase.rpc('decrement_product_stock', params: {\n        'product_id': productId,\n        'quantity': quantity,\n      });\n    } catch (e) {\n      throw DatabaseFailure('Failed to update product stock: \\\\$e');\n    }\n  }\n}"
                  }
                },
                "presentation": {
                  "providers": {
                    "supabase_auth_provider.dart": "import 'package:flutter/foundation.dart';\nimport 'package:supabase_flutter/supabase_flutter.dart';\nimport 'package:riverpod_annotation/riverpod_annotation.dart';\nimport 'package:supabase_fashion/data/models/user_model.dart';\nimport 'package:supabase_fashion/core/error/failure.dart';\n\npart 'supabase_auth_provider.g.dart';\n\n@riverpod\nclass SupabaseAuth extends _$SupabaseAuth {\n  late SupabaseClient _supabase;\n  UserModel? _currentUser;\n  \n  @override\n  Future<UserModel?> build() async {\n    _supabase = Supabase.instance.client;\n    \n    // Check for existing session\n    final session = _supabase.auth.currentSession;\n    if (session != null) {\n      return await _getUserProfile(session.user.id);\n    }\n    \n    return null;\n  }\n  \n  Future<UserModel?> _getUserProfile(String userId) async {\n    try {\n      final response = await _supabase\n          .from('users')\n          .select('*')\n          .eq('id', userId)\n          .single();\n      \n      return UserModel.fromJson(response);\n    } catch (e) {\n      // User profile might not exist yet\n      return null;\n    }\n  }\n  \n  Future<void> signUpWithEmail({\n    required String email,\n    required String password,\n    required String fullName,\n  }) async {\n    try {\n      state = const AsyncLoading();\n      \n      // 1. Sign up with Supabase Auth\n      final authResponse = await _supabase.auth.signUp(\n        email: email,\n        password: password,\n      );\n      \n      if (authResponse.user == null) {\n        throw Failure('Sign up failed');\n      }\n      \n      // 2. Create user profile\n      final user = UserModel(\n        id: authResponse.user!.id,\n        email: email,\n        fullName: fullName,\n        createdAt: DateTime.now(),\n        updatedAt: DateTime.now(),\n      );\n      \n      await _supabase\n          .from('users')\n          .insert(user.toJson());\n      \n      state = AsyncData(user);\n    } catch (e) {\n      state = AsyncError(Failure(e.toString()), StackTrace.current);\n      rethrow;\n    }\n  }\n  \n  Future<void> signInWithEmail({\n    required String email,\n    required String password,\n  }) async {\n    try {\n      state = const AsyncLoading();\n      \n      final authResponse = await _supabase.auth.signInWithPassword(\n        email: email,\n        password: password,\n      );\n      \n      final user = await _getUserProfile(authResponse.user!.id);\n      \n      state = AsyncData(user);\n    } catch (e) {\n      state = AsyncError(Failure(e.toString()), StackTrace.current);\n      rethrow;\n    }\n  }\n  \n  Future<void> signInWithGoogle() async {\n    try {\n      state = const AsyncLoading();\n      \n      await _supabase.auth.signInWithOAuth(\n        Provider.google,\n        redirectTo: 'io.supabase.flutter://login-callback/',\n      );\n      \n      // User will be updated via auth state listener\n    } catch (e) {\n      state = AsyncError(Failure(e.toString()), StackTrace.current);\n      rethrow;\n    }\n  }\n  \n  Future<void> signInWithApple() async {\n    try {\n      state = const AsyncLoading();\n      \n      await _supabase.auth.signInWithOAuth(\n        Provider.apple,\n        redirectTo: 'io.supabase.flutter://login-callback/',\n      );\n    } catch (e) {\n      state = AsyncError(Failure(e.toString()), StackTrace.current);\n      rethrow;\n    }\n  }\n  \n  Future<void> signOut() async {\n    try {\n      await _supabase.auth.signOut();\n      state = const AsyncData(null);\n    } catch (e) {\n      state = AsyncError(Failure(e.toString()), StackTrace.current);\n    }\n  }\n  \n  Future<void> updateProfile(UserModel user) async {\n    try {\n      state = const AsyncLoading();\n      \n      await _supabase\n          .from('users')\n          .update(user.toJson())\n          .eq('id', user.id);\n      \n      state = AsyncData(user);\n    } catch (e) {\n      state = AsyncError(Failure(e.toString()), StackTrace.current);\n      rethrow;\n    }\n  }\n  \n  Future<void> resetPassword(String email) async {\n    try {\n      await _supabase.auth.resetPasswordForEmail(email);\n    } catch (e) {\n      throw Failure(e.toString());\n    }\n  }\n}"
                  },
                  "screens": {
                    "auth": {
                      "login_screen.dart": "import 'package:flutter/material.dart';\nimport 'package:flutter_hooks/flutter_hooks.dart';\nimport 'package:hooks_riverpod/hooks_riverpod.dart';\nimport 'package:supabase_fashion/presentation/providers/supabase_auth_provider.dart';\n\nclass LoginScreen extends HookConsumerWidget {\n  const LoginScreen({super.key});\n\n  @override\n  Widget build(BuildContext context, WidgetRef ref) {\n    final emailController = useTextEditingController();\n    final passwordController = useTextEditingController();\n    final formKey = useRef(GlobalKey<FormState>());\n    final isLoading = useState(false);\n    final errorMessage = useState<String?>(null);\n    \n    final auth = ref.watch(supabaseAuthProvider);\n    \n    void _handleLogin() async {\n      if (!formKey.value.currentState!.validate()) return;\n      \n      isLoading.value = true;\n      errorMessage.value = null;\n      \n      try {\n        await ref.read(supabaseAuthProvider.notifier).signInWithEmail(\n          email: emailController.text.trim(),\n          password: passwordController.text,\n        );\n        // Navigation handled by auth state listener\n      } catch (e) {\n        errorMessage.value = e.toString();\n      } finally {\n        isLoading.value = false;\n      }\n    }\n    \n    void _handleGoogleSignIn() async {\n      isLoading.value = true;\n      try {\n        await ref.read(supabaseAuthProvider.notifier).signInWithGoogle();\n      } catch (e) {\n        errorMessage.value = e.toString();\n      } finally {\n        isLoading.value = false;\n      }\n    }\n    \n    return Scaffold(\n      body: SingleChildScrollView(\n        child: Padding(\n          padding: const EdgeInsets.all(24.0),\n          child: Form(\n            key: formKey.value,\n            child: Column(\n              crossAxisAlignment: CrossAxisAlignment.stretch,\n              children: [\n                const SizedBox(height: 80),\n                Text(\n                  'Welcome Back',\n                  style: Theme.of(context).textTheme.headlineLarge?.copyWith(\n                    fontWeight: FontWeight.bold,\n                  ),\n                ),\n                const SizedBox(height: 8),\n                Text(\n                  'Sign in to continue shopping',\n                  style: Theme.of(context).textTheme.bodyLarge?.copyWith(\n                    color: Theme.of(context).colorScheme.onSurface.withOpacity(0.6),\n                  ),\n                ),\n                const SizedBox(height: 48),\n                if (errorMessage.value != null)\n                  Container(\n                    padding: const EdgeInsets.all(12),\n                    margin: const EdgeInsets.only(bottom: 16),\n                    decoration: BoxDecoration(\n                      color: Colors.red.withOpacity(0.1),\n                      borderRadius: BorderRadius.circular(8),\n                    ),\n                    child: Row(\n                      children: [\n                        const Icon(Icons.error, color: Colors.red, size: 20),\n                        const SizedBox(width: 8),\n                        Expanded(\n                          child: Text(\n                            errorMessage.value!,\n                            style: const TextStyle(color: Colors.red),\n                          ),\n                        ),\n                      ],\n                    ),\n                  ),\n                TextFormField(\n                  controller: emailController,\n                  decoration: const InputDecoration(\n                    labelText: 'Email',\n                    prefixIcon: Icon(Icons.email),\n                  ),\n                  keyboardType: TextInputType.emailAddress,\n                  validator: (value) {\n                    if (value == null || value.isEmpty) {\n                      return 'Email is required';\n                    }\n                    if (!value.contains('@')) {\n                      return 'Enter a valid email';\n                    }\n                    return null;\n                  },\n                ),\n                const SizedBox(height: 16),\n                TextFormField(\n                  controller: passwordController,\n                  decoration: const InputDecoration(\n                    labelText: 'Password',\n                    prefixIcon: Icon(Icons.lock),\n                  ),\n                  obscureText: true,\n                  validator: (value) {\n                    if (value == null || value.isEmpty) {\n                      return 'Password is required';\n                    }\n                    if (value.length < 6) {\n                      return 'Password must be at least 6 characters';\n                    }\n                    return null;\n                  },\n                ),\n                const SizedBox(height: 8),\n                Align(\n                  alignment: Alignment.centerRight,\n                  child: TextButton(\n                    onPressed: () {\n                      // Navigate to forgot password\n                    },\n                    child: const Text('Forgot Password?'),\n                  ),\n                ),\n                const SizedBox(height: 24),\n                ElevatedButton(\n                  onPressed: isLoading.value ? null : _handleLogin,\n                  style: ElevatedButton.styleFrom(\n                    padding: const EdgeInsets.symmetric(vertical: 16),\n                  ),\n                  child: isLoading.value\n                      ? const SizedBox(\n                          height: 24,\n                          width: 24,\n                          child: CircularProgressIndicator(strokeWidth: 2),\n                        )\n                      : const Text('Sign In'),\n                ),\n                const SizedBox(height: 24),\n                const Row(\n                  children: [\n                    Expanded(child: Divider()),\n                    Padding(\n                      padding: EdgeInsets.symmetric(horizontal: 16),\n                      child: Text('OR'),\n                    ),\n                    Expanded(child: Divider()),\n                  ],\n                ),\n                const SizedBox(height: 24),\n                OutlinedButton.icon(\n                  onPressed: isLoading.value ? null : _handleGoogleSignIn,\n                  icon: Image.asset(\n                    'assets/icons/google.png',\n                    width: 24,\n                    height: 24,\n                  ),\n                  label: const Text('Continue with Google'),\n                ),\n                const SizedBox(height: 16),\n                OutlinedButton.icon(\n                  onPressed: isLoading.value ? null : () {},\n                  icon: const Icon(Icons.apple, size: 24),\n                  label: const Text('Continue with Apple'),\n                ),\n                const SizedBox(height: 32),\n                Row(\n                  mainAxisAlignment: MainAxisAlignment.center,\n                  children: [\n                    const Text('Don\\\\'t have an account?'),\n                    TextButton(\n                      onPressed: () {\n                        // Navigate to sign up\n                      },\n                      child: const Text('Sign Up'),\n                    ),\n                  ],\n                ),\n              ],\n            ),\n          ),\n        ),\n      ),\n    );\n  }\n}"
                    }
                  }
                }
              }
            }
          }
        }
      }
    ]
  },
  {
    "dataset_name": "flutter_live_news_channel_supabase",
    "metadata": {
      "framework": "Flutter 3.0+",
      "architecture": "Clean Architecture with Riverpod",
      "state_management": "Riverpod",
      "backend": "Supabase (Realtime + PostgreSQL + Storage)",
      "features": [
        "Live News Streaming",
        "Real-time Updates",
        "Live Comments",
        "Push Notifications",
        "User Engagement"
      ],
      "dependencies": [
        "supabase_flutter",
        "riverpod",
        "flutter_riverpod",
        "agora_rtc_engine",
        "video_player",
        "chewie",
        "cached_network_image",
        "flutter_html",
        "webview_flutter",
        "pull_to_refresh",
        "share_plus",
        "flutter_local_notifications",
        "emoji_picker_flutter",
        "socket_io_client",
        "hive",
        "uuid",
        "equatable",
        "intl",
        "shimmer"
      ],
      "target_platforms": [
        "Android",
        "iOS"
      ],
      "created": "2024-01-15",
      "version": "1.0.0"
    },
    "instructions": [
      {
        "instruction": "Create a real-time news channel application with live streaming capabilities, real-time updates, live comments, and user engagement features using Supabase as backend.",
        "input": "",
        "output": {
          "project_structure": {
            "live_news_channel": {
              "pubspec.yaml": "name: live_news_channel\ndescription: Real-time News Channel with Live Streaming\nversion: 1.0.0+1\npublish_to: 'none'\n\nenvironment:\n  sdk: '>=3.0.0 <4.0.0'\n  flutter: '>=3.0.0'\n\ndependencies:\n  flutter:\n    sdk: flutter\n  \n  # Supabase\n  supabase_flutter: ^2.3.1\n  \n  # State Management\n  riverpod: ^2.4.9\n  flutter_riverpod: ^2.4.9\n  \n  # Live Streaming\n  agora_rtc_engine: ^6.3.0\n  video_player: ^2.8.1\n  chewie: ^1.5.0\n  \n  # UI Components\n  cached_network_image: ^3.3.0\n  flutter_html: ^3.0.0-beta.2\n  webview_flutter: ^4.6.0\n  pull_to_refresh: ^2.0.0\n  shimmer: ^3.0.0\n  badges: ^3.0.1\n  emoji_picker_flutter: ^2.0.1\n  \n  # Utilities\n  url_launcher: ^6.2.2\n  share_plus: ^7.2.1\n  flutter_local_notifications: ^16.1.0\n  socket_io_client: ^2.0.3\n  hive: ^2.2.3\n  hive_flutter: ^1.1.0\n  uuid: ^4.2.0\n  equatable: ^2.0.5\n  intl: ^0.19.0\n\nflutter:\n  uses-material-design: true\n\n  assets:\n    - assets/images/\n    - assets/icons/\n    - assets/animations/\n    - assets/sounds/\n\n  fonts:\n    - family: Inter\n      fonts:\n        - asset: fonts/Inter-Regular.ttf\n        - asset: fonts/Inter-Medium.ttf\n          weight: 500\n        - asset: fonts/Inter-SemiBold.ttf\n          weight: 600\n        - asset: fonts/Inter-Bold.ttf\n          weight: 700",
              "lib": {
                "main.dart": "import 'package:flutter/material.dart';\nimport 'package:flutter_riverpod/flutter_riverpod.dart';\nimport 'package:live_news_channel/app.dart';\nimport 'package:live_news_channel/core/supabase/supabase_client.dart';\nimport 'package:agora_rtc_engine/agora_rtc_engine.dart';\n\nFuture<void> main() async {\n  WidgetsFlutterBinding.ensureInitialized();\n  \n  // Initialize Supabase\n  await SupabaseClient.initialize();\n  \n  // Initialize Agora RTC Engine\n  await AgoraRtcEngine.initialize(RtcEngineContext(\n    appId: 'YOUR_AGORA_APP_ID',\n  ));\n  \n  // Initialize Hive\n  await SupabaseClient.initializeHive();\n  \n  runApp(\n    ProviderScope(\n      child: MyApp(),\n    ),\n  );\n}\n\nclass MyApp extends StatelessWidget {\n  @override\n  Widget build(BuildContext context) {\n    return MaterialApp(\n      title: 'Live News',\n      debugShowCheckedModeBanner: false,\n      theme: ThemeData(\n        useMaterial3: true,\n        colorScheme: ColorScheme.fromSeed(\n          seedColor: Color(0xFFDC2626),\n          brightness: Brightness.light,\n        ),\n        fontFamily: 'Inter',\n      ),\n      darkTheme: ThemeData(\n        useMaterial3: true,\n        colorScheme: ColorScheme.fromSeed(\n          seedColor: Color(0xFFDC2626),\n          brightness: Brightness.dark,\n        ),\n      ),\n      themeMode: ThemeMode.system,\n      home: const App(),\n    );\n  }\n}",
                "core": {
                  "constants": {
                    "app_constants.dart": "class AppConstants {\n  static const String appName = 'Live News';\n  static const String supabaseUrl = 'YOUR_SUPABASE_URL';\n  static const String supabaseAnonKey = 'YOUR_SUPABASE_ANON_KEY';\n  \n  // Agora RTC\n  static const String agoraAppId = 'YOUR_AGORA_APP_ID';\n  static const String agoraTokenServer = 'YOUR_TOKEN_SERVER_URL';\n  \n  // News channels\n  static const List<String> newsChannels = [\n    'Breaking News',\n    'Politics Live',\n    'Business Updates',\n    'Sports Live',\n    'Entertainment News',\n    'Technology Updates',\n    'World News',\n    'Local News',\n  ];\n  \n  // Live show status\n  static const List<String> showStatus = [\n    'live',\n    'upcoming',\n    'ended',\n    'cancelled',\n  ];\n  \n  // Storage buckets\n  static const String liveThumbnailsBucket = 'live-thumbnails';\n  static const String newsClipsBucket = 'news-clips';\n  static const String presenterAvatarsBucket = 'presenter-avatars';\n  \n  // Cache settings\n  static const int liveCacheDuration = 5; // seconds\n  static const int vodCacheDuration = 30; // minutes\n  \n  // Realtime channels\n  static const String liveCommentsChannel = 'live-comments';\n  static const String breakingNewsChannel = 'breaking-news';\n  static const String liveViewersChannel = 'live-viewers';\n}",
                    "enums.dart": "enum LiveStatus { live, starting_soon, ended, cancelled }\nenum ContentType { live_stream, vod, article, podcast }\nenum ReactionType { like, love, wow, sad, angry, clap }\nenum NotificationPriority { high, medium, low }\nenum UserRole { viewer, moderator, presenter, admin }",
                    "routes.dart": "class AppRoutes {\n  // Auth\n  static const String auth = '/';\n  static const String register = '/register';\n  \n  // Live\n  static const String liveHome = '/live/home';\n  static const String liveStream = '/live/stream';\n  static const String liveSchedule = '/live/schedule';\n  static const String vodLibrary = '/vod/library';\n  \n  // News\n  static const String newsFeed = '/news/feed';\n  static const String articleDetails = '/article/details';\n  static const String breakingNews = '/breaking/news';\n  \n  // Interactive\n  static const String liveChat = '/live/chat';\n  static const String polls = '/polls';\n  static const String qna = '/qna';\n  \n  // Profile\n  static const String profile = '/profile';\n  static const String notifications = '/notifications';\n  static const String settings = '/settings';\n  static const String subscription = '/subscription';\n}"
                  },
                  "supabase": {
                    "tables.sql": "-- SQL for Live News Channel Database\n\n-- Users table\nCREATE TABLE users (\n  id UUID REFERENCES auth.users ON DELETE CASCADE PRIMARY KEY,\n  email TEXT UNIQUE NOT NULL,\n  full_name TEXT,\n  username TEXT UNIQUE,\n  avatar_url TEXT,\n  bio TEXT,\n  is_verified BOOLEAN DEFAULT false,\n  is_presenter BOOLEAN DEFAULT false,\n  is_moderator BOOLEAN DEFAULT false,\n  subscription_tier TEXT DEFAULT 'free',\n  subscription_expiry TIMESTAMP WITH TIME ZONE,\n  total_watch_time INTEGER DEFAULT 0,\n  total_live_sessions INTEGER DEFAULT 0,\n  notification_settings JSONB DEFAULT '{\"breaking_news\": true, \"live_start\": true, \"personalized\": true}',\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Live shows table\nCREATE TABLE live_shows (\n  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n  channel_id UUID REFERENCES channels(id) ON DELETE CASCADE,\n  presenter_id UUID REFERENCES users(id) ON DELETE CASCADE,\n  title TEXT NOT NULL,\n  description TEXT,\n  thumbnail_url TEXT,\n  stream_url TEXT,\n  rtmp_url TEXT,\n  stream_key TEXT,\n  agora_channel_name TEXT,\n  agora_token TEXT,\n  schedule_time TIMESTAMP WITH TIME ZONE NOT NULL,\n  start_time TIMESTAMP WITH TIME ZONE,\n  end_time TIMESTAMP WITH TIME ZONE,\n  status TEXT DEFAULT 'upcoming' CHECK (status IN ('live', 'upcoming', 'ended', 'cancelled')),\n  category TEXT NOT NULL,\n  tags TEXT[],\n  max_viewers INTEGER DEFAULT 0,\n  current_viewers INTEGER DEFAULT 0,\n  peak_viewers INTEGER DEFAULT 0,\n  total_viewers INTEGER DEFAULT 0,\n  like_count INTEGER DEFAULT 0,\n  share_count INTEGER DEFAULT 0,\n  is_featured BOOLEAN DEFAULT false,\n  is_exclusive BOOLEAN DEFAULT false,\n  requires_subscription BOOLEAN DEFAULT false,\n  vod_url TEXT,\n  vod_duration INTEGER,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Channels table\nCREATE TABLE channels (\n  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n  name TEXT NOT NULL,\n  slug TEXT UNIQUE NOT NULL,\n  description TEXT,\n  logo_url TEXT,\n  cover_url TEXT,\n  category TEXT NOT NULL,\n  language TEXT DEFAULT 'en',\n  country TEXT,\n  is_live BOOLEAN DEFAULT false,\n  current_show_id UUID REFERENCES live_shows(id),\n  follower_count INTEGER DEFAULT 0,\n  total_shows INTEGER DEFAULT 0,\n  total_watch_time INTEGER DEFAULT 0,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Live comments table (realtime)\nCREATE TABLE live_comments (\n  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n  live_show_id UUID REFERENCES live_shows(id) ON DELETE CASCADE,\n  user_id UUID REFERENCES users(id) ON DELETE CASCADE,\n  parent_id UUID REFERENCES live_comments(id) ON DELETE CASCADE,\n  message TEXT NOT NULL,\n  is_highlighted BOOLEAN DEFAULT false,\n  is_moderated BOOLEAN DEFAULT false,\n  reaction_type TEXT,\n  metadata JSONB,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Live reactions table\nCREATE TABLE live_reactions (\n  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n  live_show_id UUID REFERENCES live_shows(id) ON DELETE CASCADE,\n  user_id UUID REFERENCES users(id) ON DELETE CASCADE,\n  reaction_type TEXT NOT NULL,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n  UNIQUE(live_show_id, user_id, reaction_type)\n);\n\n-- Live polls table\nCREATE TABLE live_polls (\n  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n  live_show_id UUID REFERENCES live_shows(id) ON DELETE CASCADE,\n  question TEXT NOT NULL,\n  options JSONB NOT NULL, -- {option_id: text, votes: count}\n  is_active BOOLEAN DEFAULT true,\n  total_votes INTEGER DEFAULT 0,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n  ends_at TIMESTAMP WITH TIME ZONE\n);\n\n-- Poll votes table\nCREATE TABLE poll_votes (\n  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n  poll_id UUID REFERENCES live_polls(id) ON DELETE CASCADE,\n  user_id UUID REFERENCES users(id) ON DELETE CASCADE,\n  option_id TEXT NOT NULL,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n  UNIQUE(poll_id, user_id)\n);\n\n-- Breaking news table\nCREATE TABLE breaking_news (\n  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n  title TEXT NOT NULL,\n  summary TEXT,\n  content TEXT,\n  category TEXT NOT NULL,\n  severity TEXT DEFAULT 'medium' CHECK (severity IN ('low', 'medium', 'high', 'critical')),\n  location JSONB,\n  source TEXT,\n  is_active BOOLEAN DEFAULT true,\n  expires_at TIMESTAMP WITH TIME ZONE,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- User watch history\nCREATE TABLE watch_history (\n  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n  user_id UUID REFERENCES users(id) ON DELETE CASCADE,\n  live_show_id UUID REFERENCES live_shows(id) ON DELETE CASCADE,\n  vod_id UUID REFERENCES vods(id) ON DELETE CASCADE,\n  watch_duration INTEGER DEFAULT 0,\n  watch_percentage INTEGER DEFAULT 0,\n  last_watched_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n  UNIQUE(user_id, live_show_id)\n);\n\n-- VODs (Video on Demand)\nCREATE TABLE vods (\n  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n  live_show_id UUID REFERENCES live_shows(id) ON DELETE CASCADE,\n  title TEXT NOT NULL,\n  description TEXT,\n  video_url TEXT NOT NULL,\n  thumbnail_url TEXT,\n  duration INTEGER NOT NULL,\n  view_count INTEGER DEFAULT 0,\n  like_count INTEGER DEFAULT 0,\n  category TEXT NOT NULL,\n  tags TEXT[],\n  is_public BOOLEAN DEFAULT true,\n  requires_subscription BOOLEAN DEFAULT false,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Create indexes\nCREATE INDEX idx_live_shows_status ON live_shows(status, schedule_time DESC);\nCREATE INDEX idx_live_shows_category ON live_shows(category);\nCREATE INDEX idx_live_comments_show_id ON live_comments(live_show_id, created_at DESC);\nCREATE INDEX idx_breaking_news_active ON breaking_news(is_active, created_at DESC);\nCREATE INDEX idx_vods_category ON vods(category);\n\n-- Enable RLS\nALTER TABLE live_shows ENABLE ROW LEVEL SECURITY;\nALTER TABLE live_comments ENABLE ROW LEVEL SECURITY;\nALTER TABLE live_reactions ENABLE ROW LEVEL SECURITY;\nALTER TABLE live_polls ENABLE ROW LEVEL SECURITY;\nALTER TABLE breaking_news ENABLE ROW LEVEL SECURITY;\n\n-- RLS Policies\n-- Anyone can view live shows\nCREATE POLICY \"Anyone can view live shows\" ON live_shows\n  FOR SELECT USING (true);\n\n-- Only presenters can update their shows\nCREATE POLICY \"Presenters can update own shows\" ON live_shows\n  FOR UPDATE USING (auth.uid() = presenter_id);\n\n-- Users can only view and add their own comments\nCREATE POLICY \"Users can view live comments\" ON live_comments\n  FOR SELECT USING (true);\n\nCREATE POLICY \"Users can add comments\" ON live_comments\n  FOR INSERT WITH CHECK (auth.uid() = user_id);\n\n-- Anyone can view breaking news\nCREATE POLICY \"Anyone can view breaking news\" ON breaking_news\n  FOR SELECT USING (true);",
                    "realtime_functions.sql": "-- Real-time functions and triggers\n\n-- Function to update current viewers count\nCREATE OR REPLACE FUNCTION update_live_viewers_count()\nRETURNS TRIGGER AS $$\nBEGIN\n  IF TG_OP = 'INSERT' THEN\n    UPDATE live_shows\n    SET current_viewers = current_viewers + 1,\n        total_viewers = total_viewers + 1,\n        max_viewers = GREATEST(max_viewers, current_viewers + 1)\n    WHERE id = NEW.live_show_id;\n  ELSIF TG_OP = 'DELETE' THEN\n    UPDATE live_shows\n    SET current_viewers = current_viewers - 1\n    WHERE id = OLD.live_show_id;\n  END IF;\n  RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\n-- Create trigger for live viewers\nCREATE TRIGGER live_viewers_trigger\nAFTER INSERT OR DELETE ON live_viewer_sessions\nFOR EACH ROW EXECUTE FUNCTION update_live_viewers_count();\n\n-- Function to send breaking news notifications\nCREATE OR REPLACE FUNCTION notify_breaking_news()\nRETURNS TRIGGER AS $$\nBEGIN\n  PERFORM pg_notify(\n    'breaking_news',\n    json_build_object(\n      'id', NEW.id,\n      'title', NEW.title,\n      'category', NEW.category,\n      'severity', NEW.severity,\n      'created_at', NEW.created_at\n    )::text\n  );\n  RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\n-- Create trigger for breaking news\nCREATE TRIGGER breaking_news_trigger\nAFTER INSERT ON breaking_news\nFOR EACH ROW EXECUTE FUNCTION notify_breaking_news();\n\n-- Function for live comment reactions\nCREATE OR REPLACE FUNCTION process_live_reaction()\nRETURNS TRIGGER AS $$\nBEGIN\n  -- Update reaction count in live_shows\n  UPDATE live_shows\n  SET like_count = like_count + 1\n  WHERE id = NEW.live_show_id\n  AND NEW.reaction_type = 'like';\n  \n  -- Send real-time notification\n  PERFORM pg_notify(\n    'live_reactions',\n    json_build_object(\n      'live_show_id', NEW.live_show_id,\n      'user_id', NEW.user_id,\n      'reaction_type', NEW.reaction_type\n    )::text\n  );\n  \n  RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\n-- Create trigger for live reactions\nCREATE TRIGGER live_reaction_trigger\nAFTER INSERT ON live_reactions\nFOR EACH ROW EXECUTE FUNCTION process_live_reaction();"
                  },
                  "models": {
                    "live_show_model.dart": "import 'package:equatable/equatable.dart';\nimport 'package:live_news_channel/core/constants/enums.dart';\n\nclass LiveShowModel extends Equatable {\n  final String id;\n  final String channelId;\n  final String presenterId;\n  final String title;\n  final String? description;\n  final String? thumbnailUrl;\n  final String? streamUrl;\n  final String? rtmpUrl;\n  final String? streamKey;\n  final String? agoraChannelName;\n  final String? agoraToken;\n  final DateTime scheduleTime;\n  final DateTime? startTime;\n  final DateTime? endTime;\n  final LiveStatus status;\n  final String category;\n  final List<String> tags;\n  final int maxViewers;\n  final int currentViewers;\n  final int peakViewers;\n  final int totalViewers;\n  final int likeCount;\n  final int shareCount;\n  final bool isFeatured;\n  final bool isExclusive;\n  final bool requiresSubscription;\n  final String? vodUrl;\n  final int? vodDuration;\n  final DateTime createdAt;\n  final DateTime updatedAt;\n  \n  const LiveShowModel({\n    required this.id,\n    required this.channelId,\n    required this.presenterId,\n    required this.title,\n    this.description,\n    this.thumbnailUrl,\n    this.streamUrl,\n    this.rtmpUrl,\n    this.streamKey,\n    this.agoraChannelName,\n    this.agoraToken,\n    required this.scheduleTime,\n    this.startTime,\n    this.endTime,\n    this.status = LiveStatus.upcoming,\n    required this.category,\n    this.tags = const [],\n    this.maxViewers = 0,\n    this.currentViewers = 0,\n    this.peakViewers = 0,\n    this.totalViewers = 0,\n    this.likeCount = 0,\n    this.shareCount = 0,\n    this.isFeatured = false,\n    this.isExclusive = false,\n    this.requiresSubscription = false,\n    this.vodUrl,\n    this.vodDuration,\n    required this.createdAt,\n    required this.updatedAt,\n  });\n  \n  factory LiveShowModel.fromJson(Map<String, dynamic> json) {\n    return LiveShowModel(\n      id: json['id'],\n      channelId: json['channel_id'],\n      presenterId: json['presenter_id'],\n      title: json['title'],\n      description: json['description'],\n      thumbnailUrl: json['thumbnail_url'],\n      streamUrl: json['stream_url'],\n      rtmpUrl: json['rtmp_url'],\n      streamKey: json['stream_key'],\n      agoraChannelName: json['agora_channel_name'],\n      agoraToken: json['agora_token'],\n      scheduleTime: DateTime.parse(json['schedule_time']),\n      startTime: json['start_time'] != null\n          ? DateTime.parse(json['start_time'])\n          : null,\n      endTime: json['end_time'] != null\n          ? DateTime.parse(json['end_time'])\n          : null,\n      status: LiveStatus.values.firstWhere(\n        (e) => e.name == json['status'],\n        orElse: () => LiveStatus.upcoming,\n      ),\n      category: json['category'],\n      tags: List<String>.from(json['tags'] ?? []),\n      maxViewers: json['max_viewers'] ?? 0,\n      currentViewers: json['current_viewers'] ?? 0,\n      peakViewers: json['peak_viewers'] ?? 0,\n      totalViewers: json['total_viewers'] ?? 0,\n      likeCount: json['like_count'] ?? 0,\n      shareCount: json['share_count'] ?? 0,\n      isFeatured: json['is_featured'] ?? false,\n      isExclusive: json['is_exclusive'] ?? false,\n      requiresSubscription: json['requires_subscription'] ?? false,\n      vodUrl: json['vod_url'],\n      vodDuration: json['vod_duration'],\n      createdAt: DateTime.parse(json['created_at']),\n      updatedAt: DateTime.parse(json['updated_at']),\n    );\n  }\n  \n  bool get isLive => status == LiveStatus.live;\n  bool get isUpcoming => status == LiveStatus.upcoming;\n  bool get hasEnded => status == LiveStatus.ended;\n  \n  String get timeUntilLive {\n    final now = DateTime.now();\n    if (isLive) return 'LIVE NOW';\n    \n    final difference = scheduleTime.difference(now);\n    \n    if (difference.inDays > 0) {\n      return 'In \\\\${difference.inDays}d';\n    } else if (difference.inHours > 0) {\n      return 'In \\\\${difference.inHours}h';\n    } else if (difference.inMinutes > 0) {\n      return 'In \\\\${difference.inMinutes}m';\n    } else {\n      return 'Starting soon';\n    }\n  }\n  \n  String get viewerCountFormatted {\n    if (currentViewers >= 1000) {\n      return '\\\\${(currentViewers / 1000).toStringAsFixed(1)}K viewers';\n    }\n    return '\\\\$currentViewers viewers';\n  }\n  \n  @override\n  List<Object?> get props => [id, status];\n}"
                  }
                },
                "presentation": {
                  "screens": {
                    "live": {
                      "live_stream_screen.dart": "import 'package:flutter/material.dart';\nimport 'package:flutter_riverpod/flutter_riverpod.dart';\nimport 'package:agora_rtc_engine/agora_rtc_engine.dart';\nimport 'package:video_player/video_player.dart';\nimport 'package:chewie/chewie.dart';\nimport 'package:live_news_channel/core/providers/live_provider.dart';\nimport 'package:live_news_channel/presentation/widgets/live_chat_widget.dart';\n\nclass LiveStreamScreen extends ConsumerStatefulWidget {\n  final String liveShowId;\n  \n  const LiveStreamScreen({\n    super.key,\n    required this.liveShowId,\n  });\n  \n  @override\n  ConsumerState<LiveStreamScreen> createState() => _LiveStreamScreenState();\n}\n\nclass _LiveStreamScreenState extends ConsumerState<LiveStreamScreen> {\n  late RtcEngine _agoraEngine;\n  VideoPlayerController? _videoController;\n  ChewieController? _chewieController;\n  bool _isJoined = false;\n  bool _isFullScreen = false;\n  bool _showChat = true;\n  \n  @override\n  void initState() {\n    super.initState();\n    _initAgora();\n  }\n  \n  Future<void> _initAgora() async {\n    // Create Agora engine instance\n    _agoraEngine = createAgoraRtcEngine();\n    await _agoraEngine.initialize(const RtcEngineContext(\n      appId: AppConstants.agoraAppId,\n    ));\n    \n    // Enable video\n    await _agoraEngine.enableVideo();\n    \n    // Set up event handlers\n    _agoraEngine.registerEventHandler(\n      RtcEngineEventHandler(\n        onJoinChannelSuccess: (connection, elapsed) {\n          setState(() {\n            _isJoined = true;\n          });\n        },\n        onUserJoined: (connection, remoteUid, elapsed) {\n          // Handle remote user joined\n        },\n        onUserOffline: (connection, remoteUid, reason) {\n          // Handle remote user offline\n        },\n      ),\n    );\n  }\n  \n  Future<void> _joinChannel() async {\n    // Get live show details\n    final liveShow = ref.read(liveShowProvider(widget.liveShowId));\n    \n    // Join channel\n    await _agoraEngine.joinChannel(\n      token: liveShow.agoraToken ?? '',\n      channelId: liveShow.agoraChannelName ?? '',\n      uid: 0, // 0 means Agora assigns a UID\n      options: const ChannelMediaOptions(),\n    );\n  }\n  \n  @override\n  void dispose() {\n    _agoraEngine.leaveChannel();\n    _agoraEngine.release();\n    _videoController?.dispose();\n    _chewieController?.dispose();\n    super.dispose();\n  }\n  \n  @override\n  Widget build(BuildContext context) {\n    final liveShowAsync = ref.watch(liveShowProvider(widget.liveShowId));\n    \n    return Scaffold(\n      body: liveShowAsync.when(\n        data: (liveShow) {\n          return Stack(\n            children: [\n              // Video Player\n              Positioned.fill(\n                child: _isJoined\n                    ? AgoraVideoView(\n                        controller: VideoViewController(\n                          rtcEngine: _agoraEngine,\n                          canvas: const VideoCanvas(uid: 0),\n                        ),\n                      )\n                    : Center(\n                        child: Column(\n                          mainAxisAlignment: MainAxisAlignment.center,\n                          children: [\n                            const CircularProgressIndicator(),\n                            const SizedBox(height: 20),\n                            Text(\n                              'Joining live stream...',\n                              style: Theme.of(context).textTheme.titleMedium,\n                            ),\n                          ],\n                        ),\n                      ),\n              ),\n              \n              // Overlay Controls\n              Positioned(\n                top: MediaQuery.of(context).padding.top + 16,\n                left: 16,\n                right: 16,\n                child: _buildLiveHeader(context, liveShow),\n              ),\n              \n              Positioned(\n                bottom: 16,\n                left: 16,\n                right: 16,\n                child: _buildLiveControls(context, liveShow),\n              ),\n              \n              // Live Chat Sidebar\n              if (_showChat)\n                Positioned(\n                  top: 100,\n                  right: 0,\n                  bottom: 100,\n                  child: Container(\n                    width: 350,\n                    decoration: BoxDecoration(\n                      color: Theme.of(context).colorScheme.surface,\n                      borderRadius: const BorderRadius.only(\n                        topLeft: Radius.circular(16),\n                        bottomLeft: Radius.circular(16),\n                      ),\n                    ),\n                    child: LiveChatWidget(liveShowId: liveShow.id),\n                  ),\n                ),\n            ],\n          );\n        },\n        loading: () => const Center(child: CircularProgressIndicator()),\n        error: (error, stack) => Center(child: Text('Error: $error')),\n      ),\n    );\n  }\n  \n  Widget _buildLiveHeader(BuildContext context, LiveShowModel liveShow) {\n    return Container(\n      padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 12),\n      decoration: BoxDecoration(\n        color: Colors.black.withOpacity(0.5),\n        borderRadius: BorderRadius.circular(12),\n      ),\n      child: Row(\n        children: [\n          Container(\n            padding: const EdgeInsets.symmetric(horizontal: 12, vertical: 6),\n            decoration: BoxDecoration(\n              color: Colors.red,\n              borderRadius: BorderRadius.circular(20),\n            ),\n            child: Row(\n              children: [\n                Container(\n                  width: 8,\n                  height: 8,\n                  decoration: const BoxDecoration(\n                    color: Colors.white,\n                    shape: BoxShape.circle,\n                  ),\n                ),\n                const SizedBox(width: 8),\n                const Text(\n                  'LIVE',\n                  style: TextStyle(\n                    color: Colors.white,\n                    fontWeight: FontWeight.bold,\n                    fontSize: 12,\n                  ),\n                ),\n              ],\n            ),\n          ),\n          const SizedBox(width: 12),\n          Expanded(\n            child: Column(\n              crossAxisAlignment: CrossAxisAlignment.start,\n              children: [\n                Text(\n                  liveShow.title,\n                  style: const TextStyle(\n                    color: Colors.white,\n                    fontWeight: FontWeight.bold,\n                    fontSize: 16,\n                  ),\n                  maxLines: 1,\n                  overflow: TextOverflow.ellipsis,\n                ),\n                Text(\n                  liveShow.viewerCountFormatted,\n                  style: const TextStyle(\n                    color: Colors.white70,\n                    fontSize: 12,\n                  ),\n                ),\n              ],\n            ),\n          ),\n          IconButton(\n            onPressed: () {\n              setState(() {\n                _showChat = !_showChat;\n              });\n            },\n            icon: Icon(\n              _showChat ? Icons.chat_bubble : Icons.chat_bubble_outline,\n              color: Colors.white,\n            ),\n          ),\n          IconButton(\n            onPressed: () {\n              // Share live stream\n            },\n            icon: const Icon(Icons.share, color: Colors.white),\n          ),\n        ],\n      ),\n    );\n  }\n  \n  Widget _buildLiveControls(BuildContext context, LiveShowModel liveShow) {\n    return Container(\n      padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 12),\n      decoration: BoxDecoration(\n        color: Colors.black.withOpacity(0.5),\n        borderRadius: BorderRadius.circular(12),\n      ),\n      child: Row(\n        children: [\n          Expanded(\n            child: Container(\n              padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),\n              decoration: BoxDecoration(\n                color: Colors.white.withOpacity(0.1),\n                borderRadius: BorderRadius.circular(24),\n              ),\n              child: const Row(\n                children: [\n                  Icon(Icons.emoji_emotions_outlined, color: Colors.white, size: 20),\n                  SizedBox(width: 8),\n                  Text(\n                    'Add a comment...',\n                    style: TextStyle(color: Colors.white70),\n                  ),\n                ],\n              ),\n            ),\n          ),\n          const SizedBox(width: 12),\n          IconButton(\n            onPressed: () {\n              // Send like reaction\n              ref.read(liveReactionProvider.notifier).sendReaction(\n                liveShowId: liveShow.id,\n                reactionType: 'like',\n              );\n            },\n            icon: const Icon(Icons.thumb_up_outlined, color: Colors.white),\n          ),\n          IconButton(\n            onPressed: () {\n              // Toggle full screen\n              setState(() {\n                _isFullScreen = !_isFullScreen;\n              });\n            },\n            icon: Icon(\n              _isFullScreen ? Icons.fullscreen_exit : Icons.fullscreen,\n              color: Colors.white,\n            ),\n          ),\n        ],\n      ),\n    );\n  }\n}"
                    }
                  }
                }
              }
            }
          }
        }
      }
    ]
  },
  {
    "dataset_name": "flutter_live_news_channel_supabase",
    "metadata": {
      "framework": "Flutter 3.0+",
      "architecture": "Clean Architecture with Riverpod",
      "state_management": "Riverpod",
      "backend": "Supabase (Realtime + PostgreSQL + Storage)",
      "features": [
        "Live News Streaming",
        "Real-time Updates",
        "Live Comments",
        "Push Notifications",
        "User Engagement"
      ],
      "dependencies": [
        "supabase_flutter",
        "riverpod",
        "flutter_riverpod",
        "agora_rtc_engine",
        "video_player",
        "chewie",
        "cached_network_image",
        "flutter_html",
        "webview_flutter",
        "pull_to_refresh",
        "share_plus",
        "flutter_local_notifications",
        "emoji_picker_flutter",
        "socket_io_client",
        "hive",
        "uuid",
        "equatable",
        "intl",
        "shimmer"
      ],
      "target_platforms": [
        "Android",
        "iOS"
      ],
      "created": "2024-01-15",
      "version": "1.0.0"
    },
    "instructions": [
      {
        "instruction": "Create a real-time news channel application with live streaming capabilities, real-time updates, live comments, and user engagement features using Supabase as backend.",
        "input": "",
        "output": {
          "project_structure": {
            "live_news_channel": {
              "pubspec.yaml": "name: live_news_channel\ndescription: Real-time News Channel with Live Streaming\nversion: 1.0.0+1\npublish_to: 'none'\n\nenvironment:\n  sdk: '>=3.0.0 <4.0.0'\n  flutter: '>=3.0.0'\n\ndependencies:\n  flutter:\n    sdk: flutter\n  \n  # Supabase\n  supabase_flutter: ^2.3.1\n  \n  # State Management\n  riverpod: ^2.4.9\n  flutter_riverpod: ^2.4.9\n  \n  # Live Streaming\n  agora_rtc_engine: ^6.3.0\n  video_player: ^2.8.1\n  chewie: ^1.5.0\n  \n  # UI Components\n  cached_network_image: ^3.3.0\n  flutter_html: ^3.0.0-beta.2\n  webview_flutter: ^4.6.0\n  pull_to_refresh: ^2.0.0\n  shimmer: ^3.0.0\n  badges: ^3.0.1\n  emoji_picker_flutter: ^2.0.1\n  \n  # Utilities\n  url_launcher: ^6.2.2\n  share_plus: ^7.2.1\n  flutter_local_notifications: ^16.1.0\n  socket_io_client: ^2.0.3\n  hive: ^2.2.3\n  hive_flutter: ^1.1.0\n  uuid: ^4.2.0\n  equatable: ^2.0.5\n  intl: ^0.19.0\n\nflutter:\n  uses-material-design: true\n\n  assets:\n    - assets/images/\n    - assets/icons/\n    - assets/animations/\n    - assets/sounds/\n\n  fonts:\n    - family: Inter\n      fonts:\n        - asset: fonts/Inter-Regular.ttf\n        - asset: fonts/Inter-Medium.ttf\n          weight: 500\n        - asset: fonts/Inter-SemiBold.ttf\n          weight: 600\n        - asset: fonts/Inter-Bold.ttf\n          weight: 700",
              "lib": {
                "main.dart": "import 'package:flutter/material.dart';\nimport 'package:flutter_riverpod/flutter_riverpod.dart';\nimport 'package:live_news_channel/app.dart';\nimport 'package:live_news_channel/core/supabase/supabase_client.dart';\nimport 'package:agora_rtc_engine/agora_rtc_engine.dart';\n\nFuture<void> main() async {\n  WidgetsFlutterBinding.ensureInitialized();\n  \n  // Initialize Supabase\n  await SupabaseClient.initialize();\n  \n  // Initialize Agora RTC Engine\n  await AgoraRtcEngine.initialize(RtcEngineContext(\n    appId: 'YOUR_AGORA_APP_ID',\n  ));\n  \n  // Initialize Hive\n  await SupabaseClient.initializeHive();\n  \n  runApp(\n    ProviderScope(\n      child: MyApp(),\n    ),\n  );\n}\n\nclass MyApp extends StatelessWidget {\n  @override\n  Widget build(BuildContext context) {\n    return MaterialApp(\n      title: 'Live News',\n      debugShowCheckedModeBanner: false,\n      theme: ThemeData(\n        useMaterial3: true,\n        colorScheme: ColorScheme.fromSeed(\n          seedColor: Color(0xFFDC2626),\n          brightness: Brightness.light,\n        ),\n        fontFamily: 'Inter',\n      ),\n      darkTheme: ThemeData(\n        useMaterial3: true,\n        colorScheme: ColorScheme.fromSeed(\n          seedColor: Color(0xFFDC2626),\n          brightness: Brightness.dark,\n        ),\n      ),\n      themeMode: ThemeMode.system,\n      home: const App(),\n    );\n  }\n}",
                "core": {
                  "constants": {
                    "app_constants.dart": "class AppConstants {\n  static const String appName = 'Live News';\n  static const String supabaseUrl = 'YOUR_SUPABASE_URL';\n  static const String supabaseAnonKey = 'YOUR_SUPABASE_ANON_KEY';\n  \n  // Agora RTC\n  static const String agoraAppId = 'YOUR_AGORA_APP_ID';\n  static const String agoraTokenServer = 'YOUR_TOKEN_SERVER_URL';\n  \n  // News channels\n  static const List<String> newsChannels = [\n    'Breaking News',\n    'Politics Live',\n    'Business Updates',\n    'Sports Live',\n    'Entertainment News',\n    'Technology Updates',\n    'World News',\n    'Local News',\n  ];\n  \n  // Live show status\n  static const List<String> showStatus = [\n    'live',\n    'upcoming',\n    'ended',\n    'cancelled',\n  ];\n  \n  // Storage buckets\n  static const String liveThumbnailsBucket = 'live-thumbnails';\n  static const String newsClipsBucket = 'news-clips';\n  static const String presenterAvatarsBucket = 'presenter-avatars';\n  \n  // Cache settings\n  static const int liveCacheDuration = 5; // seconds\n  static const int vodCacheDuration = 30; // minutes\n  \n  // Realtime channels\n  static const String liveCommentsChannel = 'live-comments';\n  static const String breakingNewsChannel = 'breaking-news';\n  static const String liveViewersChannel = 'live-viewers';\n}",
                    "enums.dart": "enum LiveStatus { live, starting_soon, ended, cancelled }\nenum ContentType { live_stream, vod, article, podcast }\nenum ReactionType { like, love, wow, sad, angry, clap }\nenum NotificationPriority { high, medium, low }\nenum UserRole { viewer, moderator, presenter, admin }",
                    "routes.dart": "class AppRoutes {\n  // Auth\n  static const String auth = '/';\n  static const String register = '/register';\n  \n  // Live\n  static const String liveHome = '/live/home';\n  static const String liveStream = '/live/stream';\n  static const String liveSchedule = '/live/schedule';\n  static const String vodLibrary = '/vod/library';\n  \n  // News\n  static const String newsFeed = '/news/feed';\n  static const String articleDetails = '/article/details';\n  static const String breakingNews = '/breaking/news';\n  \n  // Interactive\n  static const String liveChat = '/live/chat';\n  static const String polls = '/polls';\n  static const String qna = '/qna';\n  \n  // Profile\n  static const String profile = '/profile';\n  static const String notifications = '/notifications';\n  static const String settings = '/settings';\n  static const String subscription = '/subscription';\n}"
                  },
                  "supabase": {
                    "tables.sql": "-- SQL for Live News Channel Database\n\n-- Users table\nCREATE TABLE users (\n  id UUID REFERENCES auth.users ON DELETE CASCADE PRIMARY KEY,\n  email TEXT UNIQUE NOT NULL,\n  full_name TEXT,\n  username TEXT UNIQUE,\n  avatar_url TEXT,\n  bio TEXT,\n  is_verified BOOLEAN DEFAULT false,\n  is_presenter BOOLEAN DEFAULT false,\n  is_moderator BOOLEAN DEFAULT false,\n  subscription_tier TEXT DEFAULT 'free',\n  subscription_expiry TIMESTAMP WITH TIME ZONE,\n  total_watch_time INTEGER DEFAULT 0,\n  total_live_sessions INTEGER DEFAULT 0,\n  notification_settings JSONB DEFAULT '{\"breaking_news\": true, \"live_start\": true, \"personalized\": true}',\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Live shows table\nCREATE TABLE live_shows (\n  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n  channel_id UUID REFERENCES channels(id) ON DELETE CASCADE,\n  presenter_id UUID REFERENCES users(id) ON DELETE CASCADE,\n  title TEXT NOT NULL,\n  description TEXT,\n  thumbnail_url TEXT,\n  stream_url TEXT,\n  rtmp_url TEXT,\n  stream_key TEXT,\n  agora_channel_name TEXT,\n  agora_token TEXT,\n  schedule_time TIMESTAMP WITH TIME ZONE NOT NULL,\n  start_time TIMESTAMP WITH TIME ZONE,\n  end_time TIMESTAMP WITH TIME ZONE,\n  status TEXT DEFAULT 'upcoming' CHECK (status IN ('live', 'upcoming', 'ended', 'cancelled')),\n  category TEXT NOT NULL,\n  tags TEXT[],\n  max_viewers INTEGER DEFAULT 0,\n  current_viewers INTEGER DEFAULT 0,\n  peak_viewers INTEGER DEFAULT 0,\n  total_viewers INTEGER DEFAULT 0,\n  like_count INTEGER DEFAULT 0,\n  share_count INTEGER DEFAULT 0,\n  is_featured BOOLEAN DEFAULT false,\n  is_exclusive BOOLEAN DEFAULT false,\n  requires_subscription BOOLEAN DEFAULT false,\n  vod_url TEXT,\n  vod_duration INTEGER,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Channels table\nCREATE TABLE channels (\n  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n  name TEXT NOT NULL,\n  slug TEXT UNIQUE NOT NULL,\n  description TEXT,\n  logo_url TEXT,\n  cover_url TEXT,\n  category TEXT NOT NULL,\n  language TEXT DEFAULT 'en',\n  country TEXT,\n  is_live BOOLEAN DEFAULT false,\n  current_show_id UUID REFERENCES live_shows(id),\n  follower_count INTEGER DEFAULT 0,\n  total_shows INTEGER DEFAULT 0,\n  total_watch_time INTEGER DEFAULT 0,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Live comments table (realtime)\nCREATE TABLE live_comments (\n  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n  live_show_id UUID REFERENCES live_shows(id) ON DELETE CASCADE,\n  user_id UUID REFERENCES users(id) ON DELETE CASCADE,\n  parent_id UUID REFERENCES live_comments(id) ON DELETE CASCADE,\n  message TEXT NOT NULL,\n  is_highlighted BOOLEAN DEFAULT false,\n  is_moderated BOOLEAN DEFAULT false,\n  reaction_type TEXT,\n  metadata JSONB,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Live reactions table\nCREATE TABLE live_reactions (\n  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n  live_show_id UUID REFERENCES live_shows(id) ON DELETE CASCADE,\n  user_id UUID REFERENCES users(id) ON DELETE CASCADE,\n  reaction_type TEXT NOT NULL,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n  UNIQUE(live_show_id, user_id, reaction_type)\n);\n\n-- Live polls table\nCREATE TABLE live_polls (\n  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n  live_show_id UUID REFERENCES live_shows(id) ON DELETE CASCADE,\n  question TEXT NOT NULL,\n  options JSONB NOT NULL, -- {option_id: text, votes: count}\n  is_active BOOLEAN DEFAULT true,\n  total_votes INTEGER DEFAULT 0,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n  ends_at TIMESTAMP WITH TIME ZONE\n);\n\n-- Poll votes table\nCREATE TABLE poll_votes (\n  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n  poll_id UUID REFERENCES live_polls(id) ON DELETE CASCADE,\n  user_id UUID REFERENCES users(id) ON DELETE CASCADE,\n  option_id TEXT NOT NULL,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n  UNIQUE(poll_id, user_id)\n);\n\n-- Breaking news table\nCREATE TABLE breaking_news (\n  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n  title TEXT NOT NULL,\n  summary TEXT,\n  content TEXT,\n  category TEXT NOT NULL,\n  severity TEXT DEFAULT 'medium' CHECK (severity IN ('low', 'medium', 'high', 'critical')),\n  location JSONB,\n  source TEXT,\n  is_active BOOLEAN DEFAULT true,\n  expires_at TIMESTAMP WITH TIME ZONE,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- User watch history\nCREATE TABLE watch_history (\n  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n  user_id UUID REFERENCES users(id) ON DELETE CASCADE,\n  live_show_id UUID REFERENCES live_shows(id) ON DELETE CASCADE,\n  vod_id UUID REFERENCES vods(id) ON DELETE CASCADE,\n  watch_duration INTEGER DEFAULT 0,\n  watch_percentage INTEGER DEFAULT 0,\n  last_watched_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n  UNIQUE(user_id, live_show_id)\n);\n\n-- VODs (Video on Demand)\nCREATE TABLE vods (\n  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n  live_show_id UUID REFERENCES live_shows(id) ON DELETE CASCADE,\n  title TEXT NOT NULL,\n  description TEXT,\n  video_url TEXT NOT NULL,\n  thumbnail_url TEXT,\n  duration INTEGER NOT NULL,\n  view_count INTEGER DEFAULT 0,\n  like_count INTEGER DEFAULT 0,\n  category TEXT NOT NULL,\n  tags TEXT[],\n  is_public BOOLEAN DEFAULT true,\n  requires_subscription BOOLEAN DEFAULT false,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Create indexes\nCREATE INDEX idx_live_shows_status ON live_shows(status, schedule_time DESC);\nCREATE INDEX idx_live_shows_category ON live_shows(category);\nCREATE INDEX idx_live_comments_show_id ON live_comments(live_show_id, created_at DESC);\nCREATE INDEX idx_breaking_news_active ON breaking_news(is_active, created_at DESC);\nCREATE INDEX idx_vods_category ON vods(category);\n\n-- Enable RLS\nALTER TABLE live_shows ENABLE ROW LEVEL SECURITY;\nALTER TABLE live_comments ENABLE ROW LEVEL SECURITY;\nALTER TABLE live_reactions ENABLE ROW LEVEL SECURITY;\nALTER TABLE live_polls ENABLE ROW LEVEL SECURITY;\nALTER TABLE breaking_news ENABLE ROW LEVEL SECURITY;\n\n-- RLS Policies\n-- Anyone can view live shows\nCREATE POLICY \"Anyone can view live shows\" ON live_shows\n  FOR SELECT USING (true);\n\n-- Only presenters can update their shows\nCREATE POLICY \"Presenters can update own shows\" ON live_shows\n  FOR UPDATE USING (auth.uid() = presenter_id);\n\n-- Users can only view and add their own comments\nCREATE POLICY \"Users can view live comments\" ON live_comments\n  FOR SELECT USING (true);\n\nCREATE POLICY \"Users can add comments\" ON live_comments\n  FOR INSERT WITH CHECK (auth.uid() = user_id);\n\n-- Anyone can view breaking news\nCREATE POLICY \"Anyone can view breaking news\" ON breaking_news\n  FOR SELECT USING (true);",
                    "realtime_functions.sql": "-- Real-time functions and triggers\n\n-- Function to update current viewers count\nCREATE OR REPLACE FUNCTION update_live_viewers_count()\nRETURNS TRIGGER AS $$\nBEGIN\n  IF TG_OP = 'INSERT' THEN\n    UPDATE live_shows\n    SET current_viewers = current_viewers + 1,\n        total_viewers = total_viewers + 1,\n        max_viewers = GREATEST(max_viewers, current_viewers + 1)\n    WHERE id = NEW.live_show_id;\n  ELSIF TG_OP = 'DELETE' THEN\n    UPDATE live_shows\n    SET current_viewers = current_viewers - 1\n    WHERE id = OLD.live_show_id;\n  END IF;\n  RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\n-- Create trigger for live viewers\nCREATE TRIGGER live_viewers_trigger\nAFTER INSERT OR DELETE ON live_viewer_sessions\nFOR EACH ROW EXECUTE FUNCTION update_live_viewers_count();\n\n-- Function to send breaking news notifications\nCREATE OR REPLACE FUNCTION notify_breaking_news()\nRETURNS TRIGGER AS $$\nBEGIN\n  PERFORM pg_notify(\n    'breaking_news',\n    json_build_object(\n      'id', NEW.id,\n      'title', NEW.title,\n      'category', NEW.category,\n      'severity', NEW.severity,\n      'created_at', NEW.created_at\n    )::text\n  );\n  RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\n-- Create trigger for breaking news\nCREATE TRIGGER breaking_news_trigger\nAFTER INSERT ON breaking_news\nFOR EACH ROW EXECUTE FUNCTION notify_breaking_news();\n\n-- Function for live comment reactions\nCREATE OR REPLACE FUNCTION process_live_reaction()\nRETURNS TRIGGER AS $$\nBEGIN\n  -- Update reaction count in live_shows\n  UPDATE live_shows\n  SET like_count = like_count + 1\n  WHERE id = NEW.live_show_id\n  AND NEW.reaction_type = 'like';\n  \n  -- Send real-time notification\n  PERFORM pg_notify(\n    'live_reactions',\n    json_build_object(\n      'live_show_id', NEW.live_show_id,\n      'user_id', NEW.user_id,\n      'reaction_type', NEW.reaction_type\n    )::text\n  );\n  \n  RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\n-- Create trigger for live reactions\nCREATE TRIGGER live_reaction_trigger\nAFTER INSERT ON live_reactions\nFOR EACH ROW EXECUTE FUNCTION process_live_reaction();"
                  },
                  "models": {
                    "live_show_model.dart": "import 'package:equatable/equatable.dart';\nimport 'package:live_news_channel/core/constants/enums.dart';\n\nclass LiveShowModel extends Equatable {\n  final String id;\n  final String channelId;\n  final String presenterId;\n  final String title;\n  final String? description;\n  final String? thumbnailUrl;\n  final String? streamUrl;\n  final String? rtmpUrl;\n  final String? streamKey;\n  final String? agoraChannelName;\n  final String? agoraToken;\n  final DateTime scheduleTime;\n  final DateTime? startTime;\n  final DateTime? endTime;\n  final LiveStatus status;\n  final String category;\n  final List<String> tags;\n  final int maxViewers;\n  final int currentViewers;\n  final int peakViewers;\n  final int totalViewers;\n  final int likeCount;\n  final int shareCount;\n  final bool isFeatured;\n  final bool isExclusive;\n  final bool requiresSubscription;\n  final String? vodUrl;\n  final int? vodDuration;\n  final DateTime createdAt;\n  final DateTime updatedAt;\n  \n  const LiveShowModel({\n    required this.id,\n    required this.channelId,\n    required this.presenterId,\n    required this.title,\n    this.description,\n    this.thumbnailUrl,\n    this.streamUrl,\n    this.rtmpUrl,\n    this.streamKey,\n    this.agoraChannelName,\n    this.agoraToken,\n    required this.scheduleTime,\n    this.startTime,\n    this.endTime,\n    this.status = LiveStatus.upcoming,\n    required this.category,\n    this.tags = const [],\n    this.maxViewers = 0,\n    this.currentViewers = 0,\n    this.peakViewers = 0,\n    this.totalViewers = 0,\n    this.likeCount = 0,\n    this.shareCount = 0,\n    this.isFeatured = false,\n    this.isExclusive = false,\n    this.requiresSubscription = false,\n    this.vodUrl,\n    this.vodDuration,\n    required this.createdAt,\n    required this.updatedAt,\n  });\n  \n  factory LiveShowModel.fromJson(Map<String, dynamic> json) {\n    return LiveShowModel(\n      id: json['id'],\n      channelId: json['channel_id'],\n      presenterId: json['presenter_id'],\n      title: json['title'],\n      description: json['description'],\n      thumbnailUrl: json['thumbnail_url'],\n      streamUrl: json['stream_url'],\n      rtmpUrl: json['rtmp_url'],\n      streamKey: json['stream_key'],\n      agoraChannelName: json['agora_channel_name'],\n      agoraToken: json['agora_token'],\n      scheduleTime: DateTime.parse(json['schedule_time']),\n      startTime: json['start_time'] != null\n          ? DateTime.parse(json['start_time'])\n          : null,\n      endTime: json['end_time'] != null\n          ? DateTime.parse(json['end_time'])\n          : null,\n      status: LiveStatus.values.firstWhere(\n        (e) => e.name == json['status'],\n        orElse: () => LiveStatus.upcoming,\n      ),\n      category: json['category'],\n      tags: List<String>.from(json['tags'] ?? []),\n      maxViewers: json['max_viewers'] ?? 0,\n      currentViewers: json['current_viewers'] ?? 0,\n      peakViewers: json['peak_viewers'] ?? 0,\n      totalViewers: json['total_viewers'] ?? 0,\n      likeCount: json['like_count'] ?? 0,\n      shareCount: json['share_count'] ?? 0,\n      isFeatured: json['is_featured'] ?? false,\n      isExclusive: json['is_exclusive'] ?? false,\n      requiresSubscription: json['requires_subscription'] ?? false,\n      vodUrl: json['vod_url'],\n      vodDuration: json['vod_duration'],\n      createdAt: DateTime.parse(json['created_at']),\n      updatedAt: DateTime.parse(json['updated_at']),\n    );\n  }\n  \n  bool get isLive => status == LiveStatus.live;\n  bool get isUpcoming => status == LiveStatus.upcoming;\n  bool get hasEnded => status == LiveStatus.ended;\n  \n  String get timeUntilLive {\n    final now = DateTime.now();\n    if (isLive) return 'LIVE NOW';\n    \n    final difference = scheduleTime.difference(now);\n    \n    if (difference.inDays > 0) {\n      return 'In \\\\${difference.inDays}d';\n    } else if (difference.inHours > 0) {\n      return 'In \\\\${difference.inHours}h';\n    } else if (difference.inMinutes > 0) {\n      return 'In \\\\${difference.inMinutes}m';\n    } else {\n      return 'Starting soon';\n    }\n  }\n  \n  String get viewerCountFormatted {\n    if (currentViewers >= 1000) {\n      return '\\\\${(currentViewers / 1000).toStringAsFixed(1)}K viewers';\n    }\n    return '\\\\$currentViewers viewers';\n  }\n  \n  @override\n  List<Object?> get props => [id, status];\n}"
                  }
                },
                "presentation": {
                  "screens": {
                    "live": {
                      "live_stream_screen.dart": "import 'package:flutter/material.dart';\nimport 'package:flutter_riverpod/flutter_riverpod.dart';\nimport 'package:agora_rtc_engine/agora_rtc_engine.dart';\nimport 'package:video_player/video_player.dart';\nimport 'package:chewie/chewie.dart';\nimport 'package:live_news_channel/core/providers/live_provider.dart';\nimport 'package:live_news_channel/presentation/widgets/live_chat_widget.dart';\n\nclass LiveStreamScreen extends ConsumerStatefulWidget {\n  final String liveShowId;\n  \n  const LiveStreamScreen({\n    super.key,\n    required this.liveShowId,\n  });\n  \n  @override\n  ConsumerState<LiveStreamScreen> createState() => _LiveStreamScreenState();\n}\n\nclass _LiveStreamScreenState extends ConsumerState<LiveStreamScreen> {\n  late RtcEngine _agoraEngine;\n  VideoPlayerController? _videoController;\n  ChewieController? _chewieController;\n  bool _isJoined = false;\n  bool _isFullScreen = false;\n  bool _showChat = true;\n  \n  @override\n  void initState() {\n    super.initState();\n    _initAgora();\n  }\n  \n  Future<void> _initAgora() async {\n    // Create Agora engine instance\n    _agoraEngine = createAgoraRtcEngine();\n    await _agoraEngine.initialize(const RtcEngineContext(\n      appId: AppConstants.agoraAppId,\n    ));\n    \n    // Enable video\n    await _agoraEngine.enableVideo();\n    \n    // Set up event handlers\n    _agoraEngine.registerEventHandler(\n      RtcEngineEventHandler(\n        onJoinChannelSuccess: (connection, elapsed) {\n          setState(() {\n            _isJoined = true;\n          });\n        },\n        onUserJoined: (connection, remoteUid, elapsed) {\n          // Handle remote user joined\n        },\n        onUserOffline: (connection, remoteUid, reason) {\n          // Handle remote user offline\n        },\n      ),\n    );\n  }\n  \n  Future<void> _joinChannel() async {\n    // Get live show details\n    final liveShow = ref.read(liveShowProvider(widget.liveShowId));\n    \n    // Join channel\n    await _agoraEngine.joinChannel(\n      token: liveShow.agoraToken ?? '',\n      channelId: liveShow.agoraChannelName ?? '',\n      uid: 0, // 0 means Agora assigns a UID\n      options: const ChannelMediaOptions(),\n    );\n  }\n  \n  @override\n  void dispose() {\n    _agoraEngine.leaveChannel();\n    _agoraEngine.release();\n    _videoController?.dispose();\n    _chewieController?.dispose();\n    super.dispose();\n  }\n  \n  @override\n  Widget build(BuildContext context) {\n    final liveShowAsync = ref.watch(liveShowProvider(widget.liveShowId));\n    \n    return Scaffold(\n      body: liveShowAsync.when(\n        data: (liveShow) {\n          return Stack(\n            children: [\n              // Video Player\n              Positioned.fill(\n                child: _isJoined\n                    ? AgoraVideoView(\n                        controller: VideoViewController(\n                          rtcEngine: _agoraEngine,\n                          canvas: const VideoCanvas(uid: 0),\n                        ),\n                      )\n                    : Center(\n                        child: Column(\n                          mainAxisAlignment: MainAxisAlignment.center,\n                          children: [\n                            const CircularProgressIndicator(),\n                            const SizedBox(height: 20),\n                            Text(\n                              'Joining live stream...',\n                              style: Theme.of(context).textTheme.titleMedium,\n                            ),\n                          ],\n                        ),\n                      ),\n              ),\n              \n              // Overlay Controls\n              Positioned(\n                top: MediaQuery.of(context).padding.top + 16,\n                left: 16,\n                right: 16,\n                child: _buildLiveHeader(context, liveShow),\n              ),\n              \n              Positioned(\n                bottom: 16,\n                left: 16,\n                right: 16,\n                child: _buildLiveControls(context, liveShow),\n              ),\n              \n              // Live Chat Sidebar\n              if (_showChat)\n                Positioned(\n                  top: 100,\n                  right: 0,\n                  bottom: 100,\n                  child: Container(\n                    width: 350,\n                    decoration: BoxDecoration(\n                      color: Theme.of(context).colorScheme.surface,\n                      borderRadius: const BorderRadius.only(\n                        topLeft: Radius.circular(16),\n                        bottomLeft: Radius.circular(16),\n                      ),\n                    ),\n                    child: LiveChatWidget(liveShowId: liveShow.id),\n                  ),\n                ),\n            ],\n          );\n        },\n        loading: () => const Center(child: CircularProgressIndicator()),\n        error: (error, stack) => Center(child: Text('Error: $error')),\n      ),\n    );\n  }\n  \n  Widget _buildLiveHeader(BuildContext context, LiveShowModel liveShow) {\n    return Container(\n      padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 12),\n      decoration: BoxDecoration(\n        color: Colors.black.withOpacity(0.5),\n        borderRadius: BorderRadius.circular(12),\n      ),\n      child: Row(\n        children: [\n          Container(\n            padding: const EdgeInsets.symmetric(horizontal: 12, vertical: 6),\n            decoration: BoxDecoration(\n              color: Colors.red,\n              borderRadius: BorderRadius.circular(20),\n            ),\n            child: Row(\n              children: [\n                Container(\n                  width: 8,\n                  height: 8,\n                  decoration: const BoxDecoration(\n                    color: Colors.white,\n                    shape: BoxShape.circle,\n                  ),\n                ),\n                const SizedBox(width: 8),\n                const Text(\n                  'LIVE',\n                  style: TextStyle(\n                    color: Colors.white,\n                    fontWeight: FontWeight.bold,\n                    fontSize: 12,\n                  ),\n                ),\n              ],\n            ),\n          ),\n          const SizedBox(width: 12),\n          Expanded(\n            child: Column(\n              crossAxisAlignment: CrossAxisAlignment.start,\n              children: [\n                Text(\n                  liveShow.title,\n                  style: const TextStyle(\n                    color: Colors.white,\n                    fontWeight: FontWeight.bold,\n                    fontSize: 16,\n                  ),\n                  maxLines: 1,\n                  overflow: TextOverflow.ellipsis,\n                ),\n                Text(\n                  liveShow.viewerCountFormatted,\n                  style: const TextStyle(\n                    color: Colors.white70,\n                    fontSize: 12,\n                  ),\n                ),\n              ],\n            ),\n          ),\n          IconButton(\n            onPressed: () {\n              setState(() {\n                _showChat = !_showChat;\n              });\n            },\n            icon: Icon(\n              _showChat ? Icons.chat_bubble : Icons.chat_bubble_outline,\n              color: Colors.white,\n            ),\n          ),\n          IconButton(\n            onPressed: () {\n              // Share live stream\n            },\n            icon: const Icon(Icons.share, color: Colors.white),\n          ),\n        ],\n      ),\n    );\n  }\n  \n  Widget _buildLiveControls(BuildContext context, LiveShowModel liveShow) {\n    return Container(\n      padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 12),\n      decoration: BoxDecoration(\n        color: Colors.black.withOpacity(0.5),\n        borderRadius: BorderRadius.circular(12),\n      ),\n      child: Row(\n        children: [\n          Expanded(\n            child: Container(\n              padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),\n              decoration: BoxDecoration(\n                color: Colors.white.withOpacity(0.1),\n                borderRadius: BorderRadius.circular(24),\n              ),\n              child: const Row(\n                children: [\n                  Icon(Icons.emoji_emotions_outlined, color: Colors.white, size: 20),\n                  SizedBox(width: 8),\n                  Text(\n                    'Add a comment...',\n                    style: TextStyle(color: Colors.white70),\n                  ),\n                ],\n              ),\n            ),\n          ),\n          const SizedBox(width: 12),\n          IconButton(\n            onPressed: () {\n              // Send like reaction\n              ref.read(liveReactionProvider.notifier).sendReaction(\n                liveShowId: liveShow.id,\n                reactionType: 'like',\n              );\n            },\n            icon: const Icon(Icons.thumb_up_outlined, color: Colors.white),\n          ),\n          IconButton(\n            onPressed: () {\n              // Toggle full screen\n              setState(() {\n                _isFullScreen = !_isFullScreen;\n              });\n            },\n            icon: Icon(\n              _isFullScreen ? Icons.fullscreen_exit : Icons.fullscreen,\n              color: Colors.white,\n            ),\n          ),\n        ],\n      ),\n    );\n  }\n}"
                    }
                  }
                }
              }
            }
          }
        }
      }
    ]
  },
  {
    "dataset_name": "flutter_chat_app_supabase",
    "metadata": {
      "framework": "Flutter 3.0+",
      "architecture": "Clean Architecture + BLoC",
      "backend": "Supabase",
      "state_management": "BLoC",
      "database": "Supabase PostgreSQL + Hive Cache",
      "realtime": "Supabase Realtime + WebRTC",
      "storage": "Supabase Storage",
      "dependencies": [
        "supabase_flutter",
        "flutter_bloc",
        "equatable",
        "sembast",
        "web_socket_channel",
        "flutter_webrtc",
        "permission_handler",
        "image_picker",
        "cached_network_image",
        "emoji_picker_flutter",
        "just_audio",
        "record",
        "video_player",
        "file_picker",
        "intl",
        "flutter_local_notifications",
        "flutter_native_splash"
      ],
      "features": [
        "One-on-One Messaging",
        "Group Chats",
        "Voice/Video Calls",
        "Message Reactions",
        "File Sharing",
        "Read Receipts",
        "Typing Indicators",
        "End-to-End Encryption",
        "Message Search",
        "Dark/Light Theme"
      ],
      "target_platforms": [
        "Android",
        "iOS",
        "Web"
      ],
      "created": "2024-01-15",
      "version": "2.0.0"
    },
    "instructions": [
      {
        "instruction": "Create a complete real-time chat application with Supabase backend, WebRTC for voice/video calls, and comprehensive messaging features including groups, reactions, and file sharing.",
        "input": "",
        "output": {
          "project_structure": {
            "chat_app": {
              "pubspec.yaml": "name: chat_app\ndescription: Real-time Chat Application\nversion: 2.0.0+1\npublish_to: 'none'\n\nenvironment:\n  sdk: '>=3.0.0 <4.0.0'\n  flutter: '>=3.0.0'\n\ndependencies:\n  flutter:\n    sdk: flutter\n  supabase_flutter: ^2.0.0\n  flutter_bloc: ^8.1.3\n  equatable: ^2.0.5\n  \n  # Local storage\n  sembast: ^3.2.2\n  path_provider: ^2.1.0\n  \n  # Realtime communication\n  web_socket_channel: ^2.4.0\n  flutter_webrtc: ^0.9.32\n  socket_io_client: ^2.0.2\n  \n  # Media & Files\n  image_picker: ^1.0.4\n  video_player: ^2.8.3\n  file_picker: ^6.1.1\n  cached_network_image: ^3.2.3\n  photo_view: ^0.14.0\n  \n  # Audio\n  just_audio: ^0.9.35\n  record: ^5.0.1\n  audio_session: ^0.1.11\n  \n  # UI Components\n  emoji_picker_flutter: ^2.1.3\n  flutter_local_notifications: ^15.1.0\n  badges: ^3.0.0\n  shimmer: ^3.0.0\n  liquid_pull_to_refresh: ^3.0.0\n  \n  # Utilities\n  intl: ^0.18.1\n  uuid: ^3.0.7\n  crypto: ^3.0.3\n  encrypt: ^5.0.1\n  url_launcher: ^6.1.14\n  share_plus: ^7.0.2\n  connectivity_plus: ^4.0.2\n  \n  # Permissions\n  permission_handler: ^11.0.1\n  \n  # State restoration\n  provider: ^6.0.5\n\nflutter:\n  uses-material-design: true\n  generate: true\n  \n  assets:\n    - assets/images/\n    - assets/icons/\n    - assets/sounds/\n    - assets/animations/\n  \n  fonts:\n    - family: Inter\n      fonts:\n        - asset: fonts/Inter-Regular.ttf\n        - asset: fonts/Inter-Medium.ttf\n          weight: 500\n        - asset: fonts/Inter-SemiBold.ttf\n          weight: 600\n        - asset: fonts/Inter-Bold.ttf\n          weight: 700\n    \n    - family: EmojiOne\n      fonts:\n        - asset: fonts/EmojiOneColor.otf\n\n  # Web-specific configuration\n  web:\n    resources:\n      - assets/\n    \n  # Native splash screen\n  native_splash:\n    image: assets/images/splash.png\n    color: \"#1a73e8\"\n    android_disable_fullscreen: false\n\n# Supabase configuration\nsupabase:\n  url: https://your-project.supabase.co\n  anon_key: your-anon-key",
              "lib": {
                "main.dart": "import 'package:flutter/material.dart';\nimport 'package:flutter_bloc/flutter_bloc.dart';\nimport 'package:supabase_flutter/supabase_flutter.dart';\nimport 'package:chat_app/app.dart';\nimport 'package:chat_app/bootstrap.dart';\nimport 'package:chat_app/core/services/local_storage.dart';\nimport 'package:chat_app/core/constants/app_constants.dart';\n\nFuture<void> main() async {\n  // Ensure Flutter is initialized\n  WidgetsFlutterBinding.ensureInitialized();\n  \n  // Initialize app with dependency injection\n  await bootstrap();\n  \n  // Initialize Supabase\n  await Supabase.initialize(\n    url: AppConstants.supabaseUrl,\n    anonKey: AppConstants.supabaseAnonKey,\n  );\n  \n  // Initialize local storage\n  await LocalStorageService.init();\n  \n  runApp(const MyApp());\n}\n\nclass MyApp extends StatelessWidget {\n  const MyApp({super.key});\n\n  @override\n  Widget build(BuildContext context) {\n    return MaterialApp(\n      title: 'Chat App',\n      debugShowCheckedModeBanner: false,\n      theme: ThemeData(\n        useMaterial3: true,\n        colorScheme: ColorScheme.fromSeed(\n          seedColor: const Color(0xFF1a73e8),\n          brightness: Brightness.light,\n        ),\n        fontFamily: 'Inter',\n        appBarTheme: const AppBarTheme(\n          elevation: 0,\n          centerTitle: true,\n        ),\n      ),\n      darkTheme: ThemeData(\n        useMaterial3: true,\n        colorScheme: ColorScheme.fromSeed(\n          seedColor: const Color(0xFF1a73e8),\n          brightness: Brightness.dark,\n        ),\n        fontFamily: 'Inter',\n      ),\n      themeMode: ThemeMode.system,\n      home: const App(),\n    );\n  }\n}",
                "supabase": {
                  "schema.sql": "-- Enable necessary extensions\nCREATE EXTENSION IF NOT EXISTS \"uuid-ossp\";\nCREATE EXTENSION IF NOT EXISTS \"pgcrypto\";\n\n-- Users table\nCREATE TABLE users (\n  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),\n  email TEXT UNIQUE NOT NULL,\n  phone TEXT UNIQUE,\n  username TEXT UNIQUE NOT NULL,\n  display_name TEXT,\n  avatar_url TEXT,\n  bio TEXT,\n  status TEXT DEFAULT 'offline', -- online, offline, away, busy\n  last_seen TIMESTAMP WITH TIME ZONE,\n  is_verified BOOLEAN DEFAULT false,\n  is_active BOOLEAN DEFAULT true,\n  fcm_token TEXT,\n  public_key TEXT, -- For E2E encryption\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL,\n  updated_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL\n);\n\n-- Conversations table (for both 1:1 and group chats)\nCREATE TABLE conversations (\n  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),\n  name TEXT, -- For group chats\n  type TEXT NOT NULL DEFAULT 'direct', -- direct, group, channel\n  avatar_url TEXT,\n  description TEXT, -- For group chats\n  is_encrypted BOOLEAN DEFAULT false,\n  encryption_key TEXT, -- For E2E encrypted groups\n  created_by UUID REFERENCES users(id) ON DELETE SET NULL,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL,\n  updated_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL\n);\n\n-- Conversation participants (junction table)\nCREATE TABLE conversation_participants (\n  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),\n  conversation_id UUID REFERENCES conversations(id) ON DELETE CASCADE,\n  user_id UUID REFERENCES users(id) ON DELETE CASCADE,\n  role TEXT DEFAULT 'member', -- member, admin, owner\n  joined_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL,\n  left_at TIMESTAMP WITH TIME ZONE,\n  is_muted BOOLEAN DEFAULT false,\n  is_blocked BOOLEAN DEFAULT false,\n  last_read_message_id UUID,\n  UNIQUE(conversation_id, user_id)\n);\n\n-- Messages table\nCREATE TABLE messages (\n  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),\n  conversation_id UUID REFERENCES conversations(id) ON DELETE CASCADE,\n  sender_id UUID REFERENCES users(id) ON DELETE CASCADE,\n  parent_message_id UUID REFERENCES messages(id) ON DELETE SET NULL, -- For replies\n  \n  -- Message content\n  content TEXT,\n  message_type TEXT NOT NULL DEFAULT 'text', -- text, image, video, audio, file, location, contact\n  media_url TEXT[], -- For media messages\n  thumbnail_url TEXT,\n  file_name TEXT,\n  file_size INTEGER,\n  file_type TEXT,\n  \n  -- Location data\n  latitude DOUBLE PRECISION,\n  longitude DOUBLE PRECISION,\n  location_name TEXT,\n  \n  -- Contact data\n  contact_name TEXT,\n  contact_phone TEXT,\n  \n  -- Message metadata\n  is_edited BOOLEAN DEFAULT false,\n  is_deleted BOOLEAN DEFAULT false,\n  deleted_for_everyone BOOLEAN DEFAULT false,\n  encryption_key TEXT, -- For E2E encrypted messages\n  \n  -- Timestamps\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL,\n  updated_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL,\n  delivered_at TIMESTAMP WITH TIME ZONE,\n  read_at TIMESTAMP WITH TIME ZONE\n);\n\n-- Message reactions\nCREATE TABLE message_reactions (\n  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),\n  message_id UUID REFERENCES messages(id) ON DELETE CASCADE,\n  user_id UUID REFERENCES users(id) ON DELETE CASCADE,\n  emoji TEXT NOT NULL,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL,\n  UNIQUE(message_id, user_id, emoji)\n);\n\n-- Call history\nCREATE TABLE calls (\n  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),\n  conversation_id UUID REFERENCES conversations(id) ON DELETE CASCADE,\n  caller_id UUID REFERENCES users(id) ON DELETE CASCADE,\n  call_type TEXT NOT NULL DEFAULT 'audio', -- audio, video\n  status TEXT NOT NULL DEFAULT 'initiated', -- initiated, ringing, answered, rejected, missed, ended\n  duration INTEGER, -- in seconds\n  started_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL,\n  ended_at TIMESTAMP WITH TIME ZONE,\n  participants UUID[] NOT NULL\n);\n\n-- Typing indicators (temporary table)\nCREATE TABLE typing_indicators (\n  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),\n  conversation_id UUID REFERENCES conversations(id) ON DELETE CASCADE,\n  user_id UUID REFERENCES users(id) ON DELETE CASCADE,\n  is_typing BOOLEAN DEFAULT false,\n  updated_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL\n);\n\n-- User contacts\nCREATE TABLE user_contacts (\n  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),\n  user_id UUID REFERENCES users(id) ON DELETE CASCADE,\n  contact_user_id UUID REFERENCES users(id) ON DELETE CASCADE,\n  name TEXT,\n  phone TEXT,\n  email TEXT,\n  is_favorite BOOLEAN DEFAULT false,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL,\n  UNIQUE(user_id, contact_user_id)\n);\n\n-- Blocked users\nCREATE TABLE blocked_users (\n  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),\n  blocker_id UUID REFERENCES users(id) ON DELETE CASCADE,\n  blocked_id UUID REFERENCES users(id) ON DELETE CASCADE,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL,\n  UNIQUE(blocker_id, blocked_id)\n);\n\n-- Create indexes for performance\nCREATE INDEX idx_messages_conversation_created ON messages(conversation_id, created_at DESC);\nCREATE INDEX idx_messages_sender ON messages(sender_id);\nCREATE INDEX idx_conversation_participants_user ON conversation_participants(user_id);\nCREATE INDEX idx_conversation_participants_conversation ON conversation_participants(conversation_id);\nCREATE INDEX idx_typing_indicators_conversation ON typing_indicators(conversation_id);\n\n-- Enable Row Level Security\nALTER TABLE users ENABLE ROW LEVEL SECURITY;\nALTER TABLE conversations ENABLE ROW LEVEL SECURITY;\nALTER TABLE conversation_participants ENABLE ROW LEVEL SECURITY;\nALTER TABLE messages ENABLE ROW LEVEL SECURITY;\nALTER TABLE message_reactions ENABLE ROW LEVEL SECURITY;\nALTER TABLE calls ENABLE ROW LEVEL SECURITY;\nALTER TABLE typing_indicators ENABLE ROW LEVEL SECURITY;\nALTER TABLE user_contacts ENABLE ROW LEVEL SECURITY;\nALTER TABLE blocked_users ENABLE ROW LEVEL SECURITY;\n\n-- Create RLS Policies\n-- Users can view all active users\nCREATE POLICY \"Users can view active users\" ON users\n  FOR SELECT USING (is_active = true);\n\n-- Users can only update their own profile\nCREATE POLICY \"Users can update own profile\" ON users\n  FOR UPDATE USING (auth.uid() = id);\n\n-- Users can only see conversations they're part of\nCREATE POLICY \"Users can view their conversations\" ON conversations\n  FOR SELECT USING (\n    EXISTS (\n      SELECT 1 FROM conversation_participants cp\n      WHERE cp.conversation_id = conversations.id\n      AND cp.user_id = auth.uid()\n      AND cp.left_at IS NULL\n    )\n  );\n\n-- Users can only see messages from conversations they're part of\nCREATE POLICY \"Users can view conversation messages\" ON messages\n  FOR SELECT USING (\n    EXISTS (\n      SELECT 1 FROM conversation_participants cp\n      WHERE cp.conversation_id = messages.conversation_id\n      AND cp.user_id = auth.uid()\n      AND cp.left_at IS NULL\n    )\n  );\n\n-- Users can insert messages only in their conversations\nCREATE POLICY \"Users can insert messages\" ON messages\n  FOR INSERT WITH CHECK (\n    EXISTS (\n      SELECT 1 FROM conversation_participants cp\n      WHERE cp.conversation_id = messages.conversation_id\n      AND cp.user_id = auth.uid()\n      AND cp.left_at IS NULL\n    )\n  );\n\n-- Users can update only their own messages\nCREATE POLICY \"Users can update own messages\" ON messages\n  FOR UPDATE USING (sender_id = auth.uid());\n\n-- Users can delete only their own messages\nCREATE POLICY \"Users can delete own messages\" ON messages\n  FOR DELETE USING (sender_id = auth.uid());\n\n-- Create functions for common operations\n-- Function to update user last seen\nCREATE OR REPLACE FUNCTION update_user_last_seen()\nRETURNS TRIGGER AS $$\nBEGIN\n  UPDATE users \n  SET last_seen = NOW(), \n      status = CASE \n        WHEN NEW.status IS NOT NULL THEN NEW.status\n        ELSE 'online'\n      END\n  WHERE id = auth.uid();\n  RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\n-- Trigger for user activity\nCREATE TRIGGER update_user_activity_trigger\nAFTER INSERT OR UPDATE ON messages\nFOR EACH ROW\nEXECUTE FUNCTION update_user_last_seen();\n\n-- Function to create direct conversation\nCREATE OR REPLACE FUNCTION create_direct_conversation(user1_id UUID, user2_id UUID)\nRETURNS UUID AS $$\nDECLARE\n  conversation_id UUID;\nBEGIN\n  -- Check if conversation already exists\n  SELECT c.id INTO conversation_id\n  FROM conversations c\n  JOIN conversation_participants cp1 ON c.id = cp1.conversation_id\n  JOIN conversation_participants cp2 ON c.id = cp2.conversation_id\n  WHERE c.type = 'direct'\n    AND cp1.user_id = user1_id\n    AND cp2.user_id = user2_id\n    AND cp1.left_at IS NULL\n    AND cp2.left_at IS NULL\n  LIMIT 1;\n  \n  IF conversation_id IS NULL THEN\n    -- Create new conversation\n    INSERT INTO conversations (type)\n    VALUES ('direct')\n    RETURNING id INTO conversation_id;\n    \n    -- Add participants\n    INSERT INTO conversation_participants (conversation_id, user_id)\n    VALUES (conversation_id, user1_id), (conversation_id, user2_id);\n  END IF;\n  \n  RETURN conversation_id;\nEND;\n$$ LANGUAGE plpgsql;\n\n-- Function to get unread message count\nCREATE OR REPLACE FUNCTION get_unread_message_count(user_id UUID)\nRETURNS TABLE(conversation_id UUID, unread_count BIGINT) AS $$\nBEGIN\n  RETURN QUERY\n  SELECT \n    m.conversation_id,\n    COUNT(*) as unread_count\n  FROM messages m\n  JOIN conversation_participants cp ON m.conversation_id = cp.conversation_id\n  WHERE cp.user_id = user_id\n    AND cp.left_at IS NULL\n    AND m.created_at > COALESCE(cp.last_read_at, '1970-01-01')\n    AND m.sender_id != user_id\n    AND m.is_deleted = false\n  GROUP BY m.conversation_id;\nEND;\n$$ LANGUAGE plpgsql;",
                  "functions": {
                    "send_notification.sql": "-- Function to send push notification\nCREATE OR REPLACE FUNCTION send_message_notification()\nRETURNS TRIGGER AS $$\nDECLARE\n  receiver_ids UUID[];\n  sender_data JSON;\n  conversation_data JSON;\n  notification_payload JSON;\nBEGIN\n  -- Get sender info\n  SELECT row_to_json(u) INTO sender_data\n  FROM users u\n  WHERE u.id = NEW.sender_id;\n  \n  -- Get conversation info\n  SELECT row_to_json(c) INTO conversation_data\n  FROM conversations c\n  WHERE c.id = NEW.conversation_id;\n  \n  -- Get receiver user IDs (excluding sender)\n  SELECT array_agg(cp.user_id) INTO receiver_ids\n  FROM conversation_participants cp\n  WHERE cp.conversation_id = NEW.conversation_id\n    AND cp.user_id != NEW.sender_id\n    AND cp.left_at IS NULL\n    AND cp.is_muted = false;\n  \n  -- Create notification payload\n  notification_payload := json_build_object(\n    'type', 'new_message',\n    'message_id', NEW.id,\n    'conversation_id', NEW.conversation_id,\n    'sender', sender_data,\n    'conversation', conversation_data,\n    'message_type', NEW.message_type,\n    'preview', CASE \n      WHEN NEW.message_type = 'text' THEN LEFT(NEW.content, 100)\n      WHEN NEW.message_type = 'image' THEN 'ðŸ“· Image'\n      WHEN NEW.message_type = 'video' THEN 'ðŸŽ¥ Video'\n      WHEN NEW.message_type = 'audio' THEN 'ðŸŽµ Audio'\n      WHEN NEW.message_type = 'file' THEN 'ðŸ“„ File'\n      ELSE 'New message'\n    END,\n    'timestamp', NEW.created_at\n  );\n  \n  -- Send notification to each receiver\n  FOR i IN 1..array_length(receiver_ids, 1) LOOP\n    -- In production, this would call a notification service\n    -- For now, we'll just log it\n    RAISE NOTICE 'Sending notification to user %: %', \n      receiver_ids[i], \n      notification_payload;\n  END LOOP;\n  \n  RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\n-- Trigger to send notification on new message\nCREATE TRIGGER send_message_notification_trigger\nAFTER INSERT ON messages\nFOR EACH ROW\nEXECUTE FUNCTION send_message_notification();",
                    "end_to_end_encryption.sql": "-- Function to generate encryption key for conversation\nCREATE OR REPLACE FUNCTION generate_conversation_key(conversation_id UUID)\nRETURNS TEXT AS $$\nDECLARE\n  encryption_key TEXT;\nBEGIN\n  -- Generate a random encryption key\n  encryption_key := encode(gen_random_bytes(32), 'base64');\n  \n  -- Update conversation with encryption key\n  UPDATE conversations \n  SET \n    is_encrypted = true,\n    encryption_key = encryption_key,\n    updated_at = NOW()\n  WHERE id = conversation_id;\n  \n  RETURN encryption_key;\nEND;\n$$ LANGUAGE plpgsql;"
                  },
                  "realtime_channels.json": "{\n  \"channels\": [\n    {\n      \"name\": \"messages\",\n      \"table\": \"messages\",\n      \"events\": [\"INSERT\", \"UPDATE\", \"DELETE\"],\n      \"filter\": \"conversation_id=eq.*\"\n    },\n    {\n      \"name\": \"typing_indicators\",\n      \"table\": \"typing_indicators\",\n      \"events\": [\"INSERT\", \"UPDATE\"],\n      \"filter\": \"conversation_id=eq.*\"\n    },\n    {\n      \"name\": \"conversations\",\n      \"table\": \"conversations\",\n      \"events\": [\"UPDATE\"],\n      \"filter\": \"id=eq.*\"\n    },\n    {\n      \"name\": \"user_status\",\n      \"table\": \"users\",\n      \"events\": [\"UPDATE\"],\n      \"filter\": \"id=eq.*\"\n    },\n    {\n      \"name\": \"calls\",\n      \"table\": \"calls\",\n      \"events\": [\"INSERT\", \"UPDATE\"],\n      \"filter\": \"conversation_id=eq.*\"\n    }\n  ]\n}"
                },
                "core": {
                  "constants": {
                    "message_types.dart": "enum MessageType {\n  text,\n  image,\n  video,\n  audio,\n  file,\n  location,\n  contact,\n  system\n}\n\nenum ConversationType {\n  direct,\n  group,\n  channel\n}\n\nenum UserStatus {\n  online,\n  offline,\n  away,\n  busy\n}\n\nenum CallType {\n  audio,\n  video\n}\n\nenum CallStatus {\n  initiated,\n  ringing,\n  answered,\n  rejected,\n  missed,\n  ended\n}\n\nclass MessageConstants {\n  static const int maxMessageLength = 5000;\n  static const int maxFileSize = 50 * 1024 * 1024; // 50MB\n  static const List<String> allowedImageTypes = [\n    'image/jpeg',\n    'image/png',\n    'image/gif',\n    'image/webp'\n  ];\n  static const List<String> allowedVideoTypes = [\n    'video/mp4',\n    'video/quicktime',\n    'video/x-msvideo'\n  ];\n  static const List<String> allowedAudioTypes = [\n    'audio/mpeg',\n    'audio/wav',\n    'audio/ogg',\n    'audio/aac'\n  ];\n  static const List<String> allowedDocumentTypes = [\n    'application/pdf',\n    'application/msword',\n    'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n    'text/plain'\n  ];\n}"
                  },
                  "services": {
                    "socket_service.dart": "import 'package:web_socket_channel/web_socket_channel.dart';\nimport 'package:web_socket_channel/status.dart' as ws_status;\nimport 'package:chat_app/core/error/failure.dart';\n\ntypedef MessageCallback = void Function(Map<String, dynamic>);\ntypedef ConnectionCallback = void Function(bool);\n\nexception SocketServiceException {\n  final String message;\n  const SocketServiceException(this.message);\n}\n\nclass SocketService {\n  WebSocketChannel? _channel;\n  String? _userId;\n  String? _authToken;\n  \n  final List<MessageCallback> _messageCallbacks = [];\n  final List<ConnectionCallback> _connectionCallbacks = [];\n  \n  bool get isConnected => _channel != null;\n  \n  Future<void> connect({\n    required String url,\n    required String userId,\n    required String authToken,\n  }) async {\n    try {\n      _userId = userId;\n      _authToken = authToken;\n      \n      final wsUrl = '\\\\$url/websocket?user_id=\\\\$userId&token=\\\\$authToken';\n      \n      _channel = WebSocketChannel.connect(\n        Uri.parse(wsUrl),\n      );\n      \n      // Listen for messages\n      _channel!.stream.listen(\n        (message) {\n          _handleMessage(message);\n        },\n        onError: (error) {\n          _handleError(error);\n        },\n        onDone: () {\n          _handleDisconnection();\n        },\n      );\n      \n      _notifyConnection(true);\n    } catch (e) {\n      throw SocketServiceException('Failed to connect: \\\\$e');\n    }\n  }\n  \n  void disconnect() {\n    _channel?.sink.close(ws_status.normalClosure);\n    _channel = null;\n    _notifyConnection(false);\n  }\n  \n  Future<void> sendMessage({\n    required String type,\n    required Map<String, dynamic> data,\n  }) async {\n    if (_channel == null) {\n      throw SocketServiceException('Not connected');\n    }\n    \n    final message = {\n      'type': type,\n      'data': data,\n      'timestamp': DateTime.now().millisecondsSinceEpoch,\n      'user_id': _userId,\n    };\n    \n    try {\n      _channel!.sink.add(message);\n    } catch (e) {\n      throw SocketServiceException('Failed to send message: \\\\$e');\n    }\n  }\n  \n  void subscribe(MessageCallback callback) {\n    _messageCallbacks.add(callback);\n  }\n  \n  void unsubscribe(MessageCallback callback) {\n    _messageCallbacks.remove(callback);\n  }\n  \n  void onConnectionChange(ConnectionCallback callback) {\n    _connectionCallbacks.add(callback);\n  }\n  \n  void _handleMessage(dynamic rawMessage) {\n    try {\n      final message = Map<String, dynamic>.from(rawMessage);\n      \n      for (final callback in _messageCallbacks) {\n        callback(message);\n      }\n    } catch (e) {\n      print('Error handling message: \\\\$e');\n    }\n  }\n  \n  void _handleError(dynamic error) {\n    print('WebSocket error: \\\\$error');\n    disconnect();\n  }\n  \n  void _handleDisconnection() {\n    print('WebSocket disconnected');\n    _notifyConnection(false);\n  }\n  \n  void _notifyConnection(bool isConnected) {\n    for (final callback in _connectionCallbacks) {\n      callback(isConnected);\n    }\n  }\n}"
                  },
                  "encryption": {
                    "e2e_encryption.dart": "import 'package:encrypt/encrypt.dart';\nimport 'package:crypto/crypto.dart';\nimport 'dart:convert';\nimport 'dart:typed_data';\n\nclass E2EEncryption {\n  final Key _key;\n  final IV _iv;\n  \n  E2EEncryption.fromKey(String base64Key)\n      : _key = Key.fromBase64(base64Key),\n        _iv = IV.fromLength(16);\n  \n  E2EEncryption.generate()\n      : _key = Key.fromSecureRandom(32),\n        _iv = IV.fromSecureRandom(16);\n  \n  String get keyBase64 => _key.base64;\n  \n  String encrypt(String plaintext) {\n    final encrypter = Encrypter(AES(_key, mode: AESMode.cbc));\n    final encrypted = encrypter.encrypt(plaintext, iv: _iv);\n    return encrypted.base64;\n  }\n  \n  String decrypt(String ciphertext) {\n    final encrypter = Encrypter(AES(_key, mode: AESMode.cbc));\n    final encrypted = Encrypted.fromBase64(ciphertext);\n    return encrypter.decrypt(encrypted, iv: _iv);\n  }\n  \n  Map<String, dynamic> encryptJson(Map<String, dynamic> data) {\n    final jsonString = json.encode(data);\n    final encrypted = encrypt(jsonString);\n    \n    return {\n      'encrypted': true,\n      'data': encrypted,\n      'iv': _iv.base64,\n      'algorithm': 'AES-256-CBC',\n    };\n  }\n  \n  Map<String, dynamic> decryptJson(Map<String, dynamic> encryptedData) {\n    if (!encryptedData['encrypted']) {\n      return encryptedData;\n    }\n    \n    final decrypted = decrypt(encryptedData['data']);\n    return json.decode(decrypted);\n  }\n  \n  static String generateKeyPair() {\n    final random = Random.secure();\n    final bytes = List<int>.generate(32, (_) => random.nextInt(256));\n    return base64.encode(bytes);\n  }\n  \n  static String hashMessage(String message) {\n    final bytes = utf8.encode(message);\n    final digest = sha256.convert(bytes);\n    return digest.toString();\n  }\n}"
                  }
                },
                "data": {
                  "models": {
                    "message_model.dart": "import 'package:equatable/equatable.dart';\nimport 'package:hive/hive.dart';\nimport 'package:chat_app/core/constants/message_types.dart';\n\npart 'message_model.g.dart';\n\n@HiveType(typeId: 1)\nclass MessageModel extends Equatable {\n  @HiveField(0)\n  final String id;\n  \n  @HiveField(1)\n  final String conversationId;\n  \n  @HiveField(2)\n  final String senderId;\n  \n  @HiveField(3)\n  final String? parentMessageId;\n  \n  @HiveField(4)\n  final String? content;\n  \n  @HiveField(5)\n  final MessageType messageType;\n  \n  @HiveField(6)\n  final List<String> mediaUrls;\n  \n  @HiveField(7)\n  final String? thumbnailUrl;\n  \n  @HiveField(8)\n  final String? fileName;\n  \n  @HiveField(9)\n  final int? fileSize;\n  \n  @HiveField(10)\n  final String? fileType;\n  \n  @HiveField(11)\n  final double? latitude;\n  \n  @HiveField(12)\n  final double? longitude;\n  \n  @HiveField(13)\n  final String? locationName;\n  \n  @HiveField(14)\n  final String? contactName;\n  \n  @HiveField(15)\n  final String? contactPhone;\n  \n  @HiveField(16)\n  final bool isEdited;\n  \n  @HiveField(17)\n  final bool isDeleted;\n  \n  @HiveField(18)\n  final bool deletedForEveryone;\n  \n  @HiveField(19)\n  final String? encryptionKey;\n  \n  @HiveField(20)\n  final DateTime createdAt;\n  \n  @HiveField(21)\n  final DateTime updatedAt;\n  \n  @HiveField(22)\n  final DateTime? deliveredAt;\n  \n  @HiveField(23)\n  final DateTime? readAt;\n  \n  @HiveField(24)\n  final List<MessageReaction> reactions;\n  \n  MessageModel({\n    required this.id,\n    required this.conversationId,\n    required this.senderId,\n    this.parentMessageId,\n    this.content,\n    required this.messageType,\n    this.mediaUrls = const [],\n    this.thumbnailUrl,\n    this.fileName,\n    this.fileSize,\n    this.fileType,\n    this.latitude,\n    this.longitude,\n    this.locationName,\n    this.contactName,\n    this.contactPhone,\n    this.isEdited = false,\n    this.isDeleted = false,\n    this.deletedForEveryone = false,\n    this.encryptionKey,\n    required this.createdAt,\n    required this.updatedAt,\n    this.deliveredAt,\n    this.readAt,\n    this.reactions = const [],\n  });\n  \n  factory MessageModel.fromJson(Map<String, dynamic> json) {\n    return MessageModel(\n      id: json['id'],\n      conversationId: json['conversation_id'],\n      senderId: json['sender_id'],\n      parentMessageId: json['parent_message_id'],\n      content: json['content'],\n      messageType: MessageType.values.firstWhere(\n        (e) => e.name == (json['message_type'] as String).toLowerCase(),\n        orElse: () => MessageType.text,\n      ),\n      mediaUrls: List<String>.from(json['media_urls'] ?? []),\n      thumbnailUrl: json['thumbnail_url'],\n      fileName: json['file_name'],\n      fileSize: json['file_size'],\n      fileType: json['file_type'],\n      latitude: json['latitude'],\n      longitude: json['longitude'],\n      locationName: json['location_name'],\n      contactName: json['contact_name'],\n      contactPhone: json['contact_phone'],\n      isEdited: json['is_edited'] ?? false,\n      isDeleted: json['is_deleted'] ?? false,\n      deletedForEveryone: json['deleted_for_everyone'] ?? false,\n      encryptionKey: json['encryption_key'],\n      createdAt: DateTime.parse(json['created_at']),\n      updatedAt: DateTime.parse(json['updated_at']),\n      deliveredAt: json['delivered_at'] != null \n          ? DateTime.parse(json['delivered_at'])\n          : null,\n      readAt: json['read_at'] != null \n          ? DateTime.parse(json['read_at'])\n          : null,\n      reactions: List<MessageReaction>.from(\n        (json['reactions'] ?? []).map(\n          (r) => MessageReaction.fromJson(r),\n        ),\n      ),\n    );\n  }\n  \n  Map<String, dynamic> toJson() {\n    return {\n      'id': id,\n      'conversation_id': conversationId,\n      'sender_id': senderId,\n      'parent_message_id': parentMessageId,\n      'content': content,\n      'message_type': messageType.name,\n      'media_urls': mediaUrls,\n      'thumbnail_url': thumbnailUrl,\n      'file_name': fileName,\n      'file_size': fileSize,\n      'file_type': fileType,\n      'latitude': latitude,\n      'longitude': longitude,\n      'location_name': locationName,\n      'contact_name': contactName,\n      'contact_phone': contactPhone,\n      'is_edited': isEdited,\n      'is_deleted': isDeleted,\n      'deleted_for_everyone': deletedForEveryone,\n      'encryption_key': encryptionKey,\n      'created_at': createdAt.toIso8601String(),\n      'updated_at': updatedAt.toIso8601String(),\n      'delivered_at': deliveredAt?.toIso8601String(),\n      'read_at': readAt?.toIso8601String(),\n      'reactions': reactions.map((r) => r.toJson()).toList(),\n    };\n  }\n  \n  MessageModel copyWith({\n    String? id,\n    String? conversationId,\n    String? senderId,\n    String? parentMessageId,\n    String? content,\n    MessageType? messageType,\n    List<String>? mediaUrls,\n    String? thumbnailUrl,\n    String? fileName,\n    int? fileSize,\n    String? fileType,\n    double? latitude,\n    double? longitude,\n    String? locationName,\n    String? contactName,\n    String? contactPhone,\n    bool? isEdited,\n    bool? isDeleted,\n    bool? deletedForEveryone,\n    String? encryptionKey,\n    DateTime? createdAt,\n    DateTime? updatedAt,\n    DateTime? deliveredAt,\n    DateTime? readAt,\n    List<MessageReaction>? reactions,\n  }) {\n    return MessageModel(\n      id: id ?? this.id,\n      conversationId: conversationId ?? this.conversationId,\n      senderId: senderId ?? this.senderId,\n      parentMessageId: parentMessageId ?? this.parentMessageId,\n      content: content ?? this.content,\n      messageType: messageType ?? this.messageType,\n      mediaUrls: mediaUrls ?? this.mediaUrls,\n      thumbnailUrl: thumbnailUrl ?? this.thumbnailUrl,\n      fileName: fileName ?? this.fileName,\n      fileSize: fileSize ?? this.fileSize,\n      fileType: fileType ?? this.fileType,\n      latitude: latitude ?? this.latitude,\n      longitude: longitude ?? this.longitude,\n      locationName: locationName ?? this.locationName,\n      contactName: contactName ?? this.contactName,\n      contactPhone: contactPhone ?? this.contactPhone,\n      isEdited: isEdited ?? this.isEdited,\n      isDeleted: isDeleted ?? this.isDeleted,\n      deletedForEveryone: deletedForEveryone ?? this.deletedForEveryone,\n      encryptionKey: encryptionKey ?? this.encryptionKey,\n      createdAt: createdAt ?? this.createdAt,\n      updatedAt: updatedAt ?? DateTime.now(),\n      deliveredAt: deliveredAt ?? this.deliveredAt,\n      readAt: readAt ?? this.readAt,\n      reactions: reactions ?? this.reactions,\n    );\n  }\n  \n  bool get isMediaMessage => [\n    MessageType.image,\n    MessageType.video,\n    MessageType.audio,\n    MessageType.file,\n  ].contains(messageType);\n  \n  bool get isTextMessage => messageType == MessageType.text;\n  \n  bool get isSystemMessage => messageType == MessageType.system;\n  \n  bool get hasReactions => reactions.isNotEmpty;\n  \n  bool get isSent => deliveredAt != null;\n  \n  bool get isRead => readAt != null;\n  \n  String get previewText {\n    if (isDeleted) {\n      return 'This message was deleted';\n    }\n    \n    switch (messageType) {\n      case MessageType.text:\n        return content ?? '';\n      case MessageType.image:\n        return 'ðŸ“· Image';\n      case MessageType.video:\n        return 'ðŸŽ¥ Video';\n      case MessageType.audio:\n        return 'ðŸŽµ Audio';\n      case MessageType.file:\n        return 'ðŸ“„ \\\\${fileName ?? \"File\"}';\n      case MessageType.location:\n        return 'ðŸ“ Location';\n      case MessageType.contact:\n        return 'ðŸ‘¤ \\\\${contactName ?? \"Contact\"}';\n      case MessageType.system:\n        return 'âš™ï¸ System message';\n    }\n  }\n  \n  @override\n  List<Object?> get props => [id];\n}\n\n@HiveType(typeId: 2)\nclass MessageReaction extends Equatable {\n  @HiveField(0)\n  final String id;\n  \n  @HiveField(1)\n  final String messageId;\n  \n  @HiveField(2)\n  final String userId;\n  \n  @HiveField(3)\n  final String emoji;\n  \n  @HiveField(4)\n  final DateTime createdAt;\n  \n  MessageReaction({\n    required this.id,\n    required this.messageId,\n    required this.userId,\n    required this.emoji,\n    required this.createdAt,\n  });\n  \n  factory MessageReaction.fromJson(Map<String, dynamic> json) {\n    return MessageReaction(\n      id: json['id'],\n      messageId: json['message_id'],\n      userId: json['user_id'],\n      emoji: json['emoji'],\n      createdAt: DateTime.parse(json['created_at']),\n    );\n  }\n  \n  Map<String, dynamic> toJson() {\n    return {\n      'id': id,\n      'message_id': messageId,\n      'user_id': userId,\n      'emoji': emoji,\n      'created_at': createdAt.toIso8601String(),\n    };\n  }\n  \n  @override\n  List<Object?> get props => [id];\n}"
                  }
                },
                "presentation": {
                  "blocs": {
                    "chat_bloc.dart": "import 'dart:async';\nimport 'package:bloc/bloc.dart';\nimport 'package:chat_app/data/models/message_model.dart';\nimport 'package:chat_app/data/models/conversation_model.dart';\nimport 'package:chat_app/data/repositories/chat_repository.dart';\nimport 'package:chat_app/core/services/socket_service.dart';\nimport 'package:equatable/equatable.dart';\n\npart 'chat_event.dart';\npart 'chat_state.dart';\n\nclass ChatBloc extends Bloc<ChatEvent, ChatState> {\n  final ChatRepository _chatRepository;\n  final SocketService _socketService;\n  \n  StreamSubscription? _messagesSubscription;\n  StreamSubscription? _typingSubscription;\n  StreamSubscription? _userStatusSubscription;\n  \n  ChatBloc({\n    required ChatRepository chatRepository,\n    required SocketService socketService,\n  })  : _chatRepository = chatRepository,\n        _socketService = socketService,\n        super(const ChatInitial()) {\n    \n    on<LoadConversations>(_onLoadConversations);\n    on<LoadMessages>(_onLoadMessages);\n    on<SendMessage>(_onSendMessage);\n    on<ReceiveMessage>(_onReceiveMessage);\n    on<UpdateMessage>(_onUpdateMessage);\n    on<DeleteMessage>(_onDeleteMessage);\n    on<ReactToMessage>(_onReactToMessage);\n    on<StartTyping>(_onStartTyping);\n    on<StopTyping>(_onStopTyping);\n    on<UpdateUserStatus>(_onUpdateUserStatus);\n    on<MarkAsRead>(_onMarkAsRead);\n    on<UploadFile>(_onUploadFile);\n    on<StartCall>(_onStartCall);\n    on<EndCall>(_onEndCall);\n    \n    _setupSocketListeners();\n  }\n  \n  void _setupSocketListeners() {\n    _socketService.subscribe((message) {\n      final type = message['type'] as String;\n      final data = message['data'] as Map<String, dynamic>;\n      \n      switch (type) {\n        case 'new_message':\n          add(ReceiveMessage(MessageModel.fromJson(data)));\n          break;\n        case 'message_updated':\n          add(UpdateMessage(MessageModel.fromJson(data)));\n          break;\n        case 'message_deleted':\n          add(DeleteMessage(data['message_id'], data['deleted_for_everyone']));\n          break;\n        case 'typing_started':\n          add(StartTyping(data['conversation_id'], data['user_id']));\n          break;\n        case 'typing_stopped':\n          add(StopTyping(data['conversation_id'], data['user_id']));\n          break;\n        case 'user_status_updated':\n          add(UpdateUserStatus(data['user_id'], data['status']));\n          break;\n        case 'call_started':\n          // Handle incoming call\n          break;\n        case 'call_ended':\n          // Handle call ended\n          break;\n      }\n    });\n  }\n  \n  Future<void> _onLoadConversations(\n    LoadConversations event,\n    Emitter<ChatState> emit,\n  ) async {\n    emit(const ConversationsLoading());\n    \n    try {\n      final conversations = await _chatRepository.getConversations();\n      emit(ConversationsLoaded(conversations));\n    } catch (e) {\n      emit(ChatError('Failed to load conversations: \\\\$e'));\n    }\n  }\n  \n  Future<void> _onLoadMessages(\n    LoadMessages event,\n    Emitter<ChatState> emit,\n  ) async {\n    if (state is MessagesLoaded) {\n      final currentState = state as MessagesLoaded;\n      if (currentState.conversationId == event.conversationId && \n          !event.forceRefresh) {\n        return;\n      }\n    }\n    \n    emit(const MessagesLoading());\n    \n    try {\n      final messages = await _chatRepository.getMessages(\n        conversationId: event.conversationId,\n        limit: event.limit,\n        before: event.before,\n      );\n      \n      emit(MessagesLoaded(\n        conversationId: event.conversationId,\n        messages: messages,\n        hasMore: messages.length >= event.limit,\n      ));\n    } catch (e) {\n      emit(ChatError('Failed to load messages: \\\\$e'));\n    }\n  }\n  \n  Future<void> _onSendMessage(\n    SendMessage event,\n    Emitter<ChatState> emit,\n  ) async {\n    try {\n      // Add message to local state immediately\n      if (state is MessagesLoaded) {\n        final currentState = state as MessagesLoaded;\n        final updatedMessages = [event.message, ...currentState.messages];\n        \n        emit(currentState.copyWith(messages: updatedMessages));\n      }\n      \n      // Send to server\n      await _chatRepository.sendMessage(event.message);\n      \n      // Notify via socket\n      await _socketService.sendMessage(\n        type: 'send_message',\n        data: event.message.toJson(),\n      );\n    } catch (e) {\n      emit(ChatError('Failed to send message: \\\\$e'));\n    }\n  }\n  \n  Future<void> _onReceiveMessage(\n    ReceiveMessage event,\n    Emitter<ChatState> emit,\n  ) async {\n    if (state is MessagesLoaded) {\n      final currentState = state as MessagesLoaded;\n      \n      // Check if message already exists\n      final exists = currentState.messages.any((m) => m.id == event.message.id);\n      if (exists) return;\n      \n      final updatedMessages = [event.message, ...currentState.messages];\n      emit(currentState.copyWith(messages: updatedMessages));\n    }\n  }\n  \n  Future<void> _onUpdateMessage(\n    UpdateMessage event,\n    Emitter<ChatState> emit,\n  ) async {\n    if (state is MessagesLoaded) {\n      final currentState = state as MessagesLoaded;\n      final updatedMessages = currentState.messages.map((message) {\n        return message.id == event.message.id ? event.message : message;\n      }).toList();\n      \n      emit(currentState.copyWith(messages: updatedMessages));\n    }\n  }\n  \n  Future<void> _onDeleteMessage(\n    DeleteMessage event,\n    Emitter<ChatState> emit,\n  ) async {\n    if (state is MessagesLoaded) {\n      final currentState = state as MessagesLoaded;\n      \n      final updatedMessages = currentState.messages.map((message) {\n        if (message.id == event.messageId) {\n          return message.copyWith(\n            isDeleted: true,\n            deletedForEveryone: event.deletedForEveryone,\n          );\n        }\n        return message;\n      }).toList();\n      \n      emit(currentState.copyWith(messages: updatedMessages));\n    }\n  }\n  \n  Future<void> _onReactToMessage(\n    ReactToMessage event,\n    Emitter<ChatState> emit,\n  ) async {\n    try {\n      await _chatRepository.addReaction(\n        messageId: event.messageId,\n        emoji: event.emoji,\n      );\n      \n      // Notify via socket\n      await _socketService.sendMessage(\n        type: 'react_to_message',\n        data: {\n          'message_id': event.messageId,\n          'emoji': event.emoji,\n        },\n      );\n    } catch (e) {\n      emit(ChatError('Failed to react to message: \\\\$e'));\n    }\n  }\n  \n  void _onStartTyping(\n    StartTyping event,\n    Emitter<ChatState> emit,\n  ) {\n    if (state is MessagesLoaded) {\n      final currentState = state as MessagesLoaded;\n      final typingUsers = {...currentState.typingUsers, event.userId};\n      emit(currentState.copyWith(typingUsers: typingUsers));\n    }\n  }\n  \n  void _onStopTyping(\n    StopTyping event,\n    Emitter<ChatState> emit,\n  ) {\n    if (state is MessagesLoaded) {\n      final currentState = state as MessagesLoaded;\n      final typingUsers = {...currentState.typingUsers};\n      typingUsers.remove(event.userId);\n      emit(currentState.copyWith(typingUsers: typingUsers));\n    }\n  }\n  \n  void _onUpdateUserStatus(\n    UpdateUserStatus event,\n    Emitter<ChatState> emit,\n  ) {\n    // Update user status in conversations\n    if (state is ConversationsLoaded) {\n      final currentState = state as ConversationsLoaded;\n      final updatedConversations = currentState.conversations.map((conv) {\n        // Update participant status if needed\n        return conv;\n      }).toList();\n      \n      emit(currentState.copyWith(conversations: updatedConversations));\n    }\n  }\n  \n  Future<void> _onMarkAsRead(\n    MarkAsRead event,\n    Emitter<ChatState> emit,\n  ) async {\n    try {\n      await _chatRepository.markAsRead(event.conversationId);\n    } catch (e) {\n      emit(ChatError('Failed to mark as read: \\\\$e'));\n    }\n  }\n  \n  Future<void> _onUploadFile(\n    UploadFile event,\n    Emitter<ChatState> emit,\n  ) async {\n    emit(const FileUploading());\n    \n    try {\n      final fileUrl = await _chatRepository.uploadFile(\n        filePath: event.filePath,\n        fileName: event.fileName,\n        fileType: event.fileType,\n      );\n      \n      emit(FileUploaded(fileUrl));\n    } catch (e) {\n      emit(ChatError('Failed to upload file: \\\\$e'));\n    }\n  }\n  \n  Future<void> _onStartCall(\n    StartCall event,\n    Emitter<ChatState> emit,\n  ) async {\n    try {\n      await _socketService.sendMessage(\n        type: 'start_call',\n        data: {\n          'conversation_id': event.conversationId,\n          'call_type': event.callType.name,\n        },\n      );\n    } catch (e) {\n      emit(ChatError('Failed to start call: \\\\$e'));\n    }\n  }\n  \n  Future<void> _onEndCall(\n    EndCall event,\n    Emitter<ChatState> emit,\n  ) async {\n    try {\n      await _socketService.sendMessage(\n        type: 'end_call',\n        data: {\n          'call_id': event.callId,\n          'duration': event.duration,\n        },\n      );\n    } catch (e) {\n      emit(ChatError('Failed to end call: \\\\$e'));\n    }\n  }\n  \n  @override\n  Future<void> close() {\n    _messagesSubscription?.cancel();\n    _typingSubscription?.cancel();\n    _userStatusSubscription?.cancel();\n    _socketService.disconnect();\n    return super.close();\n  }\n}"
                  }
                },
                "widgets": {
                  "chat": {
                    "chat_bubble.dart": "import 'package:flutter/material.dart';\nimport 'package:cached_network_image/cached_network_image.dart';\nimport 'package:chat_app/data/models/message_model.dart';\nimport 'package:chat_app/core/constants/message_types.dart';\nimport 'package:chat_app/core/utils/formatters.dart';\n\nclass ChatBubble extends StatelessWidget {\n  final MessageModel message;\n  final bool isOwnMessage;\n  final bool showAvatar;\n  final bool showTime;\n  final VoidCallback? onTap;\n  final VoidCallback? onLongPress;\n  final VoidCallback? onReply;\n  final VoidCallback? onReact;\n  \n  const ChatBubble({\n    super.key,\n    required this.message,\n    required this.isOwnMessage,\n    this.showAvatar = true,\n    this.showTime = true,\n    this.onTap,\n    this.onLongPress,\n    this.onReply,\n    this.onReact,\n  });\n  \n  @override\n  Widget build(BuildContext context) {\n    final theme = Theme.of(context);\n    final colorScheme = theme.colorScheme;\n    \n    if (message.isDeleted) {\n      return _buildDeletedMessage(theme);\n    }\n    \n    if (message.isSystemMessage) {\n      return _buildSystemMessage(theme);\n    }\n    \n    return Padding(\n      padding: const EdgeInsets.symmetric(vertical: 2, horizontal: 8),\n      child: Row(\n        crossAxisAlignment: CrossAxisAlignment.end,\n        mainAxisAlignment: isOwnMessage \n            ? MainAxisAlignment.end \n            : MainAxisAlignment.start,\n        children: [\n          if (!isOwnMessage && showAvatar)\n            Padding(\n              padding: const EdgeInsets.only(right: 8),\n              child: CircleAvatar(\n                radius: 16,\n                backgroundImage: CachedNetworkImageProvider(\n                  message.senderId, // This should be avatar URL\n                ),\n              ),\n            ),\n          \n          Flexible(\n            child: Column(\n              crossAxisAlignment: isOwnMessage \n                  ? CrossAxisAlignment.end \n                  : CrossAxisAlignment.start,\n              children: [\n                Container(\n                  constraints: BoxConstraints(\n                    maxWidth: MediaQuery.of(context).size.width * 0.7,\n                  ),\n                  padding: const EdgeInsets.symmetric(\n                    vertical: 10,\n                    horizontal: 14,\n                  ),\n                  decoration: BoxDecoration(\n                    color: isOwnMessage\n                        ? colorScheme.primary\n                        : colorScheme.surfaceVariant,\n                    borderRadius: BorderRadius.only(\n                      topLeft: const Radius.circular(16),\n                      topRight: const Radius.circular(16),\n                      bottomLeft: isOwnMessage \n                          ? const Radius.circular(16)\n                          : const Radius.circular(4),\n                      bottomRight: isOwnMessage \n                          ? const Radius.circular(4)\n                          : const Radius.circular(16),\n                    ),\n                  ),\n                  child: Column(\n                    crossAxisAlignment: CrossAxisAlignment.start,\n                    children: [\n                      if (message.parentMessageId != null)\n                        _buildReplyPreview(theme),\n                      \n                      _buildMessageContent(theme),\n                      \n                      if (message.hasReactions)\n                        _buildReactions(theme),\n                    ],\n                  ),\n                ),\n                \n                if (showTime)\n                  Padding(\n                    padding: const EdgeInsets.only(top: 4),\n                    child: Row(\n                      mainAxisSize: MainAxisSize.min,\n                      children: [\n                        Text(\n                          Formatters.formatTime(message.createdAt),\n                          style: theme.textTheme.bodySmall?.copyWith(\n                            color: theme.colorScheme.onSurface.withOpacity(0.5),\n                          ),\n                        ),\n                        \n                        if (isOwnMessage) ...[\n                          const SizedBox(width: 4),\n                          Icon(\n                            message.isRead ? Icons.done_all : Icons.done,\n                            size: 12,\n                            color: message.isRead \n                                ? Colors.blue \n                                : theme.colorScheme.onSurface.withOpacity(0.5),\n                          ),\n                        ],\n                      ],\n                    ),\n                  ),\n              ],\n            ),\n          ),\n          \n          if (isOwnMessage && showAvatar)\n            Padding(\n              padding: const EdgeInsets.only(left: 8),\n              child: CircleAvatar(\n                radius: 16,\n                backgroundColor: colorScheme.primaryContainer,\n                child: Icon(\n                  Icons.person,\n                  size: 18,\n                  color: colorScheme.onPrimaryContainer,\n                ),\n              ),\n            ),\n        ],\n      ),\n    );\n  }\n  \n  Widget _buildDeletedMessage(ThemeData theme) {\n    return Padding(\n      padding: const EdgeInsets.symmetric(vertical: 8, horizontal: 16),\n      child: Center(\n        child: Text(\n          'This message was deleted',\n          style: theme.textTheme.bodyMedium?.copyWith(\n            color: theme.colorScheme.onSurface.withOpacity(0.5),\n            fontStyle: FontStyle.italic,\n          ),\n        ),\n      ),\n    );\n  }\n  \n  Widget _buildSystemMessage(ThemeData theme) {\n    return Padding(\n      padding: const EdgeInsets.symmetric(vertical: 8, horizontal: 16),\n      child: Center(\n        child: Container(\n          padding: const EdgeInsets.symmetric(horizontal: 12, vertical: 6),\n          decoration: BoxDecoration(\n            color: theme.colorScheme.surfaceVariant,\n            borderRadius: BorderRadius.circular(12),\n          ),\n          child: Text(\n            message.content ?? 'System message',\n            style: theme.textTheme.bodySmall?.copyWith(\n              color: theme.colorScheme.onSurfaceVariant,\n            ),\n          ),\n        ),\n      ),\n    );\n  }\n  \n  Widget _buildReplyPreview(ThemeData theme) {\n    return Container(\n      padding: const EdgeInsets.all(8),\n      margin: const EdgeInsets.only(bottom: 8),\n      decoration: BoxDecoration(\n        color: theme.colorScheme.surface.withOpacity(0.5),\n        borderRadius: BorderRadius.circular(8),\n        border: Border.all(\n          color: theme.colorScheme.outline.withOpacity(0.3),\n        ),\n      ),\n      child: Row(\n        children: [\n          Container(\n            width: 3,\n            height: 24,\n            color: theme.colorScheme.primary,\n          ),\n          const SizedBox(width: 8),\n          Expanded(\n            child: Column(\n              crossAxisAlignment: CrossAxisAlignment.start,\n              children: [\n                Text(\n                  'Replying to You',\n                  style: theme.textTheme.labelSmall?.copyWith(\n                    color: theme.colorScheme.primary,\n                  ),\n                ),\n                Text(\n                  'Preview of replied message...',\n                  style: theme.textTheme.bodySmall,\n                  maxLines: 1,\n                  overflow: TextOverflow.ellipsis,\n                ),\n              ],\n            ),\n          ),\n        ],\n      ),\n    );\n  }\n  \n  Widget _buildMessageContent(ThemeData theme) {\n    switch (message.messageType) {\n      case MessageType.text:\n        return SelectableText(\n          message.content ?? '',\n          style: theme.textTheme.bodyLarge?.copyWith(\n            color: isOwnMessage\n                ? theme.colorScheme.onPrimary\n                : theme.colorScheme.onSurface,\n          ),\n        );\n        \n      case MessageType.image:\n        return _buildImageMessage(theme);\n        \n      case MessageType.video:\n        return _buildVideoMessage(theme);\n        \n      case MessageType.audio:\n        return _buildAudioMessage(theme);\n        \n      case MessageType.file:\n        return _buildFileMessage(theme);\n        \n      case MessageType.location:\n        return _buildLocationMessage(theme);\n        \n      case MessageType.contact:\n        return _buildContactMessage(theme);\n        \n      default:\n        return const SizedBox.shrink();\n    }\n  }\n  \n  Widget _buildImageMessage(ThemeData theme) {\n    return GestureDetector(\n      onTap: () {\n        // Open image viewer\n      },\n      child: ClipRRect(\n        borderRadius: BorderRadius.circular(8),\n        child: CachedNetworkImage(\n          imageUrl: message.mediaUrls.first,\n          placeholder: (context, url) => Container(\n            width: 200,\n            height: 200,\n            color: theme.colorScheme.surfaceVariant,\n            child: const Center(\n              child: CircularProgressIndicator(),\n            ),\n          ),\n          errorWidget: (context, url, error) => Container(\n            width: 200,\n            height: 200,\n            color: theme.colorScheme.errorContainer,\n            child: const Center(\n              child: Icon(Icons.broken_image),\n            ),\n          ),\n        ),\n      ),\n    );\n  }\n  \n  Widget _buildVideoMessage(ThemeData theme) {\n    return Container(\n      width: 200,\n      height: 150,\n      decoration: BoxDecoration(\n        color: theme.colorScheme.surfaceVariant,\n        borderRadius: BorderRadius.circular(8),\n      ),\n      child: Stack(\n        fit: StackFit.expand,\n        children: [\n          if (message.thumbnailUrl != null)\n            CachedNetworkImage(\n              imageUrl: message.thumbnailUrl!,\n              fit: BoxFit.cover,\n            ),\n          \n          Center(\n            child: Container(\n              padding: const EdgeInsets.all(12),\n              decoration: const BoxDecoration(\n                color: Colors.black54,\n                shape: BoxShape.circle,\n              ),\n              child: const Icon(\n                Icons.play_arrow,\n                color: Colors.white,\n                size: 30,\n              ),\n            ),\n          ),\n        ],\n      ),\n    );\n  }\n  \n  Widget _buildAudioMessage(ThemeData theme) {\n    return Container(\n      padding: const EdgeInsets.all(12),\n      decoration: BoxDecoration(\n        color: theme.colorScheme.surfaceVariant,\n        borderRadius: BorderRadius.circular(8),\n      ),\n      child: Row(\n        children: [\n          const Icon(Icons.audiotrack, size: 24),\n          const SizedBox(width: 12),\n          Expanded(\n            child: Column(\n              crossAxisAlignment: CrossAxisAlignment.start,\n              children: [\n                Text(\n                  'Audio Message',\n                  style: theme.textTheme.bodyMedium,\n                ),\n                if (message.fileSize != null)\n                  Text(\n                    '${(message.fileSize! / 1024).toStringAsFixed(1)} KB',\n                    style: theme.textTheme.bodySmall,\n                  ),\n              ],\n            ),\n          ),\n          const Icon(Icons.play_circle_filled, size: 32),\n        ],\n      ),\n    );\n  }\n  \n  Widget _buildFileMessage(ThemeData theme) {\n    return Container(\n      padding: const EdgeInsets.all(12),\n      decoration: BoxDecoration(\n        color: theme.colorScheme.surfaceVariant,\n        borderRadius: BorderRadius.circular(8),\n      ),\n      child: Row(\n        children: [\n          const Icon(Icons.insert_drive_file, size: 32),\n          const SizedBox(width: 12),\n          Expanded(\n            child: Column(\n              crossAxisAlignment: CrossAxisAlignment.start,\n              children: [\n                Text(\n                  message.fileName ?? 'File',\n                  style: theme.textTheme.bodyMedium,\n                  maxLines: 1,\n                  overflow: TextOverflow.ellipsis,\n                ),\n                if (message.fileSize != null)\n                  Text(\n                    '${(message.fileSize! / 1024).toStringAsFixed(1)} KB',\n                    style: theme.textTheme.bodySmall,\n                  ),\n              ],\n            ),\n          ),\n          const Icon(Icons.download, size: 24),\n        ],\n      ),\n    );\n  }\n  \n  Widget _buildLocationMessage(ThemeData theme) {\n    return Container(\n      width: 200,\n      height: 150,\n      decoration: BoxDecoration(\n        color: theme.colorScheme.surfaceVariant,\n        borderRadius: BorderRadius.circular(8),\n      ),\n      child: Column(\n        children: [\n          Expanded(\n            child: const Icon(\n              Icons.location_on,\n              size: 48,\n              color: Colors.red,\n            ),\n          ),\n          Padding(\n            padding: const EdgeInsets.all(8),\n            child: Text(\n              message.locationName ?? 'Location',\n              style: theme.textTheme.bodyMedium,\n              maxLines: 1,\n              overflow: TextOverflow.ellipsis,\n            ),\n          ),\n        ],\n      ),\n    );\n  }\n  \n  Widget _buildContactMessage(ThemeData theme) {\n    return Container(\n      padding: const EdgeInsets.all(12),\n      decoration: BoxDecoration(\n        color: theme.colorScheme.surfaceVariant,\n        borderRadius: BorderRadius.circular(8),\n      ),\n      child: Row(\n        children: [\n          const CircleAvatar(\n            radius: 24,\n            child: Icon(Icons.person, size: 28),\n          ),\n          const SizedBox(width: 12),\n          Expanded(\n            child: Column(\n              crossAxisAlignment: CrossAxisAlignment.start,\n              children: [\n                Text(\n                  message.contactName ?? 'Contact',\n                  style: theme.textTheme.bodyMedium,\n                ),\n                if (message.contactPhone != null)\n                  Text(\n                    message.contactPhone!,\n                    style: theme.textTheme.bodySmall,\n                  ),\n              ],\n            ),\n          ),\n          const Icon(Icons.person_add, size: 24),\n        ],\n      ),\n    );\n  }\n  \n  Widget _buildReactions(ThemeData theme) {\n    return Wrap(\n      spacing: 4,\n      runSpacing: 4,\n      children: message.reactions.map((reaction) {\n        return Container(\n          padding: const EdgeInsets.symmetric(horizontal: 6, vertical: 2),\n          decoration: BoxDecoration(\n            color: theme.colorScheme.surface,\n            borderRadius: BorderRadius.circular(12),\n            border: Border.all(\n              color: theme.colorScheme.outline.withOpacity(0.3),\n            ),\n          ),\n          child: Row(\n            mainAxisSize: MainAxisSize.min,\n            children: [\n              Text(reaction.emoji),\n              const SizedBox(width: 2),\n              if (message.reactions.length > 1)\n                Text(\n                  '${message.reactions.length}',\n                  style: theme.textTheme.bodySmall,\n                ),\n            ],\n          ),\n        );\n      }).toList(),\n    );\n  }\n}"
                  }
                },
                "screens": {
                  "chat": {
                    "chat_screen.dart": "import 'package:flutter/material.dart';\nimport 'package:flutter_bloc/flutter_bloc.dart';\nimport 'package:emoji_picker_flutter/emoji_picker_flutter.dart';\nimport 'package:chat_app/presentation/blocs/chat_bloc.dart';\nimport 'package:chat_app/presentation/widgets/chat/chat_bubble.dart';\nimport 'package:chat_app/presentation/widgets/chat/message_input.dart';\nimport 'package:chat_app/data/models/conversation_model.dart';\n\nclass ChatScreen extends StatefulWidget {\n  final ConversationModel conversation;\n  \n  const ChatScreen({\n    super.key,\n    required this.conversation,\n  });\n  \n  @override\n  State<ChatScreen> createState() => _ChatScreenState();\n}\n\nclass _ChatScreenState extends State<ChatScreen> {\n  final _scrollController = ScrollController();\n  final _messageController = TextEditingController();\n  bool _showEmojiPicker = false;\n  \n  @override\n  void initState() {\n    super.initState();\n    \n    // Load initial messages\n    context.read<ChatBloc>().add(\n      LoadMessages(conversationId: widget.conversation.id),\n    );\n    \n    // Mark as read\n    context.read<ChatBloc>().add(\n      MarkAsRead(conversationId: widget.conversation.id),\n    );\n    \n    // Scroll to bottom when keyboard appears\n    WidgetsBinding.instance.addPostFrameCallback((_) {\n      _scrollToBottom();\n    });\n  }\n  \n  @override\n  void dispose() {\n    _scrollController.dispose();\n    _messageController.dispose();\n    super.dispose();\n  }\n  \n  void _scrollToBottom() {\n    if (_scrollController.hasClients) {\n      _scrollController.animateTo(\n        0,\n        duration: const Duration(milliseconds: 300),\n        curve: Curves.easeOut,\n      );\n    }\n  }\n  \n  void _sendMessage() {\n    final message = _messageController.text.trim();\n    if (message.isEmpty) return;\n    \n    // TODO: Create and send message\n    _messageController.clear();\n    _scrollToBottom();\n  }\n  \n  void _toggleEmojiPicker() {\n    setState(() {\n      _showEmojiPicker = !_showEmojiPicker;\n    });\n  }\n  \n  void _onEmojiSelected(Emoji emoji) {\n    _messageController.text = _messageController.text + emoji.emoji;\n  }\n  \n  @override\n  Widget build(BuildContext context) {\n    return GestureDetector(\n      onTap: () {\n        FocusScope.of(context).unfocus();\n        if (_showEmojiPicker) {\n          setState(() => _showEmojiPicker = false);\n        }\n      },\n      child: Scaffold(\n        appBar: AppBar(\n          title: Row(\n            children: [\n              CircleAvatar(\n                backgroundImage: NetworkImage(widget.conversation.avatarUrl ?? ''),\n              ),\n              const SizedBox(width: 12),\n              Expanded(\n                child: Column(\n                  crossAxisAlignment: CrossAxisAlignment.start,\n                  children: [\n                    Text(\n                      widget.conversation.name,\n                      style: Theme.of(context).textTheme.titleMedium,\n                    ),\n                    BlocBuilder<ChatBloc, ChatState>(\n                      builder: (context, state) {\n                        if (state is MessagesLoaded && \n                            state.typingUsers.isNotEmpty) {\n                          return Text(\n                            'typing...',\n                            style: Theme.of(context).textTheme.bodySmall,\n                          );\n                        }\n                        return Text(\n                          'Online',\n                          style: Theme.of(context).textTheme.bodySmall,\n                        );\n                      },\n                    ),\n                  ],\n                ),\n              ),\n            ],\n          ),\n          actions: [\n            IconButton(\n              onPressed: () {},\n              icon: const Icon(Icons.videocam),\n            ),\n            IconButton(\n              onPressed: () {},\n              icon: const Icon(Icons.call),\n            ),\n            PopupMenuButton<String>(\n              itemBuilder: (context) => [\n                const PopupMenuItem(\n                  value: 'info',\n                  child: Text('Conversation Info'),\n                ),\n                const PopupMenuItem(\n                  value: 'mute',\n                  child: Text('Mute Notifications'),\n                ),\n                const PopupMenuItem(\n                  value: 'block',\n                  child: Text('Block User'),\n                ),\n                const PopupMenuItem(\n                  value: 'clear',\n                  child: Text('Clear Chat'),\n                ),\n              ],\n            ),\n          ],\n        ),\n        body: Column(\n          children: [\n            Expanded(\n              child: BlocBuilder<ChatBloc, ChatState>(\n                builder: (context, state) {\n                  if (state is MessagesLoading) {\n                    return const Center(\n                      child: CircularProgressIndicator(),\n                    );\n                  }\n                  \n                  if (state is MessagesLoaded) {\n                    return ListView.builder(\n                      controller: _scrollController,\n                      reverse: true,\n                      padding: const EdgeInsets.only(bottom: 8),\n                      itemCount: state.messages.length,\n                      itemBuilder: (context, index) {\n                        final message = state.messages[index];\n                        final isOwnMessage = message.senderId == 'current-user-id';\n                        \n                        return ChatBubble(\n                          message: message,\n                          isOwnMessage: isOwnMessage,\n                          showAvatar: index == state.messages.length - 1 ||\n                              state.messages[index + 1].senderId != message.senderId,\n                          showTime: index == 0 ||\n                              state.messages[index - 1].senderId != message.senderId,\n                          onTap: () {\n                            // Handle tap\n                          },\n                          onLongPress: () {\n                            _showMessageOptions(context, message);\n                          },\n                        );\n                      },\n                    );\n                  }\n                  \n                  if (state is ChatError) {\n                    return Center(\n                      child: Text(state.message),\n                    );\n                  }\n                  \n                  return const SizedBox();\n                },\n              ),\n            ),\n            \n            MessageInput(\n              controller: _messageController,\n              onSend: _sendMessage,\n              onEmojiToggle: _toggleEmojiPicker,\n            ),\n            \n            if (_showEmojiPicker)\n              SizedBox(\n                height: 250,\n                child: EmojiPicker(\n                  onEmojiSelected: (category, emoji) {\n                    _onEmojiSelected(emoji);\n                  },\n                  config: Config(\n                    columns: 7,\n                    emojiSizeMax: 32,\n                    bgColor: Theme.of(context).colorScheme.surface,\n                    indicatorColor: Theme.of(context).colorScheme.primary,\n                  ),\n                ),\n              ),\n          ],\n        ),\n      ),\n    );\n  }\n  \n  void _showMessageOptions(BuildContext context, MessageModel message) {\n    showModalBottomSheet(\n      context: context,\n      backgroundColor: Colors.transparent,\n      builder: (context) {\n        return Container(\n          decoration: BoxDecoration(\n            color: Theme.of(context).colorScheme.surface,\n            borderRadius: const BorderRadius.only(\n              topLeft: Radius.circular(20),\n              topRight: Radius.circular(20),\n            ),\n          ),\n          child: Column(\n            mainAxisSize: MainAxisSize.min,\n            children: [\n              ListTile(\n                leading: const Icon(Icons.reply),\n                title: const Text('Reply'),\n                onTap: () {\n                  Navigator.pop(context);\n                  // Handle reply\n                },\n              ),\n              ListTile(\n                leading: const Icon(Icons.content_copy),\n                title: const Text('Copy'),\n                onTap: () {\n                  Navigator.pop(context);\n                  // Handle copy\n                },\n              ),\n              ListTile(\n                leading: const Icon(Icons.edit),\n                title: const Text('Edit'),\n                onTap: () {\n                  Navigator.pop(context);\n                  // Handle edit\n                },\n              ),\n              ListTile(\n                leading: const Icon(Icons.delete),\n                title: const Text('Delete'),\n                onTap: () {\n                  Navigator.pop(context);\n                  _showDeleteDialog(context, message);\n                },\n              ),\n              const SizedBox(height: 8),\n            ],\n          ),\n        );\n      },\n    );\n  }\n  \n  void _showDeleteDialog(BuildContext context, MessageModel message) {\n    showDialog(\n      context: context,\n      builder: (context) => AlertDialog(\n        title: const Text('Delete Message'),\n        content: const Text('Are you sure you want to delete this message?'),\n        actions: [\n          TextButton(\n            onPressed: () => Navigator.pop(context),\n            child: const Text('Cancel'),\n          ),\n          TextButton(\n            onPressed: () {\n              Navigator.pop(context);\n              context.read<ChatBloc>().add(\n                DeleteMessage(message.id, false),\n              );\n            },\n            child: const Text('Delete for me'),\n          ),\n          TextButton(\n            onPressed: () {\n              Navigator.pop(context);\n              context.read<ChatBloc>().add(\n                DeleteMessage(message.id, true),\n              );\n            },\n            child: const Text('Delete for everyone'),\n          ),\n        ],\n      ),\n    );\n  }\n}"
                  }
                }
              }
            }
          }
        }
      }
    ]
  }
]